<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 15 Annex Troubleshooting | Technical Manual Global Soil Organic Carbon Sequestration Potential Map GSOCseq</title>
  <meta name="description" content="The GSOCseq Technical Manual" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 15 Annex Troubleshooting | Technical Manual Global Soil Organic Carbon Sequestration Potential Map GSOCseq" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="The GSOCseq Technical Manual" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 15 Annex Troubleshooting | Technical Manual Global Soil Organic Carbon Sequestration Potential Map GSOCseq" />
  
  <meta name="twitter:description" content="The GSOCseq Technical Manual" />
  

<meta name="author" content="Food and Agriculture Organization of the United Nations, Rome, 2020" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="limitations-knowledge-gaps-and-way-forward.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>List of contributors</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#authors"><i class="fa fa-check"></i>Authors</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributers-and-reviewers"><i class="fa fa-check"></i>Contributers and Reviewers</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#special-advisor"><i class="fa fa-check"></i>Special Advisor</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#github-page"><i class="fa fa-check"></i>GitHub Page</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="presentation.html"><a href="presentation.html"><i class="fa fa-check"></i><b>1</b> | Presentation</a><ul>
<li class="chapter" data-level="1.1" data-path="presentation.html"><a href="presentation.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.1</b> How to use this book</a></li>
<li class="chapter" data-level="1.2" data-path="presentation.html"><a href="presentation.html#the-sample-data-set"><i class="fa fa-check"></i><b>1.2</b> The sample data set</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="soil-organic-carbon-soc-sequestration.html"><a href="soil-organic-carbon-soc-sequestration.html"><i class="fa fa-check"></i><b>2</b> | Soil Organic Carbon (SOC) sequestration</a><ul>
<li class="chapter" data-level="2.1" data-path="soil-organic-carbon-soc-sequestration.html"><a href="soil-organic-carbon-soc-sequestration.html#soil-carbon"><i class="fa fa-check"></i><b>2.1</b> Soil carbon</a></li>
<li class="chapter" data-level="2.2" data-path="soil-organic-carbon-soc-sequestration.html"><a href="soil-organic-carbon-soc-sequestration.html#soc-sequestration"><i class="fa fa-check"></i><b>2.2</b> SOC sequestration</a></li>
<li class="chapter" data-level="2.3" data-path="soil-organic-carbon-soc-sequestration.html"><a href="soil-organic-carbon-soc-sequestration.html#factors-affecting-soc-sequestration"><i class="fa fa-check"></i><b>2.3</b> Factors affecting SOC sequestration</a></li>
<li class="chapter" data-level="2.4" data-path="soil-organic-carbon-soc-sequestration.html"><a href="soil-organic-carbon-soc-sequestration.html#estimating-soc-sequestration-potential"><i class="fa fa-check"></i><b>2.4</b> Estimating SOC sequestration potential</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="soc-modelling.html"><a href="soc-modelling.html"><i class="fa fa-check"></i><b>3</b> | SOC Modelling</a><ul>
<li class="chapter" data-level="3.1" data-path="soc-modelling.html"><a href="soc-modelling.html#process-oriented-models"><i class="fa fa-check"></i><b>3.1</b> Process-oriented models</a></li>
<li class="chapter" data-level="3.2" data-path="soc-modelling.html"><a href="soc-modelling.html#examples-of-process-oriented-models"><i class="fa fa-check"></i><b>3.2</b> Examples of process-oriented models</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="the-rothc-model.html"><a href="the-rothc-model.html"><i class="fa fa-check"></i><b>4</b> | The RothC model</a><ul>
<li class="chapter" data-level="4.1" data-path="the-rothc-model.html"><a href="the-rothc-model.html#model-description"><i class="fa fa-check"></i><b>4.1</b> Model description</a></li>
<li class="chapter" data-level="4.2" data-path="the-rothc-model.html"><a href="the-rothc-model.html#rothc-general-data-requirements"><i class="fa fa-check"></i><b>4.2</b> RothC general data requirements</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html"><i class="fa fa-check"></i><b>5</b> | Modelling approach for the GSOCseq</a><ul>
<li class="chapter" data-level="5.1" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#general-framework"><i class="fa fa-check"></i><b>5.1</b> General framework</a></li>
<li class="chapter" data-level="5.2" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#potential-soc-sequestration-estimates-after-the-implementation-of-ssm-practices"><i class="fa fa-check"></i><b>5.2</b> Potential SOC sequestration estimates after the implementation of SSM practices</a></li>
<li class="chapter" data-level="5.3" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#business-as-usual-and-sustainable-soil-management-scenarios"><i class="fa fa-check"></i><b>5.3</b> Business as usual and sustainable soil management scenarios</a></li>
<li class="chapter" data-level="5.4" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#general-modeling-procedures"><i class="fa fa-check"></i><b>5.4</b> General modeling procedures</a><ul>
<li class="chapter" data-level="5.4.1" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#initialization-long-spin-up"><i class="fa fa-check"></i><b>5.4.1</b> Initialization: Long spin-up</a></li>
<li class="chapter" data-level="5.4.2" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#short-spin-up"><i class="fa fa-check"></i><b>5.4.2</b> Short spin-up</a></li>
<li class="chapter" data-level="5.4.3" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#forward-runs"><i class="fa fa-check"></i><b>5.4.3</b> Forward runs</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="modelling-approach-for-the-gsocseq.html"><a href="modelling-approach-for-the-gsocseq.html#summary"><i class="fa fa-check"></i><b>5.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html"><i class="fa fa-check"></i><b>6</b> | data sets and inputs</a><ul>
<li class="chapter" data-level="6.1" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#climate-data-sets"><i class="fa fa-check"></i><b>6.1</b> Climate data sets</a></li>
<li class="chapter" data-level="6.2" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#soil-data-sets"><i class="fa fa-check"></i><b>6.2</b> Soil data sets</a><ul>
<li class="chapter" data-level="6.2.1" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#initial-total-soc-stocks"><i class="fa fa-check"></i><b>6.2.1</b> Initial total SOC stocks</a></li>
<li class="chapter" data-level="6.2.2" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#initial-c-pools"><i class="fa fa-check"></i><b>6.2.2</b> Initial C pools</a></li>
<li class="chapter" data-level="6.2.3" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#soil-texture-clay-content"><i class="fa fa-check"></i><b>6.2.3</b> Soil texture: clay content</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#land-cover-data-sets"><i class="fa fa-check"></i><b>6.3</b> Land cover data sets</a></li>
<li class="chapter" data-level="6.4" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#monthly-vegetation-cover"><i class="fa fa-check"></i><b>6.4</b> Monthly vegetation cover</a></li>
<li class="chapter" data-level="6.5" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#monthly-carbon-inputs"><i class="fa fa-check"></i><b>6.5</b> Monthly carbon inputs:</a><ul>
<li class="chapter" data-level="6.5.1" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#c-inputs-under-bau-practices"><i class="fa fa-check"></i><b>6.5.1</b> C inputs under BAU practices:</a></li>
<li class="chapter" data-level="6.5.2" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#c-inputs-under-ssm-practices"><i class="fa fa-check"></i><b>6.5.2</b> C inputs under SSM practices:</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#residue-decomposability-decomposable-to-resistant-plant-material-ratio-dpmrpm"><i class="fa fa-check"></i><b>6.6</b> Residue decomposability: decomposable to resistant plant material ratio (DPM/RPM)</a></li>
<li class="chapter" data-level="6.7" data-path="data-sets-and-inputs.html"><a href="data-sets-and-inputs.html#required-data-sets-and-global-data-sources.-summary"><i class="fa fa-check"></i><b>6.7</b> Required data sets and global data sources. Summary</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="software-environment.html"><a href="software-environment.html"><i class="fa fa-check"></i><b>7</b> | Software environment</a><ul>
<li class="chapter" data-level="7.1" data-path="software-environment.html"><a href="software-environment.html#setting-up-the-software-environment-r-rstudio-and-r-packages"><i class="fa fa-check"></i><b>7.1</b> Setting up the software environment: R, RStudio and R Packages</a><ul>
<li class="chapter" data-level="7.1.1" data-path="software-environment.html"><a href="software-environment.html#obtaining-and-installing-r"><i class="fa fa-check"></i><b>7.1.1</b> Obtaining and installing R</a></li>
<li class="chapter" data-level="7.1.2" data-path="software-environment.html"><a href="software-environment.html#obtaining-and-installing-rstudio"><i class="fa fa-check"></i><b>7.1.2</b> Obtaining and installing RStudio</a></li>
<li class="chapter" data-level="7.1.3" data-path="software-environment.html"><a href="software-environment.html#getting-started-with-r"><i class="fa fa-check"></i><b>7.1.3</b> Getting started with R</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="software-environment.html"><a href="software-environment.html#r-packages"><i class="fa fa-check"></i><b>7.2</b> R packages</a><ul>
<li class="chapter" data-level="7.2.1" data-path="software-environment.html"><a href="software-environment.html#finding-r-packages"><i class="fa fa-check"></i><b>7.2.1</b> Finding R packages</a></li>
<li class="chapter" data-level="7.2.2" data-path="software-environment.html"><a href="software-environment.html#some-useful-r-packages-for-the-socseq-maps"><i class="fa fa-check"></i><b>7.2.2</b> Some useful R-packages for the SOCseq maps</a></li>
<li class="chapter" data-level="7.2.3" data-path="software-environment.html"><a href="software-environment.html#installation-of-r-packages-used-in-this-technical-manual"><i class="fa fa-check"></i><b>7.2.3</b> Installation of R-Packages used in this technical manual</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="software-environment.html"><a href="software-environment.html#considerations-when-using-r"><i class="fa fa-check"></i><b>7.3</b> Considerations when using R</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="running-the-scripts-overview.html"><a href="running-the-scripts-overview.html"><i class="fa fa-check"></i><b>8</b> | Running the scripts: overview</a><ul>
<li class="chapter" data-level="8.1" data-path="running-the-scripts-overview.html"><a href="running-the-scripts-overview.html#summary-of-steps-and-scripts"><i class="fa fa-check"></i><b>8.1</b> Summary of steps and scripts</a></li>
<li class="chapter" data-level="8.2" data-path="running-the-scripts-overview.html"><a href="running-the-scripts-overview.html#stage-1-preparation-of-data"><i class="fa fa-check"></i><b>8.2</b> Stage 1: Preparation of data</a></li>
<li class="chapter" data-level="8.3" data-path="running-the-scripts-overview.html"><a href="running-the-scripts-overview.html#stage-2-running-the-model"><i class="fa fa-check"></i><b>8.3</b> Stage 2: Running the model</a></li>
<li class="chapter" data-level="8.4" data-path="running-the-scripts-overview.html"><a href="running-the-scripts-overview.html#stage-3-generation-of-the-map"><i class="fa fa-check"></i><b>8.4</b> Stage 3: generation of the map</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html"><i class="fa fa-check"></i><b>9</b> | Stage 1: preparation of input data</a><ul>
<li class="chapter" data-level="9.1" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#preparation-of-soc-layer"><i class="fa fa-check"></i><b>9.1</b> Preparation of SOC layer</a><ul>
<li class="chapter" data-level="9.1.1" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-0.soc_map_aoi.r"><i class="fa fa-check"></i><b>9.1.1</b> Script Number 0.“SOC_MAP_AOI.R”</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#preparation-of-climate-layers"><i class="fa fa-check"></i><b>9.2</b> Preparation of climate Layers</a><ul>
<li class="chapter" data-level="9.2.1" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#option-a-preparation-of-the-cru-climatic-variables"><i class="fa fa-check"></i><b>9.2.1</b> <em>Option A</em> Preparation of the CRU climatic variables</a></li>
<li class="chapter" data-level="9.2.2" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#option-b-preparation-of-the-terraclimate-climatic-variables"><i class="fa fa-check"></i><b>9.2.2</b> <em>Option B</em> Preparation of the TerraClimate climatic variables</a></li>
<li class="chapter" data-level="9.2.3" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-6.-monthly_vegetation_cover-vegetation-cover-from-google-earth-engine."><i class="fa fa-check"></i><b>9.2.3</b> Script Number 6. “Monthly_vegetation_cover” vegetation cover from Google Earth Engine.</a></li>
<li class="chapter" data-level="9.2.4" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-7.-vegetation_cover_stack.r"><i class="fa fa-check"></i><b>9.2.4</b> Script Number 7. “Vegetation_Cover_stack.R”</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#preparing-the-land-use-layer"><i class="fa fa-check"></i><b>9.3</b> Preparing the land use layer</a><ul>
<li class="chapter" data-level="9.3.1" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-9-land_use_esa_to_fao_classes.r-no-land-use-change"><i class="fa fa-check"></i><b>9.3.1</b> Script Number 9 “Land_Use_ESA_to_FAO_classes.R” No land use change</a></li>
<li class="chapter" data-level="9.3.2" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-9-land_use_esa_to_fao_classes_lusim.r-land-use-change-simulation"><i class="fa fa-check"></i><b>9.3.2</b> Script Number 9 “Land_Use_ESA_to_FAO_classes_LUsim.R” Land use change simulation</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#harmonization-of-soil-climate-and-vegetation-layers."><i class="fa fa-check"></i><b>9.4</b> Harmonization of soil, climate and vegetation layers.</a><ul>
<li class="chapter" data-level="9.4.1" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-10.-spin_up_stack.v3.r"><i class="fa fa-check"></i><b>9.4.1</b> Script Number 10. “SPIN_UP_STACK.v3.R”</a></li>
<li class="chapter" data-level="9.4.2" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-11.-warm_up_stack_v5.r-no-land-use-change"><i class="fa fa-check"></i><b>9.4.2</b> Script Number 11. “WARM_UP_STACK_V5.R” No Land use change</a></li>
<li class="chapter" data-level="9.4.3" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-11.-warm_up_stack_v5_lusim.r-land-use-change-simulation"><i class="fa fa-check"></i><b>9.4.3</b> Script Number 11. WARM_UP_STACK_V5_LUsim.R Land use change simulation</a></li>
<li class="chapter" data-level="9.4.4" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#script-number-12.-forward_stack.r"><i class="fa fa-check"></i><b>9.4.4</b> Script Number 12. “FORWARD_STACK.R”</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#defining-target-points-to-run-the-model"><i class="fa fa-check"></i><b>9.5</b> Defining target points to run the model</a><ul>
<li class="chapter" data-level="9.5.1" data-path="stage-1-preparation-of-input-data.html"><a href="stage-1-preparation-of-input-data.html#qgis-procedure-number-1-model"><i class="fa fa-check"></i><b>9.5.1</b> QGIS Procedure number 1 (model)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="running-the-scripts-overview.html"><a href="running-the-scripts-overview.html#stage-2-running-the-model"><i class="fa fa-check"></i><b>10</b> | Stage 2: running the model</a><ul>
<li class="chapter" data-level="10.1" data-path="stage-2-running-the-model.html"><a href="stage-2-running-the-model.html"><i class="fa fa-check"></i><b>10.1</b> Script Number 13. “ROTH_C_SPIN_UP_v2.R”</a></li>
<li class="chapter" data-level="10.2" data-path="stage-2-running-the-model.html"><a href="stage-2-running-the-model.html#script-number-14.-roth_c_warm_up_v4.r-no-land-use-change"><i class="fa fa-check"></i><b>10.2</b> Script Number 14. “ROTH_C_WARM_UP_v4.R” No Land use change</a></li>
<li class="chapter" data-level="10.3" data-path="stage-2-running-the-model.html"><a href="stage-2-running-the-model.html#script-number-14.-roth_c_warm_up_v4.r-land-use-change-simulation"><i class="fa fa-check"></i><b>10.3</b> Script Number 14. “ROTH_C_WARM_UP_v4.R” Land use change simulation</a><ul>
<li class="chapter" data-level="10.3.1" data-path="stage-2-running-the-model.html"><a href="stage-2-running-the-model.html#script-number-15.-roth_c_forward_v2.r"><i class="fa fa-check"></i><b>10.3.1</b> Script Number 15. “ROTH_C_forward_v2.R”</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="stage-3-map-generation.html"><a href="stage-3-map-generation.html"><i class="fa fa-check"></i><b>11</b> | Stage 3: Map generation</a><ul>
<li class="chapter" data-level="11.1" data-path="stage-3-map-generation.html"><a href="stage-3-map-generation.html#script-number-16-points_to_raster.r"><i class="fa fa-check"></i><b>11.1</b> Script Number 16: “Points_to_Raster.R”</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="uncertainty-and-validation.html"><a href="uncertainty-and-validation.html"><i class="fa fa-check"></i><b>12</b> | Uncertainty and validation</a></li>
<li class="chapter" data-level="13" data-path="data-sharing.html"><a href="data-sharing.html"><i class="fa fa-check"></i><b>13</b> | Data sharing</a><ul>
<li class="chapter" data-level="13.1" data-path="data-sharing.html"><a href="data-sharing.html#general-principles"><i class="fa fa-check"></i><b>13.1</b> General principles</a></li>
<li class="chapter" data-level="13.2" data-path="data-sharing.html"><a href="data-sharing.html#data-formats-and-integrity"><i class="fa fa-check"></i><b>13.2</b> Data formats and integrity</a></li>
<li class="chapter" data-level="13.3" data-path="data-sharing.html"><a href="data-sharing.html#data-correctness"><i class="fa fa-check"></i><b>13.3</b> Data correctness</a></li>
<li class="chapter" data-level="13.4" data-path="data-sharing.html"><a href="data-sharing.html#data-completeness"><i class="fa fa-check"></i><b>13.4</b> Data completeness</a></li>
<li class="chapter" data-level="13.5" data-path="data-sharing.html"><a href="data-sharing.html#other-modes-of-data-sharing"><i class="fa fa-check"></i><b>13.5</b> Other modes of data sharing</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="limitations-knowledge-gaps-and-way-forward.html"><a href="limitations-knowledge-gaps-and-way-forward.html"><i class="fa fa-check"></i><b>14</b> | Limitations, knowledge gaps and way forward</a></li>
<li class="chapter" data-level="15" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html"><i class="fa fa-check"></i><b>15</b> Annex Troubleshooting</a><ul>
<li class="chapter" data-level="15.1" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#coastal-and-small-countries-not-fully-covered-by-the-cru-layers"><i class="fa fa-check"></i><b>15.1</b> Coastal and small countries not fully covered by the CRU layers</a><ul>
<li class="chapter" data-level="15.1.1" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#step-1-create-a-single-cru-layer-cropped-and-masked-to-the-extent-of-your-aoi-using-the-following-r-script."><i class="fa fa-check"></i><b>15.1.1</b> Step 1 Create a single CRU layer cropped and masked to the extent of your AOI using the following R script.</a></li>
<li class="chapter" data-level="15.1.2" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#step-2-open-qgis-and-generate-the-empty-points"><i class="fa fa-check"></i><b>15.1.2</b> Step 2 Open QGIS and generate the empty points</a></li>
<li class="chapter" data-level="15.1.3" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#step-3-polygonize-the-raster"><i class="fa fa-check"></i><b>15.1.3</b> Step 3 Polygonize the raster</a></li>
<li class="chapter" data-level="15.1.4" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#step-6-run-the-spin-up-phase-for-points-outside-the-cru-layer-script-13b"><i class="fa fa-check"></i><b>15.1.4</b> Step 6 Run the Spin up phase for points outside the CRU layer (Script 13B)</a></li>
<li class="chapter" data-level="15.1.5" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#step-7-run-the-warm-up-phase-for-points-outside-the-cru-layer-script-14b"><i class="fa fa-check"></i><b>15.1.5</b> Step 7 Run the Warm up phase for points outside the CRU layer (Script 14B)</a></li>
<li class="chapter" data-level="15.1.6" data-path="annex-troubleshooting.html"><a href="annex-troubleshooting.html#step-8-run-the-forward-phase-for-points-outside-the-cru-layer-script-15b"><i class="fa fa-check"></i><b>15.1.6</b> Step 8 Run the Forward phase for points outside the CRU layer (Script 15B)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>16</b> References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Technical Manual Global Soil Organic Carbon Sequestration Potential Map GSOCseq</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="annex-troubleshooting" class="section level1">
<h1><span class="header-section-number">Chapter 15</span> Annex Troubleshooting</h1>
<div id="coastal-and-small-countries-not-fully-covered-by-the-cru-layers" class="section level2">
<h2><span class="header-section-number">15.1</span> Coastal and small countries not fully covered by the CRU layers</h2>
<p>Due to the coarse resolution of the CRU layers a lot of points close to the country boarders can be lost (Figure 15.1).</p>
<div class="figure">
<img src="images/Figure_9.7.png" alt="" />
<p class="caption">Figure 15.1 Points outside of a given CRU layer for Panama.</p>
</div>
<p>To overcome this, we provided two options:</p>
<ol style="list-style-type: decimal">
<li>Perform the whole procedure with higher resolution climate layers again for every point. We have provided scripts to download and prepare TerraClimate climatic layers.</li>
<li>Prepare the CRU layers with the newly provided scripts that include a line of code that fills NA values with the average of the three nearest pixel values. If you have already completed all steps, you can repeat the procedure solely for points that fall outside the CRU layer.</li>
</ol>
<p>In the following a small guide for option 2 on how to select and run the model for points that fall outside the CRU layers is provided:</p>
<div id="step-1-create-a-single-cru-layer-cropped-and-masked-to-the-extent-of-your-aoi-using-the-following-r-script." class="section level3">
<h3><span class="header-section-number">15.1.1</span> Step 1 Create a single CRU layer cropped and masked to the extent of your AOI using the following R script.</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="annex-troubleshooting.html#cb105-1"></a><span class="co">#+++++++++++++++++++++++++++++++++++++++++</span></span>
<span id="cb105-2"><a href="annex-troubleshooting.html#cb105-2"></a><span class="co">#  DATE:  02/03/2021                     #</span></span>
<span id="cb105-3"><a href="annex-troubleshooting.html#cb105-3"></a><span class="co">#                                        #</span></span>
<span id="cb105-4"><a href="annex-troubleshooting.html#cb105-4"></a><span class="co">#  Isabel Luotto                         #</span></span>
<span id="cb105-5"><a href="annex-troubleshooting.html#cb105-5"></a><span class="co">#                                        #</span></span>
<span id="cb105-6"><a href="annex-troubleshooting.html#cb105-6"></a><span class="co"># This script can be used to clip        #</span></span>
<span id="cb105-7"><a href="annex-troubleshooting.html#cb105-7"></a><span class="co"># one of the CRU layers                  #</span></span>
<span id="cb105-8"><a href="annex-troubleshooting.html#cb105-8"></a><span class="co"># to the shape of the AOI                #</span></span>
<span id="cb105-9"><a href="annex-troubleshooting.html#cb105-9"></a><span class="co">#                                        #</span></span>
<span id="cb105-10"><a href="annex-troubleshooting.html#cb105-10"></a><span class="co">#+++++++++++++++++++++++++++++++++++++++++</span></span>
<span id="cb105-11"><a href="annex-troubleshooting.html#cb105-11"></a></span>
<span id="cb105-12"><a href="annex-troubleshooting.html#cb105-12"></a><span class="co">#Empty environment</span></span>
<span id="cb105-13"><a href="annex-troubleshooting.html#cb105-13"></a><span class="kw">rm</span>(<span class="dt">list =</span> <span class="kw">ls</span>())</span>
<span id="cb105-14"><a href="annex-troubleshooting.html#cb105-14"></a></span>
<span id="cb105-15"><a href="annex-troubleshooting.html#cb105-15"></a><span class="co">#Load libraries</span></span>
<span id="cb105-16"><a href="annex-troubleshooting.html#cb105-16"></a><span class="kw">library</span>(raster)</span>
<span id="cb105-17"><a href="annex-troubleshooting.html#cb105-17"></a><span class="kw">library</span>(rgdal)</span>
<span id="cb105-18"><a href="annex-troubleshooting.html#cb105-18"></a></span>
<span id="cb105-19"><a href="annex-troubleshooting.html#cb105-19"></a><span class="co">#Define paths to the single folder locations</span></span>
<span id="cb105-20"><a href="annex-troubleshooting.html#cb105-20"></a>WD_AOI&lt;-(<span class="st">&quot;C:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020/INPUTS/AOI_POLYGON&quot;</span>)</span>
<span id="cb105-21"><a href="annex-troubleshooting.html#cb105-21"></a>WD_CRU&lt;-(<span class="st">&quot;C:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020/INPUTS/CRU_LAYERS&quot;</span>)</span>
<span id="cb105-22"><a href="annex-troubleshooting.html#cb105-22"></a></span>
<span id="cb105-23"><a href="annex-troubleshooting.html#cb105-23"></a><span class="co">#Load any of the CRU tif layers created with script N. 1</span></span>
<span id="cb105-24"><a href="annex-troubleshooting.html#cb105-24"></a><span class="kw">setwd</span>(WD_CRU)</span>
<span id="cb105-25"><a href="annex-troubleshooting.html#cb105-25"></a>CRU &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;PET_Stack_01-18_CRU.tif&quot;</span>)</span>
<span id="cb105-26"><a href="annex-troubleshooting.html#cb105-26"></a></span>
<span id="cb105-27"><a href="annex-troubleshooting.html#cb105-27"></a><span class="co">#Load your AOI shapefile</span></span>
<span id="cb105-28"><a href="annex-troubleshooting.html#cb105-28"></a><span class="kw">setwd</span>(WD_AOI)</span>
<span id="cb105-29"><a href="annex-troubleshooting.html#cb105-29"></a>AOI &lt;-<span class="st"> </span><span class="kw">readOGR</span>(<span class="st">&quot;PAN_adm0.shp&quot;</span>)</span>
<span id="cb105-30"><a href="annex-troubleshooting.html#cb105-30"></a></span>
<span id="cb105-31"><a href="annex-troubleshooting.html#cb105-31"></a><span class="co">#Crop and mask CRU layer</span></span>
<span id="cb105-32"><a href="annex-troubleshooting.html#cb105-32"></a>CRU&lt;-<span class="kw">crop</span>(CRU,AOI)</span>
<span id="cb105-33"><a href="annex-troubleshooting.html#cb105-33"></a>CRU&lt;-<span class="kw">mask</span>(CRU,AOI)</span>
<span id="cb105-34"><a href="annex-troubleshooting.html#cb105-34"></a></span>
<span id="cb105-35"><a href="annex-troubleshooting.html#cb105-35"></a><span class="co">#Save cropped masked raster layer</span></span>
<span id="cb105-36"><a href="annex-troubleshooting.html#cb105-36"></a><span class="kw">setwd</span>(WD_CRU)</span>
<span id="cb105-37"><a href="annex-troubleshooting.html#cb105-37"></a><span class="kw">writeRaster</span>(CRU, <span class="st">&quot;CRU_AOI_QGIS.tif&quot;</span> )</span></code></pre></div>
</div>
<div id="step-2-open-qgis-and-generate-the-empty-points" class="section level3">
<h3><span class="header-section-number">15.1.2</span> Step 2 Open QGIS and generate the empty points</h3>
<ul>
<li>Repeat section 9.5.1 QGIS Procedure number 1 (model) in the technical manual to generate the empty points</li>
<li>Load the cropped CRU layer created previously</li>
</ul>
</div>
<div id="step-3-polygonize-the-raster" class="section level3">
<h3><span class="header-section-number">15.1.3</span> Step 3 Polygonize the raster</h3>
<ul>
<li>Go to.. Raster/Conversion/Polygonize (Raster to Vector)</li>
<li>Select CRU layer as input and click on Run (Figure 15.2)</li>
</ul>
<p><img src="images/Figure_11.png" alt="Figure 15.2 Raster to Vector" />
### Step 4 Select points outside of the polygon</p>
<ul>
<li>Type: “select by location” in the processing toolbox search bar and open the Select by Location tool</li>
<li>Select the Points as input and click on the disjoint check box and click on Run (Figure 15.3)</li>
</ul>
<p><img src="images/Figure_12.png" alt="Figure 15.3 Select points outside a polygon" />
### Step 5 Export the extracted points</p>
<ul>
<li>Right click on the newly create layer. Got to Export/Save Features As “AOI_Empty_points_borders” (Figure 15.3)
<img src="images/Figure_13.png" alt="Figure 15.3 Export the extracted points" /></li>
</ul>
</div>
<div id="step-6-run-the-spin-up-phase-for-points-outside-the-cru-layer-script-13b" class="section level3">
<h3><span class="header-section-number">15.1.4</span> Step 6 Run the Spin up phase for points outside the CRU layer (Script 13B)</h3>
<p>Scripts 13B, 14B and 15B are modified versions of script 13 (Spin up phase), 14 (Warm up phase) and 15 (Forward phase) which include lines of code that fill NA pixel values from the CRU layers with the average of all surrounding pixel values. The same raster stacks created for the original map can be used as input to run the model over the points that fall outside the CRU layers.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="annex-troubleshooting.html#cb106-1"></a><span class="co">#12/11/2020</span></span>
<span id="cb106-2"><a href="annex-troubleshooting.html#cb106-2"></a></span>
<span id="cb106-3"><a href="annex-troubleshooting.html#cb106-3"></a><span class="co"># SPATIAL SOIL R  for VECTORS</span></span>
<span id="cb106-4"><a href="annex-troubleshooting.html#cb106-4"></a></span>
<span id="cb106-5"><a href="annex-troubleshooting.html#cb106-5"></a><span class="co">###### SPIN UP ################</span></span>
<span id="cb106-6"><a href="annex-troubleshooting.html#cb106-6"></a></span>
<span id="cb106-7"><a href="annex-troubleshooting.html#cb106-7"></a><span class="co"># MSc Ing Agr Luciano E Di Paolo</span></span>
<span id="cb106-8"><a href="annex-troubleshooting.html#cb106-8"></a><span class="co"># Dr Ing Agr Guillermo E Peralta</span></span>
<span id="cb106-9"><a href="annex-troubleshooting.html#cb106-9"></a><span class="co">###################################</span></span>
<span id="cb106-10"><a href="annex-troubleshooting.html#cb106-10"></a><span class="co"># SOilR from Sierra, C.A., M. Mueller, S.E. Trumbore (2012). </span></span>
<span id="cb106-11"><a href="annex-troubleshooting.html#cb106-11"></a><span class="co">#Models of soil organic matter decomposition: the SoilR package, version 1.0 Geoscientific Model Development, 5(4), </span></span>
<span id="cb106-12"><a href="annex-troubleshooting.html#cb106-12"></a><span class="co">#1045--1060. URL http://www.geosci-model-dev.net/5/1045/2012/gmd-5-1045-2012.html.</span></span>
<span id="cb106-13"><a href="annex-troubleshooting.html#cb106-13"></a><span class="co">#####################################</span></span>
<span id="cb106-14"><a href="annex-troubleshooting.html#cb106-14"></a></span>
<span id="cb106-15"><a href="annex-troubleshooting.html#cb106-15"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </span>
<span id="cb106-16"><a href="annex-troubleshooting.html#cb106-16"></a></span>
<span id="cb106-17"><a href="annex-troubleshooting.html#cb106-17"></a><span class="kw">library</span>(SoilR)</span>
<span id="cb106-18"><a href="annex-troubleshooting.html#cb106-18"></a><span class="kw">library</span>(raster)</span>
<span id="cb106-19"><a href="annex-troubleshooting.html#cb106-19"></a><span class="kw">library</span>(rgdal)</span>
<span id="cb106-20"><a href="annex-troubleshooting.html#cb106-20"></a><span class="kw">library</span>(soilassessment)</span>
<span id="cb106-21"><a href="annex-troubleshooting.html#cb106-21"></a></span>
<span id="cb106-22"><a href="annex-troubleshooting.html#cb106-22"></a></span>
<span id="cb106-23"><a href="annex-troubleshooting.html#cb106-23"></a><span class="co"># Set working directory </span></span>
<span id="cb106-24"><a href="annex-troubleshooting.html#cb106-24"></a></span>
<span id="cb106-25"><a href="annex-troubleshooting.html#cb106-25"></a>WD_FOLDER&lt;-(<span class="st">&quot;D:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020&quot;</span>)</span>
<span id="cb106-26"><a href="annex-troubleshooting.html#cb106-26"></a></span>
<span id="cb106-27"><a href="annex-troubleshooting.html#cb106-27"></a><span class="co"># Vector must be an empty points vector. </span></span>
<span id="cb106-28"><a href="annex-troubleshooting.html#cb106-28"></a></span>
<span id="cb106-29"><a href="annex-troubleshooting.html#cb106-29"></a><span class="kw">setwd</span>(WD_FOLDER)</span>
<span id="cb106-30"><a href="annex-troubleshooting.html#cb106-30"></a>Vector&lt;-<span class="kw">readOGR</span>(<span class="st">&quot;INPUTS/TARGET_POINTS/AOI_Empty_points_borders.shp&quot;</span>)</span>
<span id="cb106-31"><a href="annex-troubleshooting.html#cb106-31"></a></span>
<span id="cb106-32"><a href="annex-troubleshooting.html#cb106-32"></a><span class="co"># Stack_Set_1 is a stack that contains the spatial variables </span></span>
<span id="cb106-33"><a href="annex-troubleshooting.html#cb106-33"></a></span>
<span id="cb106-34"><a href="annex-troubleshooting.html#cb106-34"></a>Stack_Set_<span class="dv">1</span>&lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="st">&quot;INPUTS/STACK/Stack_Set_SPIN_UP_AOI.tif&quot;</span>)</span>
<span id="cb106-35"><a href="annex-troubleshooting.html#cb106-35"></a></span>
<span id="cb106-36"><a href="annex-troubleshooting.html#cb106-36"></a><span class="co"># Add pixels to the borders to avoid removing coastal areas</span></span>
<span id="cb106-37"><a href="annex-troubleshooting.html#cb106-37"></a></span>
<span id="cb106-38"><a href="annex-troubleshooting.html#cb106-38"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nlayers</span>(Stack_Set_<span class="dv">1</span>)){</span>
<span id="cb106-39"><a href="annex-troubleshooting.html#cb106-39"></a>  Stack_Set_<span class="dv">1</span>[[i]]&lt;-<span class="kw">focal</span>(Stack_Set_<span class="dv">1</span>[[i]], <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">25</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb106-40"><a href="annex-troubleshooting.html#cb106-40"></a>}</span>
<span id="cb106-41"><a href="annex-troubleshooting.html#cb106-41"></a></span>
<span id="cb106-42"><a href="annex-troubleshooting.html#cb106-42"></a><span class="co"># Create A vector to save the results</span></span>
<span id="cb106-43"><a href="annex-troubleshooting.html#cb106-43"></a></span>
<span id="cb106-44"><a href="annex-troubleshooting.html#cb106-44"></a>C_INPUT_EQ&lt;-Vector</span>
<span id="cb106-45"><a href="annex-troubleshooting.html#cb106-45"></a></span>
<span id="cb106-46"><a href="annex-troubleshooting.html#cb106-46"></a><span class="co"># use this only for backup</span></span>
<span id="cb106-47"><a href="annex-troubleshooting.html#cb106-47"></a></span>
<span id="cb106-48"><a href="annex-troubleshooting.html#cb106-48"></a><span class="co"># C_INPUT_EQ&lt;-readOGR(&quot;OUTPUTS/1_SPIN_UP/SPIN_UP_BSAS_27-03-2020_332376.shp&quot;)</span></span>
<span id="cb106-49"><a href="annex-troubleshooting.html#cb106-49"></a></span>
<span id="cb106-50"><a href="annex-troubleshooting.html#cb106-50"></a><span class="co"># extract variables to points</span></span>
<span id="cb106-51"><a href="annex-troubleshooting.html#cb106-51"></a></span>
<span id="cb106-52"><a href="annex-troubleshooting.html#cb106-52"></a>Vector_variables&lt;-<span class="kw">extract</span>(Stack_Set_<span class="dv">1</span>,Vector,<span class="dt">df=</span><span class="ot">TRUE</span>)</span>
<span id="cb106-53"><a href="annex-troubleshooting.html#cb106-53"></a></span>
<span id="cb106-54"><a href="annex-troubleshooting.html#cb106-54"></a><span class="co"># Extract the layers from the Vector</span></span>
<span id="cb106-55"><a href="annex-troubleshooting.html#cb106-55"></a></span>
<span id="cb106-56"><a href="annex-troubleshooting.html#cb106-56"></a>SOC_im&lt;-Vector_variables[[<span class="dv">2</span>]] <span class="co"># primera banda del stack</span></span>
<span id="cb106-57"><a href="annex-troubleshooting.html#cb106-57"></a></span>
<span id="cb106-58"><a href="annex-troubleshooting.html#cb106-58"></a>clay_im&lt;-Vector_variables[[<span class="dv">3</span>]] <span class="co"># segunda banda del stack </span></span>
<span id="cb106-59"><a href="annex-troubleshooting.html#cb106-59"></a></span>
<span id="cb106-60"><a href="annex-troubleshooting.html#cb106-60"></a>DR_im&lt;-Vector_variables[[<span class="dv">40</span>]]</span>
<span id="cb106-61"><a href="annex-troubleshooting.html#cb106-61"></a></span>
<span id="cb106-62"><a href="annex-troubleshooting.html#cb106-62"></a>LU_im&lt;-Vector_variables[[<span class="dv">41</span>]]</span>
<span id="cb106-63"><a href="annex-troubleshooting.html#cb106-63"></a></span>
<span id="cb106-64"><a href="annex-troubleshooting.html#cb106-64"></a><span class="co"># Define Years for Cinputs calculations</span></span>
<span id="cb106-65"><a href="annex-troubleshooting.html#cb106-65"></a></span>
<span id="cb106-66"><a href="annex-troubleshooting.html#cb106-66"></a>years=<span class="kw">seq</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">12</span>,<span class="dv">500</span>,<span class="dt">by=</span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>)</span>
<span id="cb106-67"><a href="annex-troubleshooting.html#cb106-67"></a></span>
<span id="cb106-68"><a href="annex-troubleshooting.html#cb106-68"></a><span class="co"># ROTH C MODEL FUNCTION . </span></span>
<span id="cb106-69"><a href="annex-troubleshooting.html#cb106-69"></a></span>
<span id="cb106-70"><a href="annex-troubleshooting.html#cb106-70"></a><span class="co">########## function set up starts###############</span></span>
<span id="cb106-71"><a href="annex-troubleshooting.html#cb106-71"></a>Roth_C&lt;-<span class="cf">function</span>(Cinputs,years,DPMptf, RPMptf, BIOptf, HUMptf, FallIOM,Temp,Precip,Evp,Cov,Cov1,Cov2,soil.thick,SOC,clay,DR,bare1,LU)</span>
<span id="cb106-72"><a href="annex-troubleshooting.html#cb106-72"></a></span>
<span id="cb106-73"><a href="annex-troubleshooting.html#cb106-73"></a>{</span>
<span id="cb106-74"><a href="annex-troubleshooting.html#cb106-74"></a></span>
<span id="cb106-75"><a href="annex-troubleshooting.html#cb106-75"></a><span class="co"># Paddy fields coefficent fPR = 0.4 if the target point is class = 13 , else fPR=1</span></span>
<span id="cb106-76"><a href="annex-troubleshooting.html#cb106-76"></a><span class="co"># From Shirato and Yukozawa 2004</span></span>
<span id="cb106-77"><a href="annex-troubleshooting.html#cb106-77"></a></span>
<span id="cb106-78"><a href="annex-troubleshooting.html#cb106-78"></a>fPR=(LU <span class="op">==</span><span class="st"> </span><span class="dv">13</span>)<span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span><span class="st"> </span>(LU<span class="op">!=</span><span class="dv">13</span>)<span class="op">*</span><span class="dv">1</span></span>
<span id="cb106-79"><a href="annex-troubleshooting.html#cb106-79"></a></span>
<span id="cb106-80"><a href="annex-troubleshooting.html#cb106-80"></a><span class="co">#Temperature effects per month</span></span>
<span id="cb106-81"><a href="annex-troubleshooting.html#cb106-81"></a>fT=<span class="kw">fT.RothC</span>(Temp[,<span class="dv">2</span>]) </span>
<span id="cb106-82"><a href="annex-troubleshooting.html#cb106-82"></a></span>
<span id="cb106-83"><a href="annex-troubleshooting.html#cb106-83"></a><span class="co">#Moisture effects per month . </span></span>
<span id="cb106-84"><a href="annex-troubleshooting.html#cb106-84"></a></span>
<span id="cb106-85"><a href="annex-troubleshooting.html#cb106-85"></a>fw1func&lt;-<span class="cf">function</span>(P, E, <span class="dt">S.Thick =</span> <span class="dv">30</span>, <span class="dt">pClay =</span> <span class="fl">32.0213</span>, <span class="dt">pE =</span> <span class="dv">1</span>, bare) </span>
<span id="cb106-86"><a href="annex-troubleshooting.html#cb106-86"></a>{</span>
<span id="cb106-87"><a href="annex-troubleshooting.html#cb106-87"></a>   </span>
<span id="cb106-88"><a href="annex-troubleshooting.html#cb106-88"></a>    M =<span class="st"> </span>P <span class="op">-</span><span class="st"> </span>E <span class="op">*</span><span class="st"> </span>pE</span>
<span id="cb106-89"><a href="annex-troubleshooting.html#cb106-89"></a>    Acc.TSMD =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb106-90"><a href="annex-troubleshooting.html#cb106-90"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(M)) {</span>
<span id="cb106-91"><a href="annex-troubleshooting.html#cb106-91"></a> 	B =<span class="st"> </span><span class="kw">ifelse</span>(bare[i] <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>, <span class="dv">1</span>, <span class="fl">1.8</span>)</span>
<span id="cb106-92"><a href="annex-troubleshooting.html#cb106-92"></a>	 Max.TSMD =<span class="st"> </span><span class="op">-</span>(<span class="dv">20</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.3</span> <span class="op">*</span><span class="st"> </span>pClay <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">*</span><span class="st"> </span>(pClay<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(S.Thick<span class="op">/</span><span class="dv">23</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>B)</span>
<span id="cb106-93"><a href="annex-troubleshooting.html#cb106-93"></a>        Acc.TSMD[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">ifelse</span>(M[<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, M[<span class="dv">1</span>])</span>
<span id="cb106-94"><a href="annex-troubleshooting.html#cb106-94"></a>        <span class="cf">if</span> (Acc.TSMD[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[i] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb106-95"><a href="annex-troubleshooting.html#cb106-95"></a>            Acc.TSMD[i] =<span class="st"> </span>Acc.TSMD[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[i]</span>
<span id="cb106-96"><a href="annex-troubleshooting.html#cb106-96"></a>        }</span>
<span id="cb106-97"><a href="annex-troubleshooting.html#cb106-97"></a>        <span class="cf">else</span> (Acc.TSMD[i] =<span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb106-98"><a href="annex-troubleshooting.html#cb106-98"></a>        <span class="cf">if</span> (Acc.TSMD[i] <span class="op">&lt;=</span><span class="st"> </span>Max.TSMD) {</span>
<span id="cb106-99"><a href="annex-troubleshooting.html#cb106-99"></a>            Acc.TSMD[i] =<span class="st"> </span>Max.TSMD</span>
<span id="cb106-100"><a href="annex-troubleshooting.html#cb106-100"></a>        }</span>
<span id="cb106-101"><a href="annex-troubleshooting.html#cb106-101"></a>    }</span>
<span id="cb106-102"><a href="annex-troubleshooting.html#cb106-102"></a>    b =<span class="st"> </span><span class="kw">ifelse</span>(Acc.TSMD <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.444</span> <span class="op">*</span><span class="st"> </span>Max.TSMD, <span class="dv">1</span>, (<span class="fl">0.2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span>((Max.TSMD <span class="op">-</span><span class="st"> </span></span>
<span id="cb106-103"><a href="annex-troubleshooting.html#cb106-103"></a><span class="st">        </span>Acc.TSMD)<span class="op">/</span>(Max.TSMD <span class="op">-</span><span class="st"> </span><span class="fl">0.444</span> <span class="op">*</span><span class="st"> </span>Max.TSMD))))</span>
<span id="cb106-104"><a href="annex-troubleshooting.html#cb106-104"></a>	b&lt;-<span class="kw">clamp</span>(b,<span class="dt">lower=</span><span class="fl">0.2</span>)</span>
<span id="cb106-105"><a href="annex-troubleshooting.html#cb106-105"></a>    <span class="kw">return</span>(<span class="kw">data.frame</span>(b))	</span>
<span id="cb106-106"><a href="annex-troubleshooting.html#cb106-106"></a>}</span>
<span id="cb106-107"><a href="annex-troubleshooting.html#cb106-107"></a></span>
<span id="cb106-108"><a href="annex-troubleshooting.html#cb106-108"></a>fW_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">fw1func</span>(<span class="dt">P=</span>(Precip[,<span class="dv">2</span>]), <span class="dt">E=</span>(Evp[,<span class="dv">2</span>]), <span class="dt">S.Thick =</span> soil.thick, <span class="dt">pClay =</span> clay, <span class="dt">pE =</span> <span class="dv">1</span>, <span class="dt">bare=</span>bare1)<span class="op">$</span>b </span>
<span id="cb106-109"><a href="annex-troubleshooting.html#cb106-109"></a></span>
<span id="cb106-110"><a href="annex-troubleshooting.html#cb106-110"></a><span class="co">#Vegetation Cover effects </span></span>
<span id="cb106-111"><a href="annex-troubleshooting.html#cb106-111"></a></span>
<span id="cb106-112"><a href="annex-troubleshooting.html#cb106-112"></a>fC&lt;-Cov2[,<span class="dv">2</span>]</span>
<span id="cb106-113"><a href="annex-troubleshooting.html#cb106-113"></a></span>
<span id="cb106-114"><a href="annex-troubleshooting.html#cb106-114"></a><span class="co"># Set the factors frame for Model calculations</span></span>
<span id="cb106-115"><a href="annex-troubleshooting.html#cb106-115"></a></span>
<span id="cb106-116"><a href="annex-troubleshooting.html#cb106-116"></a>xi.frame=<span class="kw">data.frame</span>(years,<span class="kw">rep</span>(fT<span class="op">*</span>fW_<span class="dv">2</span><span class="op">*</span>fC<span class="op">*</span>fPR,<span class="dt">length.out=</span><span class="kw">length</span>(years)))</span>
<span id="cb106-117"><a href="annex-troubleshooting.html#cb106-117"></a></span>
<span id="cb106-118"><a href="annex-troubleshooting.html#cb106-118"></a><span class="co"># RUN THE MODEL from soilassessment</span></span>
<span id="cb106-119"><a href="annex-troubleshooting.html#cb106-119"></a><span class="co">#Roth C soilassesment</span></span>
<span id="cb106-120"><a href="annex-troubleshooting.html#cb106-120"></a>Model3_spin=<span class="kw">carbonTurnover</span>(<span class="dt">tt=</span>years,<span class="dt">C0=</span><span class="kw">c</span>(DPMptf, RPMptf, BIOptf, HUMptf, FallIOM),<span class="dt">In=</span>Cinputs,<span class="dt">Dr=</span>DR,<span class="dt">clay=</span>clay,<span class="dt">effcts=</span>xi.frame, <span class="st">&quot;euler&quot;</span>) </span>
<span id="cb106-121"><a href="annex-troubleshooting.html#cb106-121"></a>Ct3_spin=Model3_spin[,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb106-122"><a href="annex-troubleshooting.html#cb106-122"></a></span>
<span id="cb106-123"><a href="annex-troubleshooting.html#cb106-123"></a><span class="co"># RUN THE MODEL FROM SOILR</span></span>
<span id="cb106-124"><a href="annex-troubleshooting.html#cb106-124"></a><span class="co">#Model3_spin=RothCModel(t=years,C0=c(DPMptf, RPMptf, BIOptf, HUMptf, FallIOM),In=Cinputs,DR=DR,clay=clay,xi=xi.frame, pass=TRUE) </span></span>
<span id="cb106-125"><a href="annex-troubleshooting.html#cb106-125"></a><span class="co">#Ct3_spin=getC(Model3_spin)</span></span>
<span id="cb106-126"><a href="annex-troubleshooting.html#cb106-126"></a></span>
<span id="cb106-127"><a href="annex-troubleshooting.html#cb106-127"></a><span class="co"># Get the final pools of the time series</span></span>
<span id="cb106-128"><a href="annex-troubleshooting.html#cb106-128"></a>poolSize3_spin=<span class="kw">as.numeric</span>(<span class="kw">tail</span>(Ct3_spin,<span class="dv">1</span>))</span>
<span id="cb106-129"><a href="annex-troubleshooting.html#cb106-129"></a></span>
<span id="cb106-130"><a href="annex-troubleshooting.html#cb106-130"></a><span class="kw">return</span>(poolSize3_spin)</span>
<span id="cb106-131"><a href="annex-troubleshooting.html#cb106-131"></a>}</span>
<span id="cb106-132"><a href="annex-troubleshooting.html#cb106-132"></a><span class="co">########## function set up ends###############</span></span>
<span id="cb106-133"><a href="annex-troubleshooting.html#cb106-133"></a></span>
<span id="cb106-134"><a href="annex-troubleshooting.html#cb106-134"></a><span class="co"># Iterates over the area of interest</span></span>
<span id="cb106-135"><a href="annex-troubleshooting.html#cb106-135"></a></span>
<span id="cb106-136"><a href="annex-troubleshooting.html#cb106-136"></a><span class="co">########for loop starts###############3</span></span>
<span id="cb106-137"><a href="annex-troubleshooting.html#cb106-137"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(Vector_variables)[<span class="dv">1</span>]) {</span>
<span id="cb106-138"><a href="annex-troubleshooting.html#cb106-138"></a></span>
<span id="cb106-139"><a href="annex-troubleshooting.html#cb106-139"></a><span class="co"># Extract the variables </span></span>
<span id="cb106-140"><a href="annex-troubleshooting.html#cb106-140"></a></span>
<span id="cb106-141"><a href="annex-troubleshooting.html#cb106-141"></a>Vect&lt;-<span class="kw">as.data.frame</span>(Vector_variables[i,])</span>
<span id="cb106-142"><a href="annex-troubleshooting.html#cb106-142"></a></span>
<span id="cb106-143"><a href="annex-troubleshooting.html#cb106-143"></a>Temp&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">4</span><span class="op">:</span><span class="dv">15</span>]))</span>
<span id="cb106-144"><a href="annex-troubleshooting.html#cb106-144"></a>Temp&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Temp=</span>Temp[,<span class="dv">1</span>])</span>
<span id="cb106-145"><a href="annex-troubleshooting.html#cb106-145"></a></span>
<span id="cb106-146"><a href="annex-troubleshooting.html#cb106-146"></a>Precip&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">16</span><span class="op">:</span><span class="dv">27</span>]))</span>
<span id="cb106-147"><a href="annex-troubleshooting.html#cb106-147"></a>Precip&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Precip=</span>Precip[,<span class="dv">1</span>])</span>
<span id="cb106-148"><a href="annex-troubleshooting.html#cb106-148"></a></span>
<span id="cb106-149"><a href="annex-troubleshooting.html#cb106-149"></a>Evp&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">28</span><span class="op">:</span><span class="dv">39</span>]))</span>
<span id="cb106-150"><a href="annex-troubleshooting.html#cb106-150"></a>Evp&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Evp=</span>Evp[,<span class="dv">1</span>])</span>
<span id="cb106-151"><a href="annex-troubleshooting.html#cb106-151"></a>	</span>
<span id="cb106-152"><a href="annex-troubleshooting.html#cb106-152"></a>Cov&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">42</span><span class="op">:</span><span class="dv">53</span>]))</span>
<span id="cb106-153"><a href="annex-troubleshooting.html#cb106-153"></a>Cov1&lt;-<span class="kw">data.frame</span>(<span class="dt">Cov=</span>Cov[,<span class="dv">1</span>])</span>
<span id="cb106-154"><a href="annex-troubleshooting.html#cb106-154"></a>Cov2&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Cov=</span>Cov[,<span class="dv">1</span>])</span>
<span id="cb106-155"><a href="annex-troubleshooting.html#cb106-155"></a></span>
<span id="cb106-156"><a href="annex-troubleshooting.html#cb106-156"></a><span class="co">#Avoid calculus over Na values </span></span>
<span id="cb106-157"><a href="annex-troubleshooting.html#cb106-157"></a></span>
<span id="cb106-158"><a href="annex-troubleshooting.html#cb106-158"></a><span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.na</span>(Evp[,<span class="dv">2</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Temp[,<span class="dv">2</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(SOC_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(clay_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Precip[,<span class="dv">2</span>]))  <span class="op">|</span><span class="st">  </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cov2[,<span class="dv">2</span>]))  <span class="op">|</span><span class="st">  </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cov1[,<span class="dv">1</span>]))  <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(DR_im[i])) <span class="op">|</span><span class="st">  </span>(SOC_im[i]<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">|</span><span class="st"> </span>(clay_im[i]<span class="op">&lt;</span><span class="dv">0</span>) ) {C_INPUT_EQ[i,<span class="dv">2</span>]&lt;-<span class="dv">0</span>}<span class="cf">else</span>{</span>
<span id="cb106-159"><a href="annex-troubleshooting.html#cb106-159"></a></span>
<span id="cb106-160"><a href="annex-troubleshooting.html#cb106-160"></a><span class="co"># Set the variables from the images</span></span>
<span id="cb106-161"><a href="annex-troubleshooting.html#cb106-161"></a></span>
<span id="cb106-162"><a href="annex-troubleshooting.html#cb106-162"></a>soil.thick=<span class="dv">30</span>  <span class="co">#Soil thickness (organic layer topsoil), in cm</span></span>
<span id="cb106-163"><a href="annex-troubleshooting.html#cb106-163"></a>SOC&lt;-SOC_im[i]      <span class="co">#Soil organic carbon in Mg/ha </span></span>
<span id="cb106-164"><a href="annex-troubleshooting.html#cb106-164"></a>clay&lt;-clay_im[i]        <span class="co">#Percent clay %</span></span>
<span id="cb106-165"><a href="annex-troubleshooting.html#cb106-165"></a></span>
<span id="cb106-166"><a href="annex-troubleshooting.html#cb106-166"></a>DR&lt;-DR_im[i]              <span class="co"># DPM/RPM (decomplosable vs resistant plant material.)</span></span>
<span id="cb106-167"><a href="annex-troubleshooting.html#cb106-167"></a>bare1&lt;-(Cov1<span class="op">&gt;</span><span class="fl">0.8</span>)           <span class="co"># If the surface is bare or vegetated</span></span>
<span id="cb106-168"><a href="annex-troubleshooting.html#cb106-168"></a>LU&lt;-LU_im[i]</span>
<span id="cb106-169"><a href="annex-troubleshooting.html#cb106-169"></a></span>
<span id="cb106-170"><a href="annex-troubleshooting.html#cb106-170"></a><span class="co">#IOM using Falloon method</span></span>
<span id="cb106-171"><a href="annex-troubleshooting.html#cb106-171"></a>FallIOM=<span class="fl">0.049</span><span class="op">*</span>SOC<span class="op">^</span>(<span class="fl">1.139</span>) </span>
<span id="cb106-172"><a href="annex-troubleshooting.html#cb106-172"></a></span>
<span id="cb106-173"><a href="annex-troubleshooting.html#cb106-173"></a><span class="co"># If you use a SOC uncertainty layer turn on this. First open the layer SOC_UNC </span></span>
<span id="cb106-174"><a href="annex-troubleshooting.html#cb106-174"></a><span class="co">#(it must have the same extent and resolution of the SOC layer)</span></span>
<span id="cb106-175"><a href="annex-troubleshooting.html#cb106-175"></a></span>
<span id="cb106-176"><a href="annex-troubleshooting.html#cb106-176"></a><span class="co">#SOC_min&lt;-(1-(SOC_UNC/100))*SOC</span></span>
<span id="cb106-177"><a href="annex-troubleshooting.html#cb106-177"></a><span class="co">#SOC_max&lt;-(1+(SOC_UNC/100))*SOC</span></span>
<span id="cb106-178"><a href="annex-troubleshooting.html#cb106-178"></a></span>
<span id="cb106-179"><a href="annex-troubleshooting.html#cb106-179"></a><span class="co"># Define SOC min, max Clay min and max. </span></span>
<span id="cb106-180"><a href="annex-troubleshooting.html#cb106-180"></a>SOC_min&lt;-SOC<span class="op">*</span><span class="fl">0.8</span></span>
<span id="cb106-181"><a href="annex-troubleshooting.html#cb106-181"></a>SOC_max&lt;-SOC<span class="op">*</span><span class="fl">1.2</span></span>
<span id="cb106-182"><a href="annex-troubleshooting.html#cb106-182"></a>clay_min&lt;-clay<span class="op">*</span><span class="fl">0.9</span></span>
<span id="cb106-183"><a href="annex-troubleshooting.html#cb106-183"></a>clay_max&lt;-clay<span class="op">*</span><span class="fl">1.1</span></span>
<span id="cb106-184"><a href="annex-troubleshooting.html#cb106-184"></a></span>
<span id="cb106-185"><a href="annex-troubleshooting.html#cb106-185"></a>b&lt;-<span class="dv">1</span></span>
<span id="cb106-186"><a href="annex-troubleshooting.html#cb106-186"></a></span>
<span id="cb106-187"><a href="annex-troubleshooting.html#cb106-187"></a><span class="co"># C input equilibrium. (Ceq)</span></span>
<span id="cb106-188"><a href="annex-troubleshooting.html#cb106-188"></a></span>
<span id="cb106-189"><a href="annex-troubleshooting.html#cb106-189"></a>fb&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>b,<span class="dt">years=</span>years,<span class="dt">DPMptf=</span><span class="dv">0</span>, <span class="dt">RPMptf=</span><span class="dv">0</span>, <span class="dt">BIOptf=</span><span class="dv">0</span>, <span class="dt">HUMptf=</span><span class="dv">0</span>, <span class="dt">FallIOM=</span>FallIOM,<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb106-190"><a href="annex-troubleshooting.html#cb106-190"></a>fb_t&lt;-fb[<span class="dv">1</span>]<span class="op">+</span>fb[<span class="dv">2</span>]<span class="op">+</span>fb[<span class="dv">3</span>]<span class="op">+</span>fb[<span class="dv">4</span>]<span class="op">+</span>fb[<span class="dv">5</span>]</span>
<span id="cb106-191"><a href="annex-troubleshooting.html#cb106-191"></a></span>
<span id="cb106-192"><a href="annex-troubleshooting.html#cb106-192"></a>m&lt;-(fb_t<span class="op">-</span>FallIOM)<span class="op">/</span>(b)</span>
<span id="cb106-193"><a href="annex-troubleshooting.html#cb106-193"></a></span>
<span id="cb106-194"><a href="annex-troubleshooting.html#cb106-194"></a>Ceq&lt;-(SOC<span class="op">-</span>FallIOM)<span class="op">/</span>m</span>
<span id="cb106-195"><a href="annex-troubleshooting.html#cb106-195"></a></span>
<span id="cb106-196"><a href="annex-troubleshooting.html#cb106-196"></a><span class="co"># UNCERTAINTIES C input equilibrium (MINIMUM)</span></span>
<span id="cb106-197"><a href="annex-troubleshooting.html#cb106-197"></a>FallIOM_min=<span class="fl">0.049</span><span class="op">*</span>SOC_min<span class="op">^</span>(<span class="fl">1.139</span>) </span>
<span id="cb106-198"><a href="annex-troubleshooting.html#cb106-198"></a></span>
<span id="cb106-199"><a href="annex-troubleshooting.html#cb106-199"></a>fb_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>b,<span class="dt">years=</span>years,<span class="dt">DPMptf=</span><span class="dv">0</span>, <span class="dt">RPMptf=</span><span class="dv">0</span>, <span class="dt">BIOptf=</span><span class="dv">0</span>, <span class="dt">HUMptf=</span><span class="dv">0</span>, <span class="dt">FallIOM=</span>FallIOM,<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC_min,<span class="dt">clay=</span>clay_min,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb106-200"><a href="annex-troubleshooting.html#cb106-200"></a>fb_t_MIN&lt;-fb_min[<span class="dv">1</span>]<span class="op">+</span>fb_min[<span class="dv">2</span>]<span class="op">+</span>fb_min[<span class="dv">3</span>]<span class="op">+</span>fb_min[<span class="dv">4</span>]<span class="op">+</span>fb_min[<span class="dv">5</span>]</span>
<span id="cb106-201"><a href="annex-troubleshooting.html#cb106-201"></a></span>
<span id="cb106-202"><a href="annex-troubleshooting.html#cb106-202"></a>m&lt;-(fb_t_MIN<span class="op">-</span>FallIOM_min)<span class="op">/</span>(b)</span>
<span id="cb106-203"><a href="annex-troubleshooting.html#cb106-203"></a></span>
<span id="cb106-204"><a href="annex-troubleshooting.html#cb106-204"></a>Ceq_MIN&lt;-(SOC_min<span class="op">-</span>FallIOM_min)<span class="op">/</span>m</span>
<span id="cb106-205"><a href="annex-troubleshooting.html#cb106-205"></a></span>
<span id="cb106-206"><a href="annex-troubleshooting.html#cb106-206"></a><span class="co"># UNCERTAINTIES C input equilibrium (MAXIMUM)</span></span>
<span id="cb106-207"><a href="annex-troubleshooting.html#cb106-207"></a>FallIOM_max=<span class="fl">0.049</span><span class="op">*</span>SOC_max<span class="op">^</span>(<span class="fl">1.139</span>) </span>
<span id="cb106-208"><a href="annex-troubleshooting.html#cb106-208"></a></span>
<span id="cb106-209"><a href="annex-troubleshooting.html#cb106-209"></a>fb_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>b,<span class="dt">years=</span>years,<span class="dt">DPMptf=</span><span class="dv">0</span>, <span class="dt">RPMptf=</span><span class="dv">0</span>, <span class="dt">BIOptf=</span><span class="dv">0</span>, <span class="dt">HUMptf=</span><span class="dv">0</span>, <span class="dt">FallIOM=</span>FallIOM,<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC_max,<span class="dt">clay=</span>clay_max,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb106-210"><a href="annex-troubleshooting.html#cb106-210"></a>fb_t_MAX&lt;-fb_max[<span class="dv">1</span>]<span class="op">+</span>fb_max[<span class="dv">2</span>]<span class="op">+</span>fb_max[<span class="dv">3</span>]<span class="op">+</span>fb_max[<span class="dv">4</span>]<span class="op">+</span>fb_max[<span class="dv">5</span>]</span>
<span id="cb106-211"><a href="annex-troubleshooting.html#cb106-211"></a></span>
<span id="cb106-212"><a href="annex-troubleshooting.html#cb106-212"></a>m&lt;-(fb_t_MAX<span class="op">-</span>FallIOM_max)<span class="op">/</span>(b)</span>
<span id="cb106-213"><a href="annex-troubleshooting.html#cb106-213"></a></span>
<span id="cb106-214"><a href="annex-troubleshooting.html#cb106-214"></a>Ceq_MAX&lt;-(SOC_max<span class="op">-</span>FallIOM_max)<span class="op">/</span>m</span>
<span id="cb106-215"><a href="annex-troubleshooting.html#cb106-215"></a> </span>
<span id="cb106-216"><a href="annex-troubleshooting.html#cb106-216"></a><span class="co"># SOC POOLS AFTER 500 YEARS RUN WITH C INPUT EQUILIBRIUM</span></span>
<span id="cb106-217"><a href="annex-troubleshooting.html#cb106-217"></a></span>
<span id="cb106-218"><a href="annex-troubleshooting.html#cb106-218"></a><span class="cf">if</span> (LU<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">13</span>){</span>
<span id="cb106-219"><a href="annex-troubleshooting.html#cb106-219"></a>RPM_p_<span class="dv">2</span>&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">0.9902+0.4788</span></span>
<span id="cb106-220"><a href="annex-troubleshooting.html#cb106-220"></a>BIO_p_<span class="dv">2</span>&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">1.09038+0.04055</span></span>
<span id="cb106-221"><a href="annex-troubleshooting.html#cb106-221"></a>HUM_p_<span class="dv">2</span>&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.9878-0.3818</span></span>
<span id="cb106-222"><a href="annex-troubleshooting.html#cb106-222"></a>DPM_p_<span class="dv">2</span>&lt;-SOC<span class="op">-</span>FallIOM<span class="op">-</span>RPM_p_<span class="dv">2</span><span class="op">-</span>HUM_p_<span class="dv">2</span><span class="op">-</span>BIO_p_<span class="dv">2</span></span>
<span id="cb106-223"><a href="annex-troubleshooting.html#cb106-223"></a></span>
<span id="cb106-224"><a href="annex-troubleshooting.html#cb106-224"></a>feq_t&lt;-RPM_p_<span class="dv">2</span><span class="op">+</span>BIO_p_<span class="dv">2</span><span class="op">+</span>HUM_p_<span class="dv">2</span><span class="op">+</span>DPM_p_<span class="dv">2</span><span class="op">+</span>FallIOM</span>
<span id="cb106-225"><a href="annex-troubleshooting.html#cb106-225"></a></span>
<span id="cb106-226"><a href="annex-troubleshooting.html#cb106-226"></a><span class="co">#uncertainties  MIN</span></span>
<span id="cb106-227"><a href="annex-troubleshooting.html#cb106-227"></a></span>
<span id="cb106-228"><a href="annex-troubleshooting.html#cb106-228"></a>RPM_p_<span class="dv">2</span>_min&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">0.9902+0.4788</span></span>
<span id="cb106-229"><a href="annex-troubleshooting.html#cb106-229"></a>BIO_p_<span class="dv">2</span>_min&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">1.09038+0.04055</span></span>
<span id="cb106-230"><a href="annex-troubleshooting.html#cb106-230"></a>HUM_p_<span class="dv">2</span>_min&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.9878-0.3818</span></span>
<span id="cb106-231"><a href="annex-troubleshooting.html#cb106-231"></a>DPM_p_<span class="dv">2</span>_min&lt;-SOC_min<span class="op">-</span>FallIOM_min<span class="op">-</span>RPM_p_<span class="dv">2</span>_min<span class="op">-</span>HUM_p_<span class="dv">2</span>_min<span class="op">-</span>BIO_p_<span class="dv">2</span>_min</span>
<span id="cb106-232"><a href="annex-troubleshooting.html#cb106-232"></a></span>
<span id="cb106-233"><a href="annex-troubleshooting.html#cb106-233"></a>feq_t_min&lt;-RPM_p_<span class="dv">2</span>_min<span class="op">+</span>BIO_p_<span class="dv">2</span>_min<span class="op">+</span>HUM_p_<span class="dv">2</span>_min<span class="op">+</span>DPM_p_<span class="dv">2</span>_min<span class="op">+</span>FallIOM_min</span>
<span id="cb106-234"><a href="annex-troubleshooting.html#cb106-234"></a></span>
<span id="cb106-235"><a href="annex-troubleshooting.html#cb106-235"></a><span class="co">#uncertainties  MAX</span></span>
<span id="cb106-236"><a href="annex-troubleshooting.html#cb106-236"></a></span>
<span id="cb106-237"><a href="annex-troubleshooting.html#cb106-237"></a>RPM_p_<span class="dv">2</span>_max&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">0.9902+0.4788</span></span>
<span id="cb106-238"><a href="annex-troubleshooting.html#cb106-238"></a>BIO_p_<span class="dv">2</span>_max&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">1.09038+0.04055</span></span>
<span id="cb106-239"><a href="annex-troubleshooting.html#cb106-239"></a>HUM_p_<span class="dv">2</span>_max&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.9878-0.3818</span></span>
<span id="cb106-240"><a href="annex-troubleshooting.html#cb106-240"></a>DPM_p_<span class="dv">2</span>_max&lt;-SOC_max<span class="op">-</span>FallIOM_max<span class="op">-</span>RPM_p_<span class="dv">2</span>_max<span class="op">-</span>HUM_p_<span class="dv">2</span>_max<span class="op">-</span>BIO_p_<span class="dv">2</span>_max</span>
<span id="cb106-241"><a href="annex-troubleshooting.html#cb106-241"></a></span>
<span id="cb106-242"><a href="annex-troubleshooting.html#cb106-242"></a>feq_t_max&lt;-RPM_p_<span class="dv">2</span>_max<span class="op">+</span>BIO_p_<span class="dv">2</span>_max<span class="op">+</span>HUM_p_<span class="dv">2</span>_max<span class="op">+</span>DPM_p_<span class="dv">2</span>_max<span class="op">+</span>FallIOM_max</span>
<span id="cb106-243"><a href="annex-troubleshooting.html#cb106-243"></a></span>
<span id="cb106-244"><a href="annex-troubleshooting.html#cb106-244"></a>C_INPUT_EQ[i,<span class="dv">2</span>]&lt;-SOC</span>
<span id="cb106-245"><a href="annex-troubleshooting.html#cb106-245"></a>C_INPUT_EQ[i,<span class="dv">3</span>]&lt;-Ceq</span>
<span id="cb106-246"><a href="annex-troubleshooting.html#cb106-246"></a>C_INPUT_EQ[i,<span class="dv">4</span>]&lt;-feq_t</span>
<span id="cb106-247"><a href="annex-troubleshooting.html#cb106-247"></a>C_INPUT_EQ[i,<span class="dv">5</span>]&lt;-DPM_p_<span class="dv">2</span></span>
<span id="cb106-248"><a href="annex-troubleshooting.html#cb106-248"></a>C_INPUT_EQ[i,<span class="dv">6</span>]&lt;-RPM_p_<span class="dv">2</span></span>
<span id="cb106-249"><a href="annex-troubleshooting.html#cb106-249"></a>C_INPUT_EQ[i,<span class="dv">7</span>]&lt;-BIO_p_<span class="dv">2</span></span>
<span id="cb106-250"><a href="annex-troubleshooting.html#cb106-250"></a>C_INPUT_EQ[i,<span class="dv">8</span>]&lt;-HUM_p_<span class="dv">2</span></span>
<span id="cb106-251"><a href="annex-troubleshooting.html#cb106-251"></a>C_INPUT_EQ[i,<span class="dv">9</span>]&lt;-FallIOM</span>
<span id="cb106-252"><a href="annex-troubleshooting.html#cb106-252"></a>C_INPUT_EQ[i,<span class="dv">10</span>]&lt;-Ceq_MIN</span>
<span id="cb106-253"><a href="annex-troubleshooting.html#cb106-253"></a>C_INPUT_EQ[i,<span class="dv">11</span>]&lt;-Ceq_MAX</span>
<span id="cb106-254"><a href="annex-troubleshooting.html#cb106-254"></a>C_INPUT_EQ[i,<span class="dv">12</span>]&lt;-feq_t_min</span>
<span id="cb106-255"><a href="annex-troubleshooting.html#cb106-255"></a>C_INPUT_EQ[i,<span class="dv">13</span>]&lt;-DPM_p_<span class="dv">2</span>_min</span>
<span id="cb106-256"><a href="annex-troubleshooting.html#cb106-256"></a>C_INPUT_EQ[i,<span class="dv">14</span>]&lt;-RPM_p_<span class="dv">2</span>_min</span>
<span id="cb106-257"><a href="annex-troubleshooting.html#cb106-257"></a>C_INPUT_EQ[i,<span class="dv">15</span>]&lt;-BIO_p_<span class="dv">2</span>_min</span>
<span id="cb106-258"><a href="annex-troubleshooting.html#cb106-258"></a>C_INPUT_EQ[i,<span class="dv">16</span>]&lt;-HUM_p_<span class="dv">2</span>_min</span>
<span id="cb106-259"><a href="annex-troubleshooting.html#cb106-259"></a>C_INPUT_EQ[i,<span class="dv">17</span>]&lt;-FallIOM_min</span>
<span id="cb106-260"><a href="annex-troubleshooting.html#cb106-260"></a>C_INPUT_EQ[i,<span class="dv">18</span>]&lt;-feq_t_max</span>
<span id="cb106-261"><a href="annex-troubleshooting.html#cb106-261"></a>C_INPUT_EQ[i,<span class="dv">19</span>]&lt;-DPM_p_<span class="dv">2</span>_max</span>
<span id="cb106-262"><a href="annex-troubleshooting.html#cb106-262"></a>C_INPUT_EQ[i,<span class="dv">20</span>]&lt;-RPM_p_<span class="dv">2</span>_max</span>
<span id="cb106-263"><a href="annex-troubleshooting.html#cb106-263"></a>C_INPUT_EQ[i,<span class="dv">21</span>]&lt;-BIO_p_<span class="dv">2</span>_max</span>
<span id="cb106-264"><a href="annex-troubleshooting.html#cb106-264"></a>C_INPUT_EQ[i,<span class="dv">22</span>]&lt;-HUM_p_<span class="dv">2</span>_max</span>
<span id="cb106-265"><a href="annex-troubleshooting.html#cb106-265"></a>C_INPUT_EQ[i,<span class="dv">23</span>]&lt;-FallIOM_max</span>
<span id="cb106-266"><a href="annex-troubleshooting.html#cb106-266"></a></span>
<span id="cb106-267"><a href="annex-troubleshooting.html#cb106-267"></a>}<span class="cf">else</span> <span class="cf">if</span>(LU<span class="op">==</span><span class="dv">4</span>){</span>
<span id="cb106-268"><a href="annex-troubleshooting.html#cb106-268"></a></span>
<span id="cb106-269"><a href="annex-troubleshooting.html#cb106-269"></a>RPM_p_<span class="dv">4</span>&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">1.7631+0.4043</span></span>
<span id="cb106-270"><a href="annex-troubleshooting.html#cb106-270"></a>BIO_p_<span class="dv">4</span>&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">0.9757+0.0209</span></span>
<span id="cb106-271"><a href="annex-troubleshooting.html#cb106-271"></a>HUM_p_<span class="dv">4</span>&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.8712-0.2904</span></span>
<span id="cb106-272"><a href="annex-troubleshooting.html#cb106-272"></a>DPM_p_<span class="dv">4</span>&lt;-SOC<span class="op">-</span>FallIOM<span class="op">-</span>RPM_p_<span class="dv">4</span><span class="op">-</span>HUM_p_<span class="dv">4</span><span class="op">-</span>BIO_p_<span class="dv">4</span></span>
<span id="cb106-273"><a href="annex-troubleshooting.html#cb106-273"></a></span>
<span id="cb106-274"><a href="annex-troubleshooting.html#cb106-274"></a>feq_t&lt;-RPM_p_<span class="dv">4</span><span class="op">+</span>BIO_p_<span class="dv">4</span><span class="op">+</span>HUM_p_<span class="dv">4</span><span class="op">+</span>DPM_p_<span class="dv">4</span><span class="op">+</span>FallIOM</span>
<span id="cb106-275"><a href="annex-troubleshooting.html#cb106-275"></a></span>
<span id="cb106-276"><a href="annex-troubleshooting.html#cb106-276"></a><span class="co">#uncertainties min</span></span>
<span id="cb106-277"><a href="annex-troubleshooting.html#cb106-277"></a></span>
<span id="cb106-278"><a href="annex-troubleshooting.html#cb106-278"></a>RPM_p_<span class="dv">4</span>_min&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">1.7631+0.4043</span></span>
<span id="cb106-279"><a href="annex-troubleshooting.html#cb106-279"></a>BIO_p_<span class="dv">4</span>_min&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">0.9757+0.0209</span></span>
<span id="cb106-280"><a href="annex-troubleshooting.html#cb106-280"></a>HUM_p_<span class="dv">4</span>_min&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.8712-0.2904</span></span>
<span id="cb106-281"><a href="annex-troubleshooting.html#cb106-281"></a>DPM_p_<span class="dv">4</span>_min&lt;-SOC_min<span class="op">-</span>FallIOM_min<span class="op">-</span>RPM_p_<span class="dv">4</span>_min<span class="op">-</span>HUM_p_<span class="dv">4</span>_min<span class="op">-</span>BIO_p_<span class="dv">4</span>_min</span>
<span id="cb106-282"><a href="annex-troubleshooting.html#cb106-282"></a></span>
<span id="cb106-283"><a href="annex-troubleshooting.html#cb106-283"></a>feq_t_min&lt;-RPM_p_<span class="dv">4</span>_min<span class="op">+</span>BIO_p_<span class="dv">4</span>_min<span class="op">+</span>HUM_p_<span class="dv">4</span>_min<span class="op">+</span>DPM_p_<span class="dv">4</span>_min<span class="op">+</span>FallIOM_min</span>
<span id="cb106-284"><a href="annex-troubleshooting.html#cb106-284"></a></span>
<span id="cb106-285"><a href="annex-troubleshooting.html#cb106-285"></a><span class="co">#uncertainties max</span></span>
<span id="cb106-286"><a href="annex-troubleshooting.html#cb106-286"></a></span>
<span id="cb106-287"><a href="annex-troubleshooting.html#cb106-287"></a>RPM_p_<span class="dv">4</span>_max&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">1.7631+0.4043</span></span>
<span id="cb106-288"><a href="annex-troubleshooting.html#cb106-288"></a>BIO_p_<span class="dv">4</span>_max&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">0.9757+0.0209</span></span>
<span id="cb106-289"><a href="annex-troubleshooting.html#cb106-289"></a>HUM_p_<span class="dv">4</span>_max&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.8712-0.2904</span></span>
<span id="cb106-290"><a href="annex-troubleshooting.html#cb106-290"></a>DPM_p_<span class="dv">4</span>_max&lt;-SOC_max<span class="op">-</span>FallIOM_max<span class="op">-</span>RPM_p_<span class="dv">4</span>_max<span class="op">-</span>HUM_p_<span class="dv">4</span>_max<span class="op">-</span>BIO_p_<span class="dv">4</span>_max</span>
<span id="cb106-291"><a href="annex-troubleshooting.html#cb106-291"></a></span>
<span id="cb106-292"><a href="annex-troubleshooting.html#cb106-292"></a>feq_t_max&lt;-RPM_p_<span class="dv">4</span>_max<span class="op">+</span>BIO_p_<span class="dv">4</span>_max<span class="op">+</span>HUM_p_<span class="dv">4</span>_max<span class="op">+</span>DPM_p_<span class="dv">4</span>_max<span class="op">+</span>FallIOM_max</span>
<span id="cb106-293"><a href="annex-troubleshooting.html#cb106-293"></a></span>
<span id="cb106-294"><a href="annex-troubleshooting.html#cb106-294"></a>C_INPUT_EQ[i,<span class="dv">2</span>]&lt;-SOC</span>
<span id="cb106-295"><a href="annex-troubleshooting.html#cb106-295"></a>C_INPUT_EQ[i,<span class="dv">3</span>]&lt;-Ceq</span>
<span id="cb106-296"><a href="annex-troubleshooting.html#cb106-296"></a>C_INPUT_EQ[i,<span class="dv">4</span>]&lt;-feq_t</span>
<span id="cb106-297"><a href="annex-troubleshooting.html#cb106-297"></a>C_INPUT_EQ[i,<span class="dv">5</span>]&lt;-DPM_p_<span class="dv">4</span></span>
<span id="cb106-298"><a href="annex-troubleshooting.html#cb106-298"></a>C_INPUT_EQ[i,<span class="dv">6</span>]&lt;-RPM_p_<span class="dv">4</span></span>
<span id="cb106-299"><a href="annex-troubleshooting.html#cb106-299"></a>C_INPUT_EQ[i,<span class="dv">7</span>]&lt;-BIO_p_<span class="dv">4</span></span>
<span id="cb106-300"><a href="annex-troubleshooting.html#cb106-300"></a>C_INPUT_EQ[i,<span class="dv">8</span>]&lt;-HUM_p_<span class="dv">4</span></span>
<span id="cb106-301"><a href="annex-troubleshooting.html#cb106-301"></a>C_INPUT_EQ[i,<span class="dv">9</span>]&lt;-FallIOM</span>
<span id="cb106-302"><a href="annex-troubleshooting.html#cb106-302"></a>C_INPUT_EQ[i,<span class="dv">10</span>]&lt;-Ceq_MIN</span>
<span id="cb106-303"><a href="annex-troubleshooting.html#cb106-303"></a>C_INPUT_EQ[i,<span class="dv">11</span>]&lt;-Ceq_MAX</span>
<span id="cb106-304"><a href="annex-troubleshooting.html#cb106-304"></a>C_INPUT_EQ[i,<span class="dv">12</span>]&lt;-feq_t_min</span>
<span id="cb106-305"><a href="annex-troubleshooting.html#cb106-305"></a>C_INPUT_EQ[i,<span class="dv">13</span>]&lt;-DPM_p_<span class="dv">4</span>_min</span>
<span id="cb106-306"><a href="annex-troubleshooting.html#cb106-306"></a>C_INPUT_EQ[i,<span class="dv">14</span>]&lt;-RPM_p_<span class="dv">4</span>_min</span>
<span id="cb106-307"><a href="annex-troubleshooting.html#cb106-307"></a>C_INPUT_EQ[i,<span class="dv">15</span>]&lt;-BIO_p_<span class="dv">4</span>_min</span>
<span id="cb106-308"><a href="annex-troubleshooting.html#cb106-308"></a>C_INPUT_EQ[i,<span class="dv">16</span>]&lt;-HUM_p_<span class="dv">4</span>_min</span>
<span id="cb106-309"><a href="annex-troubleshooting.html#cb106-309"></a>C_INPUT_EQ[i,<span class="dv">17</span>]&lt;-FallIOM_min</span>
<span id="cb106-310"><a href="annex-troubleshooting.html#cb106-310"></a>C_INPUT_EQ[i,<span class="dv">18</span>]&lt;-feq_t_max</span>
<span id="cb106-311"><a href="annex-troubleshooting.html#cb106-311"></a>C_INPUT_EQ[i,<span class="dv">19</span>]&lt;-DPM_p_<span class="dv">4</span>_max</span>
<span id="cb106-312"><a href="annex-troubleshooting.html#cb106-312"></a>C_INPUT_EQ[i,<span class="dv">20</span>]&lt;-RPM_p_<span class="dv">4</span>_max</span>
<span id="cb106-313"><a href="annex-troubleshooting.html#cb106-313"></a>C_INPUT_EQ[i,<span class="dv">21</span>]&lt;-BIO_p_<span class="dv">4</span>_max</span>
<span id="cb106-314"><a href="annex-troubleshooting.html#cb106-314"></a>C_INPUT_EQ[i,<span class="dv">22</span>]&lt;-HUM_p_<span class="dv">4</span>_max</span>
<span id="cb106-315"><a href="annex-troubleshooting.html#cb106-315"></a>C_INPUT_EQ[i,<span class="dv">23</span>]&lt;-FallIOM_max</span>
<span id="cb106-316"><a href="annex-troubleshooting.html#cb106-316"></a></span>
<span id="cb106-317"><a href="annex-troubleshooting.html#cb106-317"></a>} <span class="cf">else</span> <span class="cf">if</span> (LU<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">8</span>){</span>
<span id="cb106-318"><a href="annex-troubleshooting.html#cb106-318"></a></span>
<span id="cb106-319"><a href="annex-troubleshooting.html#cb106-319"></a>RPM_p_<span class="dv">3</span>&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">1.3837+0.4692</span></span>
<span id="cb106-320"><a href="annex-troubleshooting.html#cb106-320"></a>BIO_p_<span class="dv">3</span>&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">1.03401+0.02531</span></span>
<span id="cb106-321"><a href="annex-troubleshooting.html#cb106-321"></a>HUM_p_<span class="dv">3</span>&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.9316-0.5243</span></span>
<span id="cb106-322"><a href="annex-troubleshooting.html#cb106-322"></a>DPM_p_<span class="dv">3</span>&lt;-SOC<span class="op">-</span>FallIOM<span class="op">-</span>RPM_p_<span class="dv">3</span><span class="op">-</span>HUM_p_<span class="dv">3</span><span class="op">-</span>BIO_p_<span class="dv">3</span></span>
<span id="cb106-323"><a href="annex-troubleshooting.html#cb106-323"></a></span>
<span id="cb106-324"><a href="annex-troubleshooting.html#cb106-324"></a>feq_t&lt;-RPM_p_<span class="dv">3</span><span class="op">+</span>BIO_p_<span class="dv">3</span><span class="op">+</span>HUM_p_<span class="dv">3</span><span class="op">+</span>DPM_p_<span class="dv">3</span><span class="op">+</span>FallIOM</span>
<span id="cb106-325"><a href="annex-troubleshooting.html#cb106-325"></a></span>
<span id="cb106-326"><a href="annex-troubleshooting.html#cb106-326"></a><span class="co">#uncertainties min</span></span>
<span id="cb106-327"><a href="annex-troubleshooting.html#cb106-327"></a></span>
<span id="cb106-328"><a href="annex-troubleshooting.html#cb106-328"></a>RPM_p_<span class="dv">3</span>_min&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">1.3837+0.4692</span></span>
<span id="cb106-329"><a href="annex-troubleshooting.html#cb106-329"></a>BIO_p_<span class="dv">3</span>_min&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">1.03401+0.02531</span></span>
<span id="cb106-330"><a href="annex-troubleshooting.html#cb106-330"></a>HUM_p_<span class="dv">3</span>_min&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC_min <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay_min <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.9316-0.5243</span></span>
<span id="cb106-331"><a href="annex-troubleshooting.html#cb106-331"></a>DPM_p_<span class="dv">3</span>_min&lt;-SOC_min<span class="op">-</span>FallIOM_min<span class="op">-</span>RPM_p_<span class="dv">3</span>_min<span class="op">-</span>HUM_p_<span class="dv">3</span>_min<span class="op">-</span>BIO_p_<span class="dv">3</span>_min</span>
<span id="cb106-332"><a href="annex-troubleshooting.html#cb106-332"></a></span>
<span id="cb106-333"><a href="annex-troubleshooting.html#cb106-333"></a>feq_t_min&lt;-RPM_p_<span class="dv">3</span>_min<span class="op">+</span>BIO_p_<span class="dv">3</span>_min<span class="op">+</span>HUM_p_<span class="dv">3</span>_min<span class="op">+</span>DPM_p_<span class="dv">3</span>_min<span class="op">+</span>FallIOM_min</span>
<span id="cb106-334"><a href="annex-troubleshooting.html#cb106-334"></a></span>
<span id="cb106-335"><a href="annex-troubleshooting.html#cb106-335"></a><span class="co">#uncertainties max</span></span>
<span id="cb106-336"><a href="annex-troubleshooting.html#cb106-336"></a></span>
<span id="cb106-337"><a href="annex-troubleshooting.html#cb106-337"></a>RPM_p_<span class="dv">3</span>_max&lt;-((<span class="fl">0.184</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.1555</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">1.275</span>)<span class="op">^</span>(<span class="op">-</span><span class="fl">0.1158</span>))<span class="op">*</span><span class="fl">1.3837+0.4692</span></span>
<span id="cb106-338"><a href="annex-troubleshooting.html#cb106-338"></a>BIO_p_<span class="dv">3</span>_max&lt;-((<span class="fl">0.014</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.0075</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">8.8473</span>)<span class="op">^</span>(<span class="fl">0.0567</span>))<span class="op">*</span><span class="fl">1.03401+0.02531</span></span>
<span id="cb106-339"><a href="annex-troubleshooting.html#cb106-339"></a>HUM_p_<span class="dv">3</span>_max&lt;-((<span class="fl">0.7148</span><span class="op">*</span>SOC_max <span class="op">+</span><span class="st"> </span><span class="fl">0.5069</span>)<span class="op">*</span>(clay_max <span class="op">+</span><span class="st"> </span><span class="fl">0.3421</span>)<span class="op">^</span>(<span class="fl">0.0184</span>))<span class="op">*</span><span class="fl">0.9316-0.5243</span></span>
<span id="cb106-340"><a href="annex-troubleshooting.html#cb106-340"></a>DPM_p_<span class="dv">3</span>_max&lt;-SOC_max<span class="op">-</span>FallIOM_max<span class="op">-</span>RPM_p_<span class="dv">3</span>_max<span class="op">-</span>HUM_p_<span class="dv">3</span>_max<span class="op">-</span>BIO_p_<span class="dv">3</span>_max</span>
<span id="cb106-341"><a href="annex-troubleshooting.html#cb106-341"></a></span>
<span id="cb106-342"><a href="annex-troubleshooting.html#cb106-342"></a>feq_t_max&lt;-RPM_p_<span class="dv">3</span>_max<span class="op">+</span>BIO_p_<span class="dv">3</span>_max<span class="op">+</span>HUM_p_<span class="dv">3</span>_max<span class="op">+</span>DPM_p_<span class="dv">3</span>_max<span class="op">+</span>FallIOM_max</span>
<span id="cb106-343"><a href="annex-troubleshooting.html#cb106-343"></a></span>
<span id="cb106-344"><a href="annex-troubleshooting.html#cb106-344"></a></span>
<span id="cb106-345"><a href="annex-troubleshooting.html#cb106-345"></a>C_INPUT_EQ[i,<span class="dv">2</span>]&lt;-SOC</span>
<span id="cb106-346"><a href="annex-troubleshooting.html#cb106-346"></a>C_INPUT_EQ[i,<span class="dv">3</span>]&lt;-Ceq</span>
<span id="cb106-347"><a href="annex-troubleshooting.html#cb106-347"></a>C_INPUT_EQ[i,<span class="dv">4</span>]&lt;-feq_t</span>
<span id="cb106-348"><a href="annex-troubleshooting.html#cb106-348"></a>C_INPUT_EQ[i,<span class="dv">5</span>]&lt;-DPM_p_<span class="dv">3</span></span>
<span id="cb106-349"><a href="annex-troubleshooting.html#cb106-349"></a>C_INPUT_EQ[i,<span class="dv">6</span>]&lt;-RPM_p_<span class="dv">3</span></span>
<span id="cb106-350"><a href="annex-troubleshooting.html#cb106-350"></a>C_INPUT_EQ[i,<span class="dv">7</span>]&lt;-BIO_p_<span class="dv">3</span></span>
<span id="cb106-351"><a href="annex-troubleshooting.html#cb106-351"></a>C_INPUT_EQ[i,<span class="dv">8</span>]&lt;-HUM_p_<span class="dv">3</span></span>
<span id="cb106-352"><a href="annex-troubleshooting.html#cb106-352"></a>C_INPUT_EQ[i,<span class="dv">9</span>]&lt;-FallIOM</span>
<span id="cb106-353"><a href="annex-troubleshooting.html#cb106-353"></a>C_INPUT_EQ[i,<span class="dv">10</span>]&lt;-Ceq_MIN</span>
<span id="cb106-354"><a href="annex-troubleshooting.html#cb106-354"></a>C_INPUT_EQ[i,<span class="dv">11</span>]&lt;-Ceq_MAX</span>
<span id="cb106-355"><a href="annex-troubleshooting.html#cb106-355"></a>C_INPUT_EQ[i,<span class="dv">12</span>]&lt;-feq_t_min</span>
<span id="cb106-356"><a href="annex-troubleshooting.html#cb106-356"></a>C_INPUT_EQ[i,<span class="dv">13</span>]&lt;-DPM_p_<span class="dv">3</span>_min</span>
<span id="cb106-357"><a href="annex-troubleshooting.html#cb106-357"></a>C_INPUT_EQ[i,<span class="dv">14</span>]&lt;-RPM_p_<span class="dv">3</span>_min</span>
<span id="cb106-358"><a href="annex-troubleshooting.html#cb106-358"></a>C_INPUT_EQ[i,<span class="dv">15</span>]&lt;-BIO_p_<span class="dv">3</span>_min</span>
<span id="cb106-359"><a href="annex-troubleshooting.html#cb106-359"></a>C_INPUT_EQ[i,<span class="dv">16</span>]&lt;-HUM_p_<span class="dv">3</span>_min</span>
<span id="cb106-360"><a href="annex-troubleshooting.html#cb106-360"></a>C_INPUT_EQ[i,<span class="dv">17</span>]&lt;-FallIOM_min</span>
<span id="cb106-361"><a href="annex-troubleshooting.html#cb106-361"></a>C_INPUT_EQ[i,<span class="dv">18</span>]&lt;-feq_t_max</span>
<span id="cb106-362"><a href="annex-troubleshooting.html#cb106-362"></a>C_INPUT_EQ[i,<span class="dv">19</span>]&lt;-DPM_p_<span class="dv">3</span>_max</span>
<span id="cb106-363"><a href="annex-troubleshooting.html#cb106-363"></a>C_INPUT_EQ[i,<span class="dv">20</span>]&lt;-RPM_p_<span class="dv">3</span>_max</span>
<span id="cb106-364"><a href="annex-troubleshooting.html#cb106-364"></a>C_INPUT_EQ[i,<span class="dv">21</span>]&lt;-BIO_p_<span class="dv">3</span>_max</span>
<span id="cb106-365"><a href="annex-troubleshooting.html#cb106-365"></a>C_INPUT_EQ[i,<span class="dv">22</span>]&lt;-HUM_p_<span class="dv">3</span>_max</span>
<span id="cb106-366"><a href="annex-troubleshooting.html#cb106-366"></a>C_INPUT_EQ[i,<span class="dv">23</span>]&lt;-FallIOM_max</span>
<span id="cb106-367"><a href="annex-troubleshooting.html#cb106-367"></a></span>
<span id="cb106-368"><a href="annex-troubleshooting.html#cb106-368"></a>}<span class="cf">else</span> {</span>
<span id="cb106-369"><a href="annex-troubleshooting.html#cb106-369"></a>C_INPUT_EQ[i,<span class="dv">2</span>]&lt;-SOC</span>
<span id="cb106-370"><a href="annex-troubleshooting.html#cb106-370"></a>C_INPUT_EQ[i,<span class="dv">3</span>]&lt;-Ceq</span>
<span id="cb106-371"><a href="annex-troubleshooting.html#cb106-371"></a>C_INPUT_EQ[i,<span class="dv">4</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-372"><a href="annex-troubleshooting.html#cb106-372"></a>C_INPUT_EQ[i,<span class="dv">5</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-373"><a href="annex-troubleshooting.html#cb106-373"></a>C_INPUT_EQ[i,<span class="dv">6</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-374"><a href="annex-troubleshooting.html#cb106-374"></a>C_INPUT_EQ[i,<span class="dv">7</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-375"><a href="annex-troubleshooting.html#cb106-375"></a>C_INPUT_EQ[i,<span class="dv">8</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-376"><a href="annex-troubleshooting.html#cb106-376"></a>C_INPUT_EQ[i,<span class="dv">9</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-377"><a href="annex-troubleshooting.html#cb106-377"></a>C_INPUT_EQ[i,<span class="dv">10</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-378"><a href="annex-troubleshooting.html#cb106-378"></a>C_INPUT_EQ[i,<span class="dv">11</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-379"><a href="annex-troubleshooting.html#cb106-379"></a>C_INPUT_EQ[i,<span class="dv">12</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-380"><a href="annex-troubleshooting.html#cb106-380"></a>C_INPUT_EQ[i,<span class="dv">13</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-381"><a href="annex-troubleshooting.html#cb106-381"></a>C_INPUT_EQ[i,<span class="dv">14</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-382"><a href="annex-troubleshooting.html#cb106-382"></a>C_INPUT_EQ[i,<span class="dv">15</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-383"><a href="annex-troubleshooting.html#cb106-383"></a>C_INPUT_EQ[i,<span class="dv">16</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-384"><a href="annex-troubleshooting.html#cb106-384"></a>C_INPUT_EQ[i,<span class="dv">17</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-385"><a href="annex-troubleshooting.html#cb106-385"></a>C_INPUT_EQ[i,<span class="dv">18</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-386"><a href="annex-troubleshooting.html#cb106-386"></a>C_INPUT_EQ[i,<span class="dv">19</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-387"><a href="annex-troubleshooting.html#cb106-387"></a>C_INPUT_EQ[i,<span class="dv">20</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-388"><a href="annex-troubleshooting.html#cb106-388"></a>C_INPUT_EQ[i,<span class="dv">21</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-389"><a href="annex-troubleshooting.html#cb106-389"></a>C_INPUT_EQ[i,<span class="dv">22</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-390"><a href="annex-troubleshooting.html#cb106-390"></a>C_INPUT_EQ[i,<span class="dv">23</span>]&lt;-<span class="dv">0</span></span>
<span id="cb106-391"><a href="annex-troubleshooting.html#cb106-391"></a></span>
<span id="cb106-392"><a href="annex-troubleshooting.html#cb106-392"></a>}</span>
<span id="cb106-393"><a href="annex-troubleshooting.html#cb106-393"></a></span>
<span id="cb106-394"><a href="annex-troubleshooting.html#cb106-394"></a><span class="kw">print</span>(<span class="kw">c</span>(i,SOC,Ceq))</span>
<span id="cb106-395"><a href="annex-troubleshooting.html#cb106-395"></a></span>
<span id="cb106-396"><a href="annex-troubleshooting.html#cb106-396"></a>}</span>
<span id="cb106-397"><a href="annex-troubleshooting.html#cb106-397"></a>}</span>
<span id="cb106-398"><a href="annex-troubleshooting.html#cb106-398"></a><span class="co">###############for loop ends##############</span></span>
<span id="cb106-399"><a href="annex-troubleshooting.html#cb106-399"></a></span>
<span id="cb106-400"><a href="annex-troubleshooting.html#cb106-400"></a></span>
<span id="cb106-401"><a href="annex-troubleshooting.html#cb106-401"></a><span class="co">#rename de columns</span></span>
<span id="cb106-402"><a href="annex-troubleshooting.html#cb106-402"></a></span>
<span id="cb106-403"><a href="annex-troubleshooting.html#cb106-403"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">2</span>]=<span class="st">&quot;SOC_FAO&quot;</span></span>
<span id="cb106-404"><a href="annex-troubleshooting.html#cb106-404"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">3</span>]=<span class="st">&quot;Cinput_EQ&quot;</span></span>
<span id="cb106-405"><a href="annex-troubleshooting.html#cb106-405"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">4</span>]=<span class="st">&quot;SOC_pedotransfer&quot;</span></span>
<span id="cb106-406"><a href="annex-troubleshooting.html#cb106-406"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">5</span>]=<span class="st">&quot;DPM_pedotransfer&quot;</span></span>
<span id="cb106-407"><a href="annex-troubleshooting.html#cb106-407"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">6</span>]=<span class="st">&quot;RPM_pedotransfer&quot;</span></span>
<span id="cb106-408"><a href="annex-troubleshooting.html#cb106-408"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">7</span>]=<span class="st">&quot;BIO_pedotransfer&quot;</span></span>
<span id="cb106-409"><a href="annex-troubleshooting.html#cb106-409"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">8</span>]=<span class="st">&quot;HUM_pedotransfer&quot;</span></span>
<span id="cb106-410"><a href="annex-troubleshooting.html#cb106-410"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">9</span>]=<span class="st">&quot;IOM_pedotransfer&quot;</span></span>
<span id="cb106-411"><a href="annex-troubleshooting.html#cb106-411"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">10</span>]=<span class="st">&quot;CIneq_min&quot;</span></span>
<span id="cb106-412"><a href="annex-troubleshooting.html#cb106-412"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">11</span>]=<span class="st">&quot;CIneq_max&quot;</span></span>
<span id="cb106-413"><a href="annex-troubleshooting.html#cb106-413"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">12</span>]=<span class="st">&quot;SOC_min&quot;</span></span>
<span id="cb106-414"><a href="annex-troubleshooting.html#cb106-414"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">13</span>]=<span class="st">&quot;DPM_min&quot;</span></span>
<span id="cb106-415"><a href="annex-troubleshooting.html#cb106-415"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">14</span>]=<span class="st">&quot;RPM_min&quot;</span></span>
<span id="cb106-416"><a href="annex-troubleshooting.html#cb106-416"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">15</span>]=<span class="st">&quot;BIO_min&quot;</span></span>
<span id="cb106-417"><a href="annex-troubleshooting.html#cb106-417"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">16</span>]=<span class="st">&quot;HUM_min&quot;</span></span>
<span id="cb106-418"><a href="annex-troubleshooting.html#cb106-418"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">17</span>]=<span class="st">&quot;IOM_min&quot;</span></span>
<span id="cb106-419"><a href="annex-troubleshooting.html#cb106-419"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">18</span>]=<span class="st">&quot;SOC_max&quot;</span></span>
<span id="cb106-420"><a href="annex-troubleshooting.html#cb106-420"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">19</span>]=<span class="st">&quot;DPM_max&quot;</span></span>
<span id="cb106-421"><a href="annex-troubleshooting.html#cb106-421"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">20</span>]=<span class="st">&quot;RPM_max&quot;</span></span>
<span id="cb106-422"><a href="annex-troubleshooting.html#cb106-422"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">21</span>]=<span class="st">&quot;BIO_max&quot;</span></span>
<span id="cb106-423"><a href="annex-troubleshooting.html#cb106-423"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">22</span>]=<span class="st">&quot;HUM_max&quot;</span></span>
<span id="cb106-424"><a href="annex-troubleshooting.html#cb106-424"></a><span class="kw">colnames</span>(C_INPUT_EQ<span class="op">@</span>data)[<span class="dv">23</span>]=<span class="st">&quot;IOM_max&quot;</span></span>
<span id="cb106-425"><a href="annex-troubleshooting.html#cb106-425"></a></span>
<span id="cb106-426"><a href="annex-troubleshooting.html#cb106-426"></a><span class="co"># SAVE the Points (shapefile)</span></span>
<span id="cb106-427"><a href="annex-troubleshooting.html#cb106-427"></a></span>
<span id="cb106-428"><a href="annex-troubleshooting.html#cb106-428"></a><span class="kw">setwd</span>(<span class="st">&quot;D:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020/OUTPUTS/1_SPIN_UP&quot;</span>)</span>
<span id="cb106-429"><a href="annex-troubleshooting.html#cb106-429"></a><span class="kw">writeOGR</span>(C_INPUT_EQ, <span class="st">&quot;.&quot;</span>, <span class="st">&quot;SPIN_UP_County_AOI&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>,<span class="dt">overwrite=</span><span class="ot">TRUE</span>) </span></code></pre></div>
</div>
<div id="step-7-run-the-warm-up-phase-for-points-outside-the-cru-layer-script-14b" class="section level3">
<h3><span class="header-section-number">15.1.5</span> Step 7 Run the Warm up phase for points outside the CRU layer (Script 14B)</h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="annex-troubleshooting.html#cb107-1"></a><span class="co">#12/11/2020</span></span>
<span id="cb107-2"><a href="annex-troubleshooting.html#cb107-2"></a></span>
<span id="cb107-3"><a href="annex-troubleshooting.html#cb107-3"></a><span class="co"># SPATIAL SOIL R  for VECTORS</span></span>
<span id="cb107-4"><a href="annex-troubleshooting.html#cb107-4"></a></span>
<span id="cb107-5"><a href="annex-troubleshooting.html#cb107-5"></a><span class="co">#   ROTH C phase 3: WARM UP</span></span>
<span id="cb107-6"><a href="annex-troubleshooting.html#cb107-6"></a></span>
<span id="cb107-7"><a href="annex-troubleshooting.html#cb107-7"></a><span class="co"># MSc Ing Agr Luciano E Di Paolo</span></span>
<span id="cb107-8"><a href="annex-troubleshooting.html#cb107-8"></a><span class="co"># Dr Ing Agr Guillermo E Peralta</span></span>
<span id="cb107-9"><a href="annex-troubleshooting.html#cb107-9"></a><span class="co">###################################</span></span>
<span id="cb107-10"><a href="annex-troubleshooting.html#cb107-10"></a><span class="co"># SOilR from Sierra, C.A., M. Mueller, S.E. Trumbore (2012). </span></span>
<span id="cb107-11"><a href="annex-troubleshooting.html#cb107-11"></a><span class="co">#Models of soil organic matter decomposition: the SoilR package, version 1.0 Geoscientific Model Development, 5(4), </span></span>
<span id="cb107-12"><a href="annex-troubleshooting.html#cb107-12"></a><span class="co">#1045--1060. URL http://www.geosci-model-dev.net/5/1045/2012/gmd-5-1045-2012.html.</span></span>
<span id="cb107-13"><a href="annex-troubleshooting.html#cb107-13"></a><span class="co">#####################################</span></span>
<span id="cb107-14"><a href="annex-troubleshooting.html#cb107-14"></a></span>
<span id="cb107-15"><a href="annex-troubleshooting.html#cb107-15"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </span>
<span id="cb107-16"><a href="annex-troubleshooting.html#cb107-16"></a></span>
<span id="cb107-17"><a href="annex-troubleshooting.html#cb107-17"></a><span class="kw">library</span>(SoilR)</span>
<span id="cb107-18"><a href="annex-troubleshooting.html#cb107-18"></a><span class="kw">library</span>(raster)</span>
<span id="cb107-19"><a href="annex-troubleshooting.html#cb107-19"></a><span class="kw">library</span>(rgdal)</span>
<span id="cb107-20"><a href="annex-troubleshooting.html#cb107-20"></a><span class="kw">library</span>(soilassessment)</span>
<span id="cb107-21"><a href="annex-troubleshooting.html#cb107-21"></a></span>
<span id="cb107-22"><a href="annex-troubleshooting.html#cb107-22"></a>working_dir&lt;-<span class="kw">setwd</span>(<span class="st">&quot;D:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020&quot;</span>)</span>
<span id="cb107-23"><a href="annex-troubleshooting.html#cb107-23"></a></span>
<span id="cb107-24"><a href="annex-troubleshooting.html#cb107-24"></a><span class="co">#Open empty vector</span></span>
<span id="cb107-25"><a href="annex-troubleshooting.html#cb107-25"></a></span>
<span id="cb107-26"><a href="annex-troubleshooting.html#cb107-26"></a>Vector&lt;-<span class="kw">readOGR</span>(<span class="st">&quot;INPUTS/TARGET_POINTS/AOI_Empty_points_borders.shp&quot;</span>)</span>
<span id="cb107-27"><a href="annex-troubleshooting.html#cb107-27"></a></span>
<span id="cb107-28"><a href="annex-troubleshooting.html#cb107-28"></a><span class="co">#Open Warm Up Stack</span></span>
<span id="cb107-29"><a href="annex-troubleshooting.html#cb107-29"></a></span>
<span id="cb107-30"><a href="annex-troubleshooting.html#cb107-30"></a>Stack_Set_warmup&lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="st">&quot;INPUTS/STACK/Stack_Set_WARM_UP_AOI.tif&quot;</span>)</span>
<span id="cb107-31"><a href="annex-troubleshooting.html#cb107-31"></a></span>
<span id="cb107-32"><a href="annex-troubleshooting.html#cb107-32"></a><span class="co"># Add pixels to the borders to avoid removing costal areas</span></span>
<span id="cb107-33"><a href="annex-troubleshooting.html#cb107-33"></a></span>
<span id="cb107-34"><a href="annex-troubleshooting.html#cb107-34"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nlayers</span>(Stack_Set_warmup)){</span>
<span id="cb107-35"><a href="annex-troubleshooting.html#cb107-35"></a>  Stack_Set_warmup[[i]]&lt;-<span class="kw">focal</span>(Stack_Set_warmup[[i]], <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">25</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-36"><a href="annex-troubleshooting.html#cb107-36"></a>}</span>
<span id="cb107-37"><a href="annex-troubleshooting.html#cb107-37"></a></span>
<span id="cb107-38"><a href="annex-troubleshooting.html#cb107-38"></a><span class="co"># Open Result from SPIN UP PROCESS. A vector with 5 columns , one for each pool</span></span>
<span id="cb107-39"><a href="annex-troubleshooting.html#cb107-39"></a></span>
<span id="cb107-40"><a href="annex-troubleshooting.html#cb107-40"></a>Spin_up&lt;-<span class="kw">readOGR</span>(<span class="st">&quot;D:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020/OUTPUTS/1_SPIN_UP/SPIN_UP_County_AOI.shp&quot;</span>)</span>
<span id="cb107-41"><a href="annex-troubleshooting.html#cb107-41"></a>Spin_up&lt;-<span class="kw">as.data.frame</span>(Spin_up)</span>
<span id="cb107-42"><a href="annex-troubleshooting.html#cb107-42"></a></span>
<span id="cb107-43"><a href="annex-troubleshooting.html#cb107-43"></a><span class="co"># Open Precipitation , temperature, and EVapotranspiration file 20 anios x 12 = 240 layers x 3</span></span>
<span id="cb107-44"><a href="annex-troubleshooting.html#cb107-44"></a></span>
<span id="cb107-45"><a href="annex-troubleshooting.html#cb107-45"></a><span class="co"># CRU LAYERS</span></span>
<span id="cb107-46"><a href="annex-troubleshooting.html#cb107-46"></a>PREC&lt;-<span class="kw">stack</span>(<span class="st">&quot;INPUTS/CRU_LAYERS/Prec_Stack_216_01-18_CRU.tif&quot;</span>)</span>
<span id="cb107-47"><a href="annex-troubleshooting.html#cb107-47"></a>TEMP&lt;-<span class="kw">stack</span>(<span class="st">&quot;INPUTS/CRU_LAYERS/Temp_Stack_216_01-18_CRU.tif&quot;</span>)</span>
<span id="cb107-48"><a href="annex-troubleshooting.html#cb107-48"></a>PET&lt;-<span class="kw">stack</span>(<span class="st">&quot;INPUTS/CRU_LAYERS/PET_Stack_216_01-18_CRU.tif&quot;</span>)</span>
<span id="cb107-49"><a href="annex-troubleshooting.html#cb107-49"></a></span>
<span id="cb107-50"><a href="annex-troubleshooting.html#cb107-50"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nlayers</span>(PREC)){</span>
<span id="cb107-51"><a href="annex-troubleshooting.html#cb107-51"></a>  PREC[[i]]&lt;-<span class="kw">focal</span>(PREC[[i]], <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-52"><a href="annex-troubleshooting.html#cb107-52"></a>}</span>
<span id="cb107-53"><a href="annex-troubleshooting.html#cb107-53"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nlayers</span>(TEMP)){</span>
<span id="cb107-54"><a href="annex-troubleshooting.html#cb107-54"></a>  TEMP[[i]]&lt;-<span class="kw">focal</span>(TEMP[[i]], <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-55"><a href="annex-troubleshooting.html#cb107-55"></a>}</span>
<span id="cb107-56"><a href="annex-troubleshooting.html#cb107-56"></a></span>
<span id="cb107-57"><a href="annex-troubleshooting.html#cb107-57"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nlayers</span>(PET)){</span>
<span id="cb107-58"><a href="annex-troubleshooting.html#cb107-58"></a>  PET[[i]]&lt;-<span class="kw">focal</span>(PET[[i]], <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-59"><a href="annex-troubleshooting.html#cb107-59"></a>}</span>
<span id="cb107-60"><a href="annex-troubleshooting.html#cb107-60"></a></span>
<span id="cb107-61"><a href="annex-troubleshooting.html#cb107-61"></a></span>
<span id="cb107-62"><a href="annex-troubleshooting.html#cb107-62"></a><span class="co"># TERRA CLIMATE LAYERS</span></span>
<span id="cb107-63"><a href="annex-troubleshooting.html#cb107-63"></a><span class="co">#PREC&lt;-stack(&quot;INPUTS/TERRA_CLIME/Precipitation_2001-2021_Pergamino.tif&quot;)</span></span>
<span id="cb107-64"><a href="annex-troubleshooting.html#cb107-64"></a><span class="co">#TEMP&lt;-stack(&quot;INPUTS/TERRA_CLIME/AverageTemperature_2001-2021_Pergamino.tif&quot;)*0.1</span></span>
<span id="cb107-65"><a href="annex-troubleshooting.html#cb107-65"></a><span class="co">#PET&lt;-stack(&quot;INPUTS/TERRA_CLIME/PET_2001-2021_Pergamino.tif&quot;)*0.1</span></span>
<span id="cb107-66"><a href="annex-troubleshooting.html#cb107-66"></a></span>
<span id="cb107-67"><a href="annex-troubleshooting.html#cb107-67"></a><span class="co">#Open Mean NPP MIAMI 1981 - 2000</span></span>
<span id="cb107-68"><a href="annex-troubleshooting.html#cb107-68"></a></span>
<span id="cb107-69"><a href="annex-troubleshooting.html#cb107-69"></a>NPP&lt;-<span class="kw">raster</span>(<span class="st">&quot;INPUTS/NPP/NPP_MIAMI_MEAN_81-00_AOI.tif&quot;</span>)</span>
<span id="cb107-70"><a href="annex-troubleshooting.html#cb107-70"></a>NPP&lt;-<span class="kw">focal</span>(NPP, <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-71"><a href="annex-troubleshooting.html#cb107-71"></a></span>
<span id="cb107-72"><a href="annex-troubleshooting.html#cb107-72"></a>NPP_MEAN_MIN&lt;-<span class="kw">raster</span>(<span class="st">&quot;INPUTS/NPP/NPP_MIAMI_MEAN_81-00_AOI_MIN.tif&quot;</span>)</span>
<span id="cb107-73"><a href="annex-troubleshooting.html#cb107-73"></a>NPP_MEAN_MIN&lt;-<span class="kw">focal</span>(NPP_MEAN_MIN, <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-74"><a href="annex-troubleshooting.html#cb107-74"></a></span>
<span id="cb107-75"><a href="annex-troubleshooting.html#cb107-75"></a>NPP_MEAN_MAX&lt;-<span class="kw">raster</span>(<span class="st">&quot;INPUTS/NPP/NPP_MIAMI_MEAN_81-00_AOI_MAX.tif&quot;</span>)</span>
<span id="cb107-76"><a href="annex-troubleshooting.html#cb107-76"></a>NPP_MEAN_MAX&lt;-<span class="kw">focal</span>(NPP_MEAN_MAX, <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-77"><a href="annex-troubleshooting.html#cb107-77"></a></span>
<span id="cb107-78"><a href="annex-troubleshooting.html#cb107-78"></a><span class="co">#Open LU layer (year 2000).</span></span>
<span id="cb107-79"><a href="annex-troubleshooting.html#cb107-79"></a></span>
<span id="cb107-80"><a href="annex-troubleshooting.html#cb107-80"></a>LU_AOI&lt;-<span class="kw">raster</span>(<span class="st">&quot;INPUTS/LAND_USE/ESA_Land_Cover_12clases_FAO_AOI.tif&quot;</span>)</span>
<span id="cb107-81"><a href="annex-troubleshooting.html#cb107-81"></a></span>
<span id="cb107-82"><a href="annex-troubleshooting.html#cb107-82"></a><span class="co">#Apply NPP coeficientes</span></span>
<span id="cb107-83"><a href="annex-troubleshooting.html#cb107-83"></a>NPP&lt;-(LU_AOI<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">13</span>)<span class="op">*</span>NPP<span class="op">*</span><span class="fl">0.53</span><span class="op">+</span><span class="st"> </span>(LU_AOI<span class="op">==</span><span class="dv">4</span>)<span class="op">*</span>NPP<span class="op">*</span><span class="fl">0.88</span> <span class="op">+</span><span class="st"> </span>(LU_AOI<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">8</span>)<span class="op">*</span>NPP<span class="op">*</span><span class="fl">0.72</span></span>
<span id="cb107-84"><a href="annex-troubleshooting.html#cb107-84"></a>NPP_MEAN_MIN&lt;-(LU_AOI<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">13</span>)<span class="op">*</span>NPP_MEAN_MIN<span class="op">*</span><span class="fl">0.53</span><span class="op">+</span><span class="st"> </span>(LU_AOI<span class="op">==</span><span class="dv">4</span>)<span class="op">*</span>NPP_MEAN_MIN<span class="op">*</span><span class="fl">0.88</span> <span class="op">+</span><span class="st"> </span>(LU_AOI<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">8</span>)<span class="op">*</span>NPP_MEAN_MIN<span class="op">*</span><span class="fl">0.72</span></span>
<span id="cb107-85"><a href="annex-troubleshooting.html#cb107-85"></a>NPP_MEAN_MAX&lt;-(LU_AOI<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">13</span>)<span class="op">*</span>NPP_MEAN_MAX<span class="op">*</span><span class="fl">0.53</span><span class="op">+</span><span class="st"> </span>(LU_AOI<span class="op">==</span><span class="dv">4</span>)<span class="op">*</span>NPP_MEAN_MAX<span class="op">*</span><span class="fl">0.88</span> <span class="op">+</span><span class="st"> </span>(LU_AOI<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU_AOI<span class="op">==</span><span class="dv">8</span>)<span class="op">*</span>NPP_MEAN_MAX<span class="op">*</span><span class="fl">0.72</span></span>
<span id="cb107-86"><a href="annex-troubleshooting.html#cb107-86"></a></span>
<span id="cb107-87"><a href="annex-troubleshooting.html#cb107-87"></a></span>
<span id="cb107-88"><a href="annex-troubleshooting.html#cb107-88"></a><span class="co"># Extract variables to points</span></span>
<span id="cb107-89"><a href="annex-troubleshooting.html#cb107-89"></a></span>
<span id="cb107-90"><a href="annex-troubleshooting.html#cb107-90"></a>Vector_points&lt;-<span class="kw">extract</span>(Stack_Set_warmup,Vector,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-91"><a href="annex-troubleshooting.html#cb107-91"></a>Vector_points&lt;-<span class="kw">extract</span>(TEMP,Vector_points,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-92"><a href="annex-troubleshooting.html#cb107-92"></a>Vector_points&lt;-<span class="kw">extract</span>(PREC,Vector_points,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-93"><a href="annex-troubleshooting.html#cb107-93"></a>Vector_points&lt;-<span class="kw">extract</span>(PET,Vector_points,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-94"><a href="annex-troubleshooting.html#cb107-94"></a>Vector_points&lt;-<span class="kw">extract</span>(NPP,Vector_points,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-95"><a href="annex-troubleshooting.html#cb107-95"></a>Vector_points&lt;-<span class="kw">extract</span>(NPP_MEAN_MIN,Vector_points,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-96"><a href="annex-troubleshooting.html#cb107-96"></a>Vector_points&lt;-<span class="kw">extract</span>(NPP_MEAN_MAX,Vector_points,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-97"><a href="annex-troubleshooting.html#cb107-97"></a></span>
<span id="cb107-98"><a href="annex-troubleshooting.html#cb107-98"></a>WARM_UP&lt;-Vector</span>
<span id="cb107-99"><a href="annex-troubleshooting.html#cb107-99"></a></span>
<span id="cb107-100"><a href="annex-troubleshooting.html#cb107-100"></a><span class="co">#use only for backup</span></span>
<span id="cb107-101"><a href="annex-troubleshooting.html#cb107-101"></a></span>
<span id="cb107-102"><a href="annex-troubleshooting.html#cb107-102"></a><span class="co">#WARM_UP&lt;-readOGR(&quot;WARM_UP_County_AOI3_97.shp&quot;)</span></span>
<span id="cb107-103"><a href="annex-troubleshooting.html#cb107-103"></a></span>
<span id="cb107-104"><a href="annex-troubleshooting.html#cb107-104"></a><span class="co"># Warm Up number of years simulation </span></span>
<span id="cb107-105"><a href="annex-troubleshooting.html#cb107-105"></a></span>
<span id="cb107-106"><a href="annex-troubleshooting.html#cb107-106"></a>yearsSimulation&lt;-<span class="kw">dim</span>(TEMP)[<span class="dv">3</span>]<span class="op">/</span><span class="dv">12</span></span>
<span id="cb107-107"><a href="annex-troubleshooting.html#cb107-107"></a></span>
<span id="cb107-108"><a href="annex-troubleshooting.html#cb107-108"></a>clim_layers&lt;-yearsSimulation<span class="op">*</span><span class="dv">12</span></span>
<span id="cb107-109"><a href="annex-troubleshooting.html#cb107-109"></a></span>
<span id="cb107-110"><a href="annex-troubleshooting.html#cb107-110"></a>nppBand&lt;-<span class="kw">nlayers</span>(Stack_Set_warmup)<span class="op">+</span>clim_layers<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span></span>
<span id="cb107-111"><a href="annex-troubleshooting.html#cb107-111"></a></span>
<span id="cb107-112"><a href="annex-troubleshooting.html#cb107-112"></a>firstClimLayer&lt;-<span class="kw">nlayers</span>(Stack_Set_warmup)<span class="op">+</span><span class="dv">2</span></span>
<span id="cb107-113"><a href="annex-troubleshooting.html#cb107-113"></a></span>
<span id="cb107-114"><a href="annex-troubleshooting.html#cb107-114"></a>nppBand_min&lt;-nppBand<span class="op">+</span><span class="dv">1</span></span>
<span id="cb107-115"><a href="annex-troubleshooting.html#cb107-115"></a></span>
<span id="cb107-116"><a href="annex-troubleshooting.html#cb107-116"></a>nppBand_max&lt;-nppBand<span class="op">+</span><span class="dv">2</span></span>
<span id="cb107-117"><a href="annex-troubleshooting.html#cb107-117"></a></span>
<span id="cb107-118"><a href="annex-troubleshooting.html#cb107-118"></a>nDR_beg&lt;-(<span class="dv">16</span><span class="op">+</span>yearsSimulation)</span>
<span id="cb107-119"><a href="annex-troubleshooting.html#cb107-119"></a>nDR_end&lt;-nDR_beg<span class="op">+</span>(yearsSimulation<span class="dv">-1</span>)</span>
<span id="cb107-120"><a href="annex-troubleshooting.html#cb107-120"></a></span>
<span id="cb107-121"><a href="annex-troubleshooting.html#cb107-121"></a><span class="co"># Extract the layers from the Vector</span></span>
<span id="cb107-122"><a href="annex-troubleshooting.html#cb107-122"></a></span>
<span id="cb107-123"><a href="annex-troubleshooting.html#cb107-123"></a>SOC_im&lt;-Vector_points[[<span class="dv">2</span>]] </span>
<span id="cb107-124"><a href="annex-troubleshooting.html#cb107-124"></a></span>
<span id="cb107-125"><a href="annex-troubleshooting.html#cb107-125"></a>clay_im&lt;-Vector_points[[<span class="dv">3</span>]] </span>
<span id="cb107-126"><a href="annex-troubleshooting.html#cb107-126"></a></span>
<span id="cb107-127"><a href="annex-troubleshooting.html#cb107-127"></a>LU_im&lt;-Vector_points[[<span class="dv">16</span>]]</span>
<span id="cb107-128"><a href="annex-troubleshooting.html#cb107-128"></a></span>
<span id="cb107-129"><a href="annex-troubleshooting.html#cb107-129"></a>NPP_im&lt;-Vector_points[[nppBand]]</span>
<span id="cb107-130"><a href="annex-troubleshooting.html#cb107-130"></a></span>
<span id="cb107-131"><a href="annex-troubleshooting.html#cb107-131"></a>NPP_im_MIN&lt;-Vector_points[[nppBand_min]]</span>
<span id="cb107-132"><a href="annex-troubleshooting.html#cb107-132"></a></span>
<span id="cb107-133"><a href="annex-troubleshooting.html#cb107-133"></a>NPP_im_MAX&lt;-Vector_points[[nppBand_max]]</span>
<span id="cb107-134"><a href="annex-troubleshooting.html#cb107-134"></a></span>
<span id="cb107-135"><a href="annex-troubleshooting.html#cb107-135"></a><span class="co"># Define Years</span></span>
<span id="cb107-136"><a href="annex-troubleshooting.html#cb107-136"></a></span>
<span id="cb107-137"><a href="annex-troubleshooting.html#cb107-137"></a>years=<span class="kw">seq</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">12</span>,<span class="dv">1</span>,<span class="dt">by=</span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>)</span>
<span id="cb107-138"><a href="annex-troubleshooting.html#cb107-138"></a></span>
<span id="cb107-139"><a href="annex-troubleshooting.html#cb107-139"></a></span>
<span id="cb107-140"><a href="annex-troubleshooting.html#cb107-140"></a><span class="co"># ROTH C MODEL FUNCTION . </span></span>
<span id="cb107-141"><a href="annex-troubleshooting.html#cb107-141"></a></span>
<span id="cb107-142"><a href="annex-troubleshooting.html#cb107-142"></a><span class="co">###########function set up starts################</span></span>
<span id="cb107-143"><a href="annex-troubleshooting.html#cb107-143"></a>Roth_C&lt;-<span class="cf">function</span>(Cinputs,years,DPMptf, RPMptf, BIOptf, HUMptf, FallIOM,Temp,Precip,Evp,Cov,Cov1,Cov2,soil.thick,SOC,clay,DR,bare1,LU)</span>
<span id="cb107-144"><a href="annex-troubleshooting.html#cb107-144"></a></span>
<span id="cb107-145"><a href="annex-troubleshooting.html#cb107-145"></a>{</span>
<span id="cb107-146"><a href="annex-troubleshooting.html#cb107-146"></a></span>
<span id="cb107-147"><a href="annex-troubleshooting.html#cb107-147"></a><span class="co"># Paddy fields coefficent fPR = 0.4 if the target point is class = 13 , else fPR=1</span></span>
<span id="cb107-148"><a href="annex-troubleshooting.html#cb107-148"></a><span class="co"># From Shirato and Yukozawa 2004</span></span>
<span id="cb107-149"><a href="annex-troubleshooting.html#cb107-149"></a></span>
<span id="cb107-150"><a href="annex-troubleshooting.html#cb107-150"></a>fPR=(LU <span class="op">==</span><span class="st"> </span><span class="dv">13</span>)<span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span><span class="st"> </span>(LU<span class="op">!=</span><span class="dv">13</span>)<span class="op">*</span><span class="dv">1</span></span>
<span id="cb107-151"><a href="annex-troubleshooting.html#cb107-151"></a></span>
<span id="cb107-152"><a href="annex-troubleshooting.html#cb107-152"></a><span class="co">#Temperature effects per month</span></span>
<span id="cb107-153"><a href="annex-troubleshooting.html#cb107-153"></a>fT=<span class="kw">fT.RothC</span>(Temp[,<span class="dv">2</span>]) </span>
<span id="cb107-154"><a href="annex-troubleshooting.html#cb107-154"></a></span>
<span id="cb107-155"><a href="annex-troubleshooting.html#cb107-155"></a><span class="co">#Moisture effects per month . Si se usa evapotranspiracion pE=1</span></span>
<span id="cb107-156"><a href="annex-troubleshooting.html#cb107-156"></a></span>
<span id="cb107-157"><a href="annex-troubleshooting.html#cb107-157"></a>fw1func&lt;-<span class="cf">function</span>(P, E, <span class="dt">S.Thick =</span> <span class="dv">30</span>, <span class="dt">pClay =</span> <span class="fl">32.0213</span>, <span class="dt">pE =</span> <span class="dv">1</span>, bare) </span>
<span id="cb107-158"><a href="annex-troubleshooting.html#cb107-158"></a>{</span>
<span id="cb107-159"><a href="annex-troubleshooting.html#cb107-159"></a>   </span>
<span id="cb107-160"><a href="annex-troubleshooting.html#cb107-160"></a>    M =<span class="st"> </span>P <span class="op">-</span><span class="st"> </span>E <span class="op">*</span><span class="st"> </span>pE</span>
<span id="cb107-161"><a href="annex-troubleshooting.html#cb107-161"></a>    Acc.TSMD =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb107-162"><a href="annex-troubleshooting.html#cb107-162"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(M)) {</span>
<span id="cb107-163"><a href="annex-troubleshooting.html#cb107-163"></a> 	B =<span class="st"> </span><span class="kw">ifelse</span>(bare[i] <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>, <span class="dv">1</span>, <span class="fl">1.8</span>)</span>
<span id="cb107-164"><a href="annex-troubleshooting.html#cb107-164"></a>	 Max.TSMD =<span class="st"> </span><span class="op">-</span>(<span class="dv">20</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.3</span> <span class="op">*</span><span class="st"> </span>pClay <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">*</span><span class="st"> </span>(pClay<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(S.Thick<span class="op">/</span><span class="dv">23</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>B)</span>
<span id="cb107-165"><a href="annex-troubleshooting.html#cb107-165"></a>        Acc.TSMD[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">ifelse</span>(M[<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, M[<span class="dv">1</span>])</span>
<span id="cb107-166"><a href="annex-troubleshooting.html#cb107-166"></a>        <span class="cf">if</span> (Acc.TSMD[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[i] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb107-167"><a href="annex-troubleshooting.html#cb107-167"></a>            Acc.TSMD[i] =<span class="st"> </span>Acc.TSMD[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[i]</span>
<span id="cb107-168"><a href="annex-troubleshooting.html#cb107-168"></a>        }</span>
<span id="cb107-169"><a href="annex-troubleshooting.html#cb107-169"></a>        <span class="cf">else</span> (Acc.TSMD[i] =<span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb107-170"><a href="annex-troubleshooting.html#cb107-170"></a>        <span class="cf">if</span> (Acc.TSMD[i] <span class="op">&lt;=</span><span class="st"> </span>Max.TSMD) {</span>
<span id="cb107-171"><a href="annex-troubleshooting.html#cb107-171"></a>            Acc.TSMD[i] =<span class="st"> </span>Max.TSMD</span>
<span id="cb107-172"><a href="annex-troubleshooting.html#cb107-172"></a>        }</span>
<span id="cb107-173"><a href="annex-troubleshooting.html#cb107-173"></a>    }</span>
<span id="cb107-174"><a href="annex-troubleshooting.html#cb107-174"></a>    b =<span class="st"> </span><span class="kw">ifelse</span>(Acc.TSMD <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.444</span> <span class="op">*</span><span class="st"> </span>Max.TSMD, <span class="dv">1</span>, (<span class="fl">0.2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span>((Max.TSMD <span class="op">-</span><span class="st"> </span></span>
<span id="cb107-175"><a href="annex-troubleshooting.html#cb107-175"></a><span class="st">        </span>Acc.TSMD)<span class="op">/</span>(Max.TSMD <span class="op">-</span><span class="st"> </span><span class="fl">0.444</span> <span class="op">*</span><span class="st"> </span>Max.TSMD))))</span>
<span id="cb107-176"><a href="annex-troubleshooting.html#cb107-176"></a>	b&lt;-<span class="kw">clamp</span>(b,<span class="dt">lower=</span><span class="fl">0.2</span>)</span>
<span id="cb107-177"><a href="annex-troubleshooting.html#cb107-177"></a>    <span class="kw">return</span>(<span class="kw">data.frame</span>(b))</span>
<span id="cb107-178"><a href="annex-troubleshooting.html#cb107-178"></a>}</span>
<span id="cb107-179"><a href="annex-troubleshooting.html#cb107-179"></a></span>
<span id="cb107-180"><a href="annex-troubleshooting.html#cb107-180"></a></span>
<span id="cb107-181"><a href="annex-troubleshooting.html#cb107-181"></a>fW_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">fw1func</span>(<span class="dt">P=</span>(Precip[,<span class="dv">2</span>]), <span class="dt">E=</span>(Evp[,<span class="dv">2</span>]), <span class="dt">S.Thick =</span> soil.thick, <span class="dt">pClay =</span> clay, <span class="dt">pE =</span> <span class="dv">1</span>, <span class="dt">bare=</span>bare1)<span class="op">$</span>b </span>
<span id="cb107-182"><a href="annex-troubleshooting.html#cb107-182"></a></span>
<span id="cb107-183"><a href="annex-troubleshooting.html#cb107-183"></a><span class="co">#Vegetation Cover effects  C1: No till Agriculture, C2: Conventional Agriculture, C3: Grasslands and Forests, C4 bareland and Urban</span></span>
<span id="cb107-184"><a href="annex-troubleshooting.html#cb107-184"></a></span>
<span id="cb107-185"><a href="annex-troubleshooting.html#cb107-185"></a>fC&lt;-Cov2[,<span class="dv">2</span>]</span>
<span id="cb107-186"><a href="annex-troubleshooting.html#cb107-186"></a></span>
<span id="cb107-187"><a href="annex-troubleshooting.html#cb107-187"></a><span class="co"># Set the factors frame for Model calculations</span></span>
<span id="cb107-188"><a href="annex-troubleshooting.html#cb107-188"></a></span>
<span id="cb107-189"><a href="annex-troubleshooting.html#cb107-189"></a>xi.frame=<span class="kw">data.frame</span>(years,<span class="kw">rep</span>(fT<span class="op">*</span>fW_<span class="dv">2</span><span class="op">*</span>fC<span class="op">*</span>fPR,<span class="dt">length.out=</span><span class="kw">length</span>(years)))</span>
<span id="cb107-190"><a href="annex-troubleshooting.html#cb107-190"></a></span>
<span id="cb107-191"><a href="annex-troubleshooting.html#cb107-191"></a><span class="co"># RUN THE MODEL from SoilR</span></span>
<span id="cb107-192"><a href="annex-troubleshooting.html#cb107-192"></a><span class="co">#Loads the model Si pass=TRUE genera calcula el modelo aunque sea invalido. </span></span>
<span id="cb107-193"><a href="annex-troubleshooting.html#cb107-193"></a><span class="co">#Model3_spin=RothCModel(t=years,C0=c(DPMptf, RPMptf, BIOptf, HUMptf, FallIOM),In=Cinputs,DR=DR,clay=clay,xi=xi.frame, pass=TRUE) </span></span>
<span id="cb107-194"><a href="annex-troubleshooting.html#cb107-194"></a><span class="co">#Calculates stocks for each pool per month</span></span>
<span id="cb107-195"><a href="annex-troubleshooting.html#cb107-195"></a><span class="co">#Ct3_spin=getC(Model3_spin)</span></span>
<span id="cb107-196"><a href="annex-troubleshooting.html#cb107-196"></a></span>
<span id="cb107-197"><a href="annex-troubleshooting.html#cb107-197"></a><span class="co"># RUN THE MODEL from soilassesment</span></span>
<span id="cb107-198"><a href="annex-troubleshooting.html#cb107-198"></a></span>
<span id="cb107-199"><a href="annex-troubleshooting.html#cb107-199"></a>Model3_spin=<span class="kw">carbonTurnover</span>(<span class="dt">tt=</span>years,<span class="dt">C0=</span><span class="kw">c</span>(DPMptf, RPMptf, BIOptf, HUMptf, FallIOM),<span class="dt">In=</span>Cinputs,<span class="dt">Dr=</span>DR,<span class="dt">clay=</span>clay,<span class="dt">effcts=</span>xi.frame, <span class="st">&quot;euler&quot;</span>) </span>
<span id="cb107-200"><a href="annex-troubleshooting.html#cb107-200"></a></span>
<span id="cb107-201"><a href="annex-troubleshooting.html#cb107-201"></a>Ct3_spin=Model3_spin[,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb107-202"><a href="annex-troubleshooting.html#cb107-202"></a></span>
<span id="cb107-203"><a href="annex-troubleshooting.html#cb107-203"></a><span class="co"># Get the final pools of the time series</span></span>
<span id="cb107-204"><a href="annex-troubleshooting.html#cb107-204"></a></span>
<span id="cb107-205"><a href="annex-troubleshooting.html#cb107-205"></a>poolSize3_spin=<span class="kw">as.numeric</span>(<span class="kw">tail</span>(Ct3_spin,<span class="dv">1</span>))</span>
<span id="cb107-206"><a href="annex-troubleshooting.html#cb107-206"></a></span>
<span id="cb107-207"><a href="annex-troubleshooting.html#cb107-207"></a><span class="kw">return</span>(poolSize3_spin)</span>
<span id="cb107-208"><a href="annex-troubleshooting.html#cb107-208"></a></span>
<span id="cb107-209"><a href="annex-troubleshooting.html#cb107-209"></a>}</span>
<span id="cb107-210"><a href="annex-troubleshooting.html#cb107-210"></a><span class="co">##############funtion set up ends##########</span></span>
<span id="cb107-211"><a href="annex-troubleshooting.html#cb107-211"></a></span>
<span id="cb107-212"><a href="annex-troubleshooting.html#cb107-212"></a><span class="co"># Iterates over the area of interest and over 18 years </span></span>
<span id="cb107-213"><a href="annex-troubleshooting.html#cb107-213"></a></span>
<span id="cb107-214"><a href="annex-troubleshooting.html#cb107-214"></a>Cinputs&lt;-<span class="kw">c</span>()</span>
<span id="cb107-215"><a href="annex-troubleshooting.html#cb107-215"></a>Cinputs_min&lt;-<span class="kw">c</span>()</span>
<span id="cb107-216"><a href="annex-troubleshooting.html#cb107-216"></a>Cinputs_max&lt;-<span class="kw">c</span>()</span>
<span id="cb107-217"><a href="annex-troubleshooting.html#cb107-217"></a>NPP_M_MIN&lt;-<span class="kw">c</span>()</span>
<span id="cb107-218"><a href="annex-troubleshooting.html#cb107-218"></a>NPP_M_MAX&lt;-<span class="kw">c</span>()</span>
<span id="cb107-219"><a href="annex-troubleshooting.html#cb107-219"></a>NPP_M&lt;-<span class="kw">c</span>()</span>
<span id="cb107-220"><a href="annex-troubleshooting.html#cb107-220"></a></span>
<span id="cb107-221"><a href="annex-troubleshooting.html#cb107-221"></a><span class="co">############for loop starts################</span></span>
<span id="cb107-222"><a href="annex-troubleshooting.html#cb107-222"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(Vector_points))) {</span>
<span id="cb107-223"><a href="annex-troubleshooting.html#cb107-223"></a></span>
<span id="cb107-224"><a href="annex-troubleshooting.html#cb107-224"></a>gt&lt;-firstClimLayer</span>
<span id="cb107-225"><a href="annex-troubleshooting.html#cb107-225"></a>gp&lt;-gt<span class="op">+</span>clim_layers</span>
<span id="cb107-226"><a href="annex-troubleshooting.html#cb107-226"></a>gevp&lt;-gp<span class="op">+</span>clim_layers</span>
<span id="cb107-227"><a href="annex-troubleshooting.html#cb107-227"></a></span>
<span id="cb107-228"><a href="annex-troubleshooting.html#cb107-228"></a><span class="cf">for</span> (w <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">dim</span>(TEMP)[<span class="dv">3</span>]<span class="op">/</span><span class="dv">12</span>)) {</span>
<span id="cb107-229"><a href="annex-troubleshooting.html#cb107-229"></a></span>
<span id="cb107-230"><a href="annex-troubleshooting.html#cb107-230"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="st">&quot;year:&quot;</span>,w))</span>
<span id="cb107-231"><a href="annex-troubleshooting.html#cb107-231"></a><span class="co"># Extract the variables </span></span>
<span id="cb107-232"><a href="annex-troubleshooting.html#cb107-232"></a></span>
<span id="cb107-233"><a href="annex-troubleshooting.html#cb107-233"></a>Vect&lt;-<span class="kw">as.data.frame</span>(Vector_points[i,])</span>
<span id="cb107-234"><a href="annex-troubleshooting.html#cb107-234"></a></span>
<span id="cb107-235"><a href="annex-troubleshooting.html#cb107-235"></a>Temp&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[gt<span class="op">:</span>(gt<span class="op">+</span><span class="dv">11</span>)]))</span>
<span id="cb107-236"><a href="annex-troubleshooting.html#cb107-236"></a>Temp&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Temp=</span>Temp[,<span class="dv">1</span>])</span>
<span id="cb107-237"><a href="annex-troubleshooting.html#cb107-237"></a></span>
<span id="cb107-238"><a href="annex-troubleshooting.html#cb107-238"></a>Precip&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[gp<span class="op">:</span>(gp<span class="op">+</span><span class="dv">11</span>)]))</span>
<span id="cb107-239"><a href="annex-troubleshooting.html#cb107-239"></a>Precip&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Precip=</span>Precip[,<span class="dv">1</span>])</span>
<span id="cb107-240"><a href="annex-troubleshooting.html#cb107-240"></a></span>
<span id="cb107-241"><a href="annex-troubleshooting.html#cb107-241"></a>Evp&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[gevp<span class="op">:</span>(gevp<span class="op">+</span><span class="dv">11</span>)]))</span>
<span id="cb107-242"><a href="annex-troubleshooting.html#cb107-242"></a>Evp&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Evp=</span>Evp[,<span class="dv">1</span>])</span>
<span id="cb107-243"><a href="annex-troubleshooting.html#cb107-243"></a>	</span>
<span id="cb107-244"><a href="annex-troubleshooting.html#cb107-244"></a>Cov&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">4</span><span class="op">:</span><span class="dv">15</span>]))</span>
<span id="cb107-245"><a href="annex-troubleshooting.html#cb107-245"></a>Cov1&lt;-<span class="kw">data.frame</span>(<span class="dt">Cov=</span>Cov[,<span class="dv">1</span>])</span>
<span id="cb107-246"><a href="annex-troubleshooting.html#cb107-246"></a>Cov2&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Cov=</span>Cov[,<span class="dv">1</span>])</span>
<span id="cb107-247"><a href="annex-troubleshooting.html#cb107-247"></a></span>
<span id="cb107-248"><a href="annex-troubleshooting.html#cb107-248"></a>DR_im&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[nDR_beg<span class="op">:</span>nDR_end])) <span class="co"># DR one per year according to LU</span></span>
<span id="cb107-249"><a href="annex-troubleshooting.html#cb107-249"></a>DR_im&lt;-<span class="kw">data.frame</span>(<span class="dt">DR_im=</span>DR_im[,<span class="dv">1</span>])</span>
<span id="cb107-250"><a href="annex-troubleshooting.html#cb107-250"></a></span>
<span id="cb107-251"><a href="annex-troubleshooting.html#cb107-251"></a>gt&lt;-gt<span class="op">+</span><span class="dv">12</span></span>
<span id="cb107-252"><a href="annex-troubleshooting.html#cb107-252"></a>gp&lt;-gp<span class="op">+</span><span class="dv">12</span></span>
<span id="cb107-253"><a href="annex-troubleshooting.html#cb107-253"></a>gevp&lt;-gevp<span class="op">+</span><span class="dv">12</span></span>
<span id="cb107-254"><a href="annex-troubleshooting.html#cb107-254"></a></span>
<span id="cb107-255"><a href="annex-troubleshooting.html#cb107-255"></a><span class="co">#Avoid calculus over Na values </span></span>
<span id="cb107-256"><a href="annex-troubleshooting.html#cb107-256"></a></span>
<span id="cb107-257"><a href="annex-troubleshooting.html#cb107-257"></a><span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.na</span>(Evp[,<span class="dv">2</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Temp[,<span class="dv">2</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(SOC_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(clay_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Spin_up[i,<span class="dv">3</span>]))  <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(NPP_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Precip[,<span class="dv">2</span>]))  <span class="op">|</span><span class="st">  </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cov2[,<span class="dv">2</span>]))  <span class="op">|</span><span class="st">  </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cov1[,<span class="dv">1</span>]))  <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(DR_im[,<span class="dv">1</span>]))    <span class="op">|</span><span class="st">  </span>(SOC_im[i]<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">|</span><span class="st"> </span>(clay_im[i]<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">|</span><span class="st"> </span>(Spin_up[i,<span class="dv">3</span>]<span class="op">&lt;=</span><span class="dv">0</span>) ) {WARM_UP[i,<span class="dv">2</span>]&lt;-<span class="dv">0</span>}<span class="cf">else</span>{</span>
<span id="cb107-258"><a href="annex-troubleshooting.html#cb107-258"></a></span>
<span id="cb107-259"><a href="annex-troubleshooting.html#cb107-259"></a><span class="co"># Get the variables from the vector</span></span>
<span id="cb107-260"><a href="annex-troubleshooting.html#cb107-260"></a></span>
<span id="cb107-261"><a href="annex-troubleshooting.html#cb107-261"></a>soil.thick=<span class="dv">30</span>  <span class="co">#Soil thickness (organic layer topsoil), in cm</span></span>
<span id="cb107-262"><a href="annex-troubleshooting.html#cb107-262"></a>SOC&lt;-SOC_im[i]      <span class="co">#Soil organic carbon in Mg/ha </span></span>
<span id="cb107-263"><a href="annex-troubleshooting.html#cb107-263"></a>clay&lt;-clay_im[i]        <span class="co">#Percent clay %</span></span>
<span id="cb107-264"><a href="annex-troubleshooting.html#cb107-264"></a></span>
<span id="cb107-265"><a href="annex-troubleshooting.html#cb107-265"></a>DR&lt;-DR_im[w,<span class="dv">1</span>]              <span class="co"># DPM/RPM (decomplosable vs resistant plant material.)</span></span>
<span id="cb107-266"><a href="annex-troubleshooting.html#cb107-266"></a>bare1&lt;-(Cov1<span class="op">&gt;</span><span class="fl">0.8</span>)           <span class="co"># If the surface is bare or vegetated</span></span>
<span id="cb107-267"><a href="annex-troubleshooting.html#cb107-267"></a>NPP_<span class="dv">81</span>_<span class="dv">00</span>&lt;-NPP_im[i]</span>
<span id="cb107-268"><a href="annex-troubleshooting.html#cb107-268"></a>NPP_<span class="dv">81</span>_<span class="dv">00</span>_MIN&lt;-NPP_im_MIN[i]</span>
<span id="cb107-269"><a href="annex-troubleshooting.html#cb107-269"></a>NPP_<span class="dv">81</span>_<span class="dv">00</span>_MAX&lt;-NPP_im_MAX[i]</span>
<span id="cb107-270"><a href="annex-troubleshooting.html#cb107-270"></a></span>
<span id="cb107-271"><a href="annex-troubleshooting.html#cb107-271"></a><span class="co"># PHASE 2  : WARM UP .  years (w)</span></span>
<span id="cb107-272"><a href="annex-troubleshooting.html#cb107-272"></a></span>
<span id="cb107-273"><a href="annex-troubleshooting.html#cb107-273"></a><span class="co"># Cinputs </span></span>
<span id="cb107-274"><a href="annex-troubleshooting.html#cb107-274"></a>T&lt;-<span class="kw">mean</span>(Temp[,<span class="dv">2</span>])</span>
<span id="cb107-275"><a href="annex-troubleshooting.html#cb107-275"></a>P&lt;-<span class="kw">sum</span>(Precip[,<span class="dv">2</span>])</span>
<span id="cb107-276"><a href="annex-troubleshooting.html#cb107-276"></a>NPP_M[w]&lt;-<span class="kw">NPPmodel</span>(P,T,<span class="st">&quot;miami&quot;</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb107-277"><a href="annex-troubleshooting.html#cb107-277"></a>NPP_M[w]&lt;-(LU_im[i]<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">13</span>)<span class="op">*</span>NPP_M[w]<span class="op">*</span><span class="fl">0.53</span><span class="op">+</span><span class="st"> </span>(LU_im[i]<span class="op">==</span><span class="dv">4</span>)<span class="op">*</span>NPP_M[w]<span class="op">*</span><span class="fl">0.88</span> <span class="op">+</span><span class="st"> </span>(LU_im[i]<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">8</span>)<span class="op">*</span>NPP_M[w]<span class="op">*</span><span class="fl">0.72</span></span>
<span id="cb107-278"><a href="annex-troubleshooting.html#cb107-278"></a></span>
<span id="cb107-279"><a href="annex-troubleshooting.html#cb107-279"></a><span class="cf">if</span> (w<span class="op">==</span><span class="dv">1</span>) {Cinputs[w]&lt;-(Spin_up[i,<span class="dv">3</span>]<span class="op">/</span>NPP_<span class="dv">81</span>_<span class="dv">00</span>)<span class="op">*</span>NPP_M[w]} <span class="cf">else</span> {Cinputs[w]&lt;-(Cinputs[[w<span class="dv">-1</span>]]<span class="op">/</span><span class="st"> </span>NPP_M[w<span class="dv">-1</span>]) <span class="op">*</span><span class="st"> </span>NPP_M[w]} </span>
<span id="cb107-280"><a href="annex-troubleshooting.html#cb107-280"></a></span>
<span id="cb107-281"><a href="annex-troubleshooting.html#cb107-281"></a><span class="co"># Cinputs MIN</span></span>
<span id="cb107-282"><a href="annex-troubleshooting.html#cb107-282"></a></span>
<span id="cb107-283"><a href="annex-troubleshooting.html#cb107-283"></a>Tmin&lt;-<span class="kw">mean</span>(Temp[,<span class="dv">2</span>]<span class="op">*</span><span class="fl">1.02</span>)</span>
<span id="cb107-284"><a href="annex-troubleshooting.html#cb107-284"></a>Pmin&lt;-<span class="kw">sum</span>(Precip[,<span class="dv">2</span>]<span class="op">*</span><span class="fl">0.95</span>)</span>
<span id="cb107-285"><a href="annex-troubleshooting.html#cb107-285"></a>NPP_M_MIN[w]&lt;-<span class="kw">NPPmodel</span>(Pmin,Tmin,<span class="st">&quot;miami&quot;</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb107-286"><a href="annex-troubleshooting.html#cb107-286"></a>NPP_M_MIN[w]&lt;-(LU_im[i]<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">13</span>)<span class="op">*</span>NPP_M_MIN[w]<span class="op">*</span><span class="fl">0.53</span><span class="op">+</span><span class="st"> </span>(LU_im[i]<span class="op">==</span><span class="dv">4</span>)<span class="op">*</span>NPP_M_MIN[w]<span class="op">*</span><span class="fl">0.88</span> <span class="op">+</span><span class="st"> </span>(LU_im[i]<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">8</span>)<span class="op">*</span>NPP_M_MIN[w]<span class="op">*</span><span class="fl">0.72</span></span>
<span id="cb107-287"><a href="annex-troubleshooting.html#cb107-287"></a></span>
<span id="cb107-288"><a href="annex-troubleshooting.html#cb107-288"></a><span class="cf">if</span> (w<span class="op">==</span><span class="dv">1</span>) {Cinputs_min[w]&lt;-(Spin_up[i,<span class="dv">10</span>]<span class="op">/</span>NPP_<span class="dv">81</span>_<span class="dv">00</span>)<span class="op">*</span>NPP_M_MIN[w]} <span class="cf">else</span> {Cinputs_min[w]&lt;-(Cinputs_min[[w<span class="dv">-1</span>]]<span class="op">/</span><span class="st"> </span>NPP_M_MIN[w<span class="dv">-1</span>]) <span class="op">*</span><span class="st"> </span>NPP_M_MIN[w]} </span>
<span id="cb107-289"><a href="annex-troubleshooting.html#cb107-289"></a></span>
<span id="cb107-290"><a href="annex-troubleshooting.html#cb107-290"></a><span class="co"># Cinputs MAX</span></span>
<span id="cb107-291"><a href="annex-troubleshooting.html#cb107-291"></a></span>
<span id="cb107-292"><a href="annex-troubleshooting.html#cb107-292"></a>Tmax&lt;-<span class="kw">mean</span>(Temp[,<span class="dv">2</span>]<span class="op">*</span><span class="fl">0.98</span>)</span>
<span id="cb107-293"><a href="annex-troubleshooting.html#cb107-293"></a>Pmax&lt;-<span class="kw">sum</span>(Precip[,<span class="dv">2</span>]<span class="op">*</span><span class="fl">1.05</span>)</span>
<span id="cb107-294"><a href="annex-troubleshooting.html#cb107-294"></a>NPP_M_MAX[w]&lt;-<span class="kw">NPPmodel</span>(Pmax,Tmax,<span class="st">&quot;miami&quot;</span>)<span class="op">*</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">100</span>)<span class="op">*</span><span class="fl">0.5</span></span>
<span id="cb107-295"><a href="annex-troubleshooting.html#cb107-295"></a>NPP_M_MAX[w]&lt;-(LU_im[i]<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">12</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">13</span>)<span class="op">*</span>NPP_M_MAX[w]<span class="op">*</span><span class="fl">0.53</span><span class="op">+</span><span class="st"> </span>(LU_im[i]<span class="op">==</span><span class="dv">4</span>)<span class="op">*</span>NPP_M_MAX[w]<span class="op">*</span><span class="fl">0.88</span> <span class="op">+</span><span class="st"> </span>(LU_im[i]<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU_im[i]<span class="op">==</span><span class="dv">8</span>)<span class="op">*</span>NPP_M_MAX[w]<span class="op">*</span><span class="fl">0.72</span></span>
<span id="cb107-296"><a href="annex-troubleshooting.html#cb107-296"></a></span>
<span id="cb107-297"><a href="annex-troubleshooting.html#cb107-297"></a><span class="cf">if</span> (w<span class="op">==</span><span class="dv">1</span>) {Cinputs_max[w]&lt;-(Spin_up[i,<span class="dv">11</span>]<span class="op">/</span>NPP_<span class="dv">81</span>_<span class="dv">00</span>)<span class="op">*</span>NPP_M_MAX[w]} <span class="cf">else</span> {Cinputs_max[w]&lt;-(Cinputs_max[[w<span class="dv">-1</span>]]<span class="op">/</span><span class="st"> </span>NPP_M_MAX[w<span class="dv">-1</span>]) <span class="op">*</span><span class="st"> </span>NPP_M_MAX[w]} </span>
<span id="cb107-298"><a href="annex-troubleshooting.html#cb107-298"></a></span>
<span id="cb107-299"><a href="annex-troubleshooting.html#cb107-299"></a><span class="co"># Run the model for 2001-2018 </span></span>
<span id="cb107-300"><a href="annex-troubleshooting.html#cb107-300"></a></span>
<span id="cb107-301"><a href="annex-troubleshooting.html#cb107-301"></a><span class="cf">if</span> (w<span class="op">==</span><span class="dv">1</span>) {</span>
<span id="cb107-302"><a href="annex-troubleshooting.html#cb107-302"></a>f_wp&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs[<span class="dv">1</span>],<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>Spin_up[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>Spin_up[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>Spin_up[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>Spin_up[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>Spin_up[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU_im[i])</span>
<span id="cb107-303"><a href="annex-troubleshooting.html#cb107-303"></a>} <span class="cf">else</span> {</span>
<span id="cb107-304"><a href="annex-troubleshooting.html#cb107-304"></a>f_wp&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs[w],<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>f_wp[<span class="dv">1</span>], <span class="dt">RPMptf=</span>f_wp[<span class="dv">2</span>], <span class="dt">BIOptf=</span>f_wp[<span class="dv">3</span>], <span class="dt">HUMptf=</span>f_wp[<span class="dv">4</span>], <span class="dt">FallIOM=</span>f_wp[<span class="dv">5</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU_im[i])</span>
<span id="cb107-305"><a href="annex-troubleshooting.html#cb107-305"></a>}</span>
<span id="cb107-306"><a href="annex-troubleshooting.html#cb107-306"></a></span>
<span id="cb107-307"><a href="annex-troubleshooting.html#cb107-307"></a>f_wp_t&lt;-f_wp[<span class="dv">1</span>]<span class="op">+</span>f_wp[<span class="dv">2</span>]<span class="op">+</span>f_wp[<span class="dv">3</span>]<span class="op">+</span>f_wp[<span class="dv">4</span>]<span class="op">+</span>f_wp[<span class="dv">5</span>]</span>
<span id="cb107-308"><a href="annex-troubleshooting.html#cb107-308"></a></span>
<span id="cb107-309"><a href="annex-troubleshooting.html#cb107-309"></a><span class="co"># Run the model for minimum values</span></span>
<span id="cb107-310"><a href="annex-troubleshooting.html#cb107-310"></a></span>
<span id="cb107-311"><a href="annex-troubleshooting.html#cb107-311"></a><span class="cf">if</span> (w<span class="op">==</span><span class="dv">1</span>) {</span>
<span id="cb107-312"><a href="annex-troubleshooting.html#cb107-312"></a>f_wp_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs_min[<span class="dv">1</span>],<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>Spin_up[i,<span class="dv">13</span>], <span class="dt">RPMptf=</span>Spin_up[i,<span class="dv">14</span>], <span class="dt">BIOptf=</span>Spin_up[i,<span class="dv">15</span>], <span class="dt">HUMptf=</span>Spin_up[i,<span class="dv">16</span>], <span class="dt">FallIOM=</span>Spin_up[i,<span class="dv">17</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">0.8</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">0.9</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU_im[i])</span>
<span id="cb107-313"><a href="annex-troubleshooting.html#cb107-313"></a>} <span class="cf">else</span> {</span>
<span id="cb107-314"><a href="annex-troubleshooting.html#cb107-314"></a>f_wp_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs_min[w],<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>f_wp_min[<span class="dv">1</span>], <span class="dt">RPMptf=</span>f_wp_min[<span class="dv">2</span>], <span class="dt">BIOptf=</span>f_wp_min[<span class="dv">3</span>], <span class="dt">HUMptf=</span>f_wp_min[<span class="dv">4</span>], <span class="dt">FallIOM=</span>f_wp_min[<span class="dv">5</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">0.8</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">0.9</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU_im[i])</span>
<span id="cb107-315"><a href="annex-troubleshooting.html#cb107-315"></a>}</span>
<span id="cb107-316"><a href="annex-troubleshooting.html#cb107-316"></a></span>
<span id="cb107-317"><a href="annex-troubleshooting.html#cb107-317"></a>f_wp_t_min&lt;-f_wp_min[<span class="dv">1</span>]<span class="op">+</span>f_wp_min[<span class="dv">2</span>]<span class="op">+</span>f_wp_min[<span class="dv">3</span>]<span class="op">+</span>f_wp_min[<span class="dv">4</span>]<span class="op">+</span>f_wp_min[<span class="dv">5</span>]</span>
<span id="cb107-318"><a href="annex-troubleshooting.html#cb107-318"></a></span>
<span id="cb107-319"><a href="annex-troubleshooting.html#cb107-319"></a><span class="co"># Run the model for maximum values</span></span>
<span id="cb107-320"><a href="annex-troubleshooting.html#cb107-320"></a></span>
<span id="cb107-321"><a href="annex-troubleshooting.html#cb107-321"></a><span class="cf">if</span> (w<span class="op">==</span><span class="dv">1</span>) {</span>
<span id="cb107-322"><a href="annex-troubleshooting.html#cb107-322"></a>f_wp_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs_max[<span class="dv">1</span>],<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>Spin_up[i,<span class="dv">19</span>], <span class="dt">RPMptf=</span>Spin_up[i,<span class="dv">20</span>], <span class="dt">BIOptf=</span>Spin_up[i,<span class="dv">21</span>], <span class="dt">HUMptf=</span>Spin_up[i,<span class="dv">22</span>], <span class="dt">FallIOM=</span>Spin_up[i,<span class="dv">23</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">1.2</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">1.1</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU_im[i])</span>
<span id="cb107-323"><a href="annex-troubleshooting.html#cb107-323"></a>} <span class="cf">else</span> {</span>
<span id="cb107-324"><a href="annex-troubleshooting.html#cb107-324"></a>f_wp_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs_max[w],<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>f_wp_max[<span class="dv">1</span>], <span class="dt">RPMptf=</span>f_wp_max[<span class="dv">2</span>], <span class="dt">BIOptf=</span>f_wp_max[<span class="dv">3</span>], <span class="dt">HUMptf=</span>f_wp_max[<span class="dv">4</span>], <span class="dt">FallIOM=</span>f_wp_max[<span class="dv">5</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">1.2</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">1.1</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU_im[i])</span>
<span id="cb107-325"><a href="annex-troubleshooting.html#cb107-325"></a>}</span>
<span id="cb107-326"><a href="annex-troubleshooting.html#cb107-326"></a></span>
<span id="cb107-327"><a href="annex-troubleshooting.html#cb107-327"></a>f_wp_t_max&lt;-f_wp_max[<span class="dv">1</span>]<span class="op">+</span>f_wp_max[<span class="dv">2</span>]<span class="op">+</span>f_wp_max[<span class="dv">3</span>]<span class="op">+</span>f_wp_max[<span class="dv">4</span>]<span class="op">+</span>f_wp_max[<span class="dv">5</span>]</span>
<span id="cb107-328"><a href="annex-troubleshooting.html#cb107-328"></a></span>
<span id="cb107-329"><a href="annex-troubleshooting.html#cb107-329"></a><span class="kw">print</span>(w)</span>
<span id="cb107-330"><a href="annex-troubleshooting.html#cb107-330"></a><span class="co">#print(c(i,SOC,Spin_up[i,3],NPP_81_00,Cinputs[w],f_wp_t))</span></span>
<span id="cb107-331"><a href="annex-troubleshooting.html#cb107-331"></a><span class="kw">print</span>(<span class="kw">c</span>(NPP_M[w],Cinputs[w]))</span>
<span id="cb107-332"><a href="annex-troubleshooting.html#cb107-332"></a>}</span>
<span id="cb107-333"><a href="annex-troubleshooting.html#cb107-333"></a>}</span>
<span id="cb107-334"><a href="annex-troubleshooting.html#cb107-334"></a><span class="cf">if</span> (<span class="kw">is.na</span>(<span class="kw">mean</span>(Cinputs))){ CinputFOWARD&lt;-<span class="ot">NA</span>} <span class="cf">else</span> { </span>
<span id="cb107-335"><a href="annex-troubleshooting.html#cb107-335"></a></span>
<span id="cb107-336"><a href="annex-troubleshooting.html#cb107-336"></a>CinputFOWARD&lt;-<span class="kw">mean</span>(Cinputs)</span>
<span id="cb107-337"><a href="annex-troubleshooting.html#cb107-337"></a></span>
<span id="cb107-338"><a href="annex-troubleshooting.html#cb107-338"></a>CinputFOWARD_min&lt;-<span class="kw">mean</span>(Cinputs_min)</span>
<span id="cb107-339"><a href="annex-troubleshooting.html#cb107-339"></a></span>
<span id="cb107-340"><a href="annex-troubleshooting.html#cb107-340"></a>CinputFOWARD_max&lt;-<span class="kw">mean</span>(Cinputs_max)</span>
<span id="cb107-341"><a href="annex-troubleshooting.html#cb107-341"></a></span>
<span id="cb107-342"><a href="annex-troubleshooting.html#cb107-342"></a>WARM_UP[i,<span class="dv">2</span>]&lt;-SOC</span>
<span id="cb107-343"><a href="annex-troubleshooting.html#cb107-343"></a>WARM_UP[i,<span class="dv">3</span>]&lt;-Cinputs[<span class="dv">18</span>]</span>
<span id="cb107-344"><a href="annex-troubleshooting.html#cb107-344"></a>WARM_UP[i,<span class="dv">4</span>]&lt;-f_wp_t</span>
<span id="cb107-345"><a href="annex-troubleshooting.html#cb107-345"></a>WARM_UP[i,<span class="dv">5</span>]&lt;-f_wp[<span class="dv">1</span>]</span>
<span id="cb107-346"><a href="annex-troubleshooting.html#cb107-346"></a>WARM_UP[i,<span class="dv">6</span>]&lt;-f_wp[<span class="dv">2</span>]</span>
<span id="cb107-347"><a href="annex-troubleshooting.html#cb107-347"></a>WARM_UP[i,<span class="dv">7</span>]&lt;-f_wp[<span class="dv">3</span>]</span>
<span id="cb107-348"><a href="annex-troubleshooting.html#cb107-348"></a>WARM_UP[i,<span class="dv">8</span>]&lt;-f_wp[<span class="dv">4</span>]</span>
<span id="cb107-349"><a href="annex-troubleshooting.html#cb107-349"></a>WARM_UP[i,<span class="dv">9</span>]&lt;-f_wp[<span class="dv">5</span>]</span>
<span id="cb107-350"><a href="annex-troubleshooting.html#cb107-350"></a>WARM_UP[i,<span class="dv">10</span>]&lt;-CinputFOWARD</span>
<span id="cb107-351"><a href="annex-troubleshooting.html#cb107-351"></a>WARM_UP[i,<span class="dv">11</span>]&lt;-f_wp_t_min</span>
<span id="cb107-352"><a href="annex-troubleshooting.html#cb107-352"></a>WARM_UP[i,<span class="dv">12</span>]&lt;-f_wp_min[<span class="dv">1</span>]</span>
<span id="cb107-353"><a href="annex-troubleshooting.html#cb107-353"></a>WARM_UP[i,<span class="dv">13</span>]&lt;-f_wp_min[<span class="dv">2</span>]</span>
<span id="cb107-354"><a href="annex-troubleshooting.html#cb107-354"></a>WARM_UP[i,<span class="dv">14</span>]&lt;-f_wp_min[<span class="dv">3</span>]</span>
<span id="cb107-355"><a href="annex-troubleshooting.html#cb107-355"></a>WARM_UP[i,<span class="dv">15</span>]&lt;-f_wp_min[<span class="dv">4</span>]</span>
<span id="cb107-356"><a href="annex-troubleshooting.html#cb107-356"></a>WARM_UP[i,<span class="dv">16</span>]&lt;-f_wp_min[<span class="dv">5</span>]</span>
<span id="cb107-357"><a href="annex-troubleshooting.html#cb107-357"></a>WARM_UP[i,<span class="dv">17</span>]&lt;-f_wp_t_max</span>
<span id="cb107-358"><a href="annex-troubleshooting.html#cb107-358"></a>WARM_UP[i,<span class="dv">18</span>]&lt;-f_wp_max[<span class="dv">1</span>]</span>
<span id="cb107-359"><a href="annex-troubleshooting.html#cb107-359"></a>WARM_UP[i,<span class="dv">19</span>]&lt;-f_wp_max[<span class="dv">2</span>]</span>
<span id="cb107-360"><a href="annex-troubleshooting.html#cb107-360"></a>WARM_UP[i,<span class="dv">20</span>]&lt;-f_wp_max[<span class="dv">3</span>]</span>
<span id="cb107-361"><a href="annex-troubleshooting.html#cb107-361"></a>WARM_UP[i,<span class="dv">21</span>]&lt;-f_wp_max[<span class="dv">4</span>]</span>
<span id="cb107-362"><a href="annex-troubleshooting.html#cb107-362"></a>WARM_UP[i,<span class="dv">22</span>]&lt;-f_wp_max[<span class="dv">5</span>]</span>
<span id="cb107-363"><a href="annex-troubleshooting.html#cb107-363"></a>WARM_UP[i,<span class="dv">23</span>]&lt;-CinputFOWARD_min</span>
<span id="cb107-364"><a href="annex-troubleshooting.html#cb107-364"></a>WARM_UP[i,<span class="dv">24</span>]&lt;-CinputFOWARD_max</span>
<span id="cb107-365"><a href="annex-troubleshooting.html#cb107-365"></a></span>
<span id="cb107-366"><a href="annex-troubleshooting.html#cb107-366"></a>Cinputs&lt;-<span class="kw">c</span>()</span>
<span id="cb107-367"><a href="annex-troubleshooting.html#cb107-367"></a>Cinputs_min&lt;-<span class="kw">c</span>()</span>
<span id="cb107-368"><a href="annex-troubleshooting.html#cb107-368"></a>Cinputs_max&lt;-<span class="kw">c</span>()</span>
<span id="cb107-369"><a href="annex-troubleshooting.html#cb107-369"></a>}</span>
<span id="cb107-370"><a href="annex-troubleshooting.html#cb107-370"></a><span class="kw">print</span>(i)</span>
<span id="cb107-371"><a href="annex-troubleshooting.html#cb107-371"></a>}</span>
<span id="cb107-372"><a href="annex-troubleshooting.html#cb107-372"></a></span>
<span id="cb107-373"><a href="annex-troubleshooting.html#cb107-373"></a><span class="co">################for loop ends#############</span></span>
<span id="cb107-374"><a href="annex-troubleshooting.html#cb107-374"></a></span>
<span id="cb107-375"><a href="annex-troubleshooting.html#cb107-375"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">2</span>]=<span class="st">&quot;SOC_FAO&quot;</span></span>
<span id="cb107-376"><a href="annex-troubleshooting.html#cb107-376"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">3</span>]=<span class="st">&quot;Cin_t0&quot;</span></span>
<span id="cb107-377"><a href="annex-troubleshooting.html#cb107-377"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">4</span>]=<span class="st">&quot;SOC_t0&quot;</span></span>
<span id="cb107-378"><a href="annex-troubleshooting.html#cb107-378"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">5</span>]=<span class="st">&quot;DPM_w_up&quot;</span></span>
<span id="cb107-379"><a href="annex-troubleshooting.html#cb107-379"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">6</span>]=<span class="st">&quot;RPM_w_up&quot;</span></span>
<span id="cb107-380"><a href="annex-troubleshooting.html#cb107-380"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">7</span>]=<span class="st">&quot;BIO_w_up&quot;</span></span>
<span id="cb107-381"><a href="annex-troubleshooting.html#cb107-381"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">8</span>]=<span class="st">&quot;HUM_w_up&quot;</span></span>
<span id="cb107-382"><a href="annex-troubleshooting.html#cb107-382"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">9</span>]=<span class="st">&quot;IOM_w_up&quot;</span></span>
<span id="cb107-383"><a href="annex-troubleshooting.html#cb107-383"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">10</span>]=<span class="st">&quot;Cin_mean&quot;</span></span>
<span id="cb107-384"><a href="annex-troubleshooting.html#cb107-384"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">11</span>]=<span class="st">&quot;SOC_t0min&quot;</span></span>
<span id="cb107-385"><a href="annex-troubleshooting.html#cb107-385"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">12</span>]=<span class="st">&quot;DPM_w_min&quot;</span></span>
<span id="cb107-386"><a href="annex-troubleshooting.html#cb107-386"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">13</span>]=<span class="st">&quot;RPM_w_min&quot;</span></span>
<span id="cb107-387"><a href="annex-troubleshooting.html#cb107-387"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">14</span>]=<span class="st">&quot;BIO_w_min&quot;</span></span>
<span id="cb107-388"><a href="annex-troubleshooting.html#cb107-388"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">15</span>]=<span class="st">&quot;HUM_w_min&quot;</span></span>
<span id="cb107-389"><a href="annex-troubleshooting.html#cb107-389"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">16</span>]=<span class="st">&quot;IOM_w_min&quot;</span></span>
<span id="cb107-390"><a href="annex-troubleshooting.html#cb107-390"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">17</span>]=<span class="st">&quot;SOC_t0max&quot;</span></span>
<span id="cb107-391"><a href="annex-troubleshooting.html#cb107-391"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">18</span>]=<span class="st">&quot;DPM_w_max&quot;</span></span>
<span id="cb107-392"><a href="annex-troubleshooting.html#cb107-392"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">19</span>]=<span class="st">&quot;RPM_w_max&quot;</span></span>
<span id="cb107-393"><a href="annex-troubleshooting.html#cb107-393"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">20</span>]=<span class="st">&quot;BIO_w_max&quot;</span></span>
<span id="cb107-394"><a href="annex-troubleshooting.html#cb107-394"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">21</span>]=<span class="st">&quot;HUM_w_max&quot;</span></span>
<span id="cb107-395"><a href="annex-troubleshooting.html#cb107-395"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">22</span>]=<span class="st">&quot;IOM_w_max&quot;</span></span>
<span id="cb107-396"><a href="annex-troubleshooting.html#cb107-396"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">23</span>]=<span class="st">&quot;Cin_min&quot;</span></span>
<span id="cb107-397"><a href="annex-troubleshooting.html#cb107-397"></a><span class="kw">colnames</span>(WARM_UP<span class="op">@</span>data)[<span class="dv">24</span>]=<span class="st">&quot;Cin_max&quot;</span></span>
<span id="cb107-398"><a href="annex-troubleshooting.html#cb107-398"></a></span>
<span id="cb107-399"><a href="annex-troubleshooting.html#cb107-399"></a></span>
<span id="cb107-400"><a href="annex-troubleshooting.html#cb107-400"></a><span class="co"># SAVE the Points (shapefile)</span></span>
<span id="cb107-401"><a href="annex-troubleshooting.html#cb107-401"></a><span class="kw">setwd</span>(<span class="st">&quot;C:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020/OUTPUTS/2_WARM_UP&quot;</span>)</span>
<span id="cb107-402"><a href="annex-troubleshooting.html#cb107-402"></a><span class="kw">writeOGR</span>(WARM_UP,<span class="st">&quot;.&quot;</span>, <span class="st">&quot;WARM_UP_County_AOI&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>,<span class="dt">overwrite=</span><span class="ot">TRUE</span>)</span></code></pre></div>
</div>
<div id="step-8-run-the-forward-phase-for-points-outside-the-cru-layer-script-15b" class="section level3">
<h3><span class="header-section-number">15.1.6</span> Step 8 Run the Forward phase for points outside the CRU layer (Script 15B)</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="annex-troubleshooting.html#cb108-1"></a><span class="co">#12/11/2020</span></span>
<span id="cb108-2"><a href="annex-troubleshooting.html#cb108-2"></a></span>
<span id="cb108-3"><a href="annex-troubleshooting.html#cb108-3"></a><span class="co"># SPATIAL SOIL R  for VECTORS</span></span>
<span id="cb108-4"><a href="annex-troubleshooting.html#cb108-4"></a></span>
<span id="cb108-5"><a href="annex-troubleshooting.html#cb108-5"></a><span class="co"># FOWARD SCENARIOS</span></span>
<span id="cb108-6"><a href="annex-troubleshooting.html#cb108-6"></a></span>
<span id="cb108-7"><a href="annex-troubleshooting.html#cb108-7"></a><span class="co"># MSc Ing Agr Luciano E Di Paolo</span></span>
<span id="cb108-8"><a href="annex-troubleshooting.html#cb108-8"></a><span class="co"># Dr Ing Agr Guillermo E Peralta</span></span>
<span id="cb108-9"><a href="annex-troubleshooting.html#cb108-9"></a><span class="co">###################################</span></span>
<span id="cb108-10"><a href="annex-troubleshooting.html#cb108-10"></a><span class="co"># SOilR from Sierra, C.A., M. Mueller, S.E. Trumbore (2012). </span></span>
<span id="cb108-11"><a href="annex-troubleshooting.html#cb108-11"></a><span class="co">#Models of soil organic matter decomposition: the SoilR package, version 1.0 Geoscientific Model Development, 5(4), </span></span>
<span id="cb108-12"><a href="annex-troubleshooting.html#cb108-12"></a><span class="co">#1045--1060. URL http://www.geosci-model-dev.net/5/1045/2012/gmd-5-1045-2012.html.</span></span>
<span id="cb108-13"><a href="annex-troubleshooting.html#cb108-13"></a><span class="co">#####################################</span></span>
<span id="cb108-14"><a href="annex-troubleshooting.html#cb108-14"></a></span>
<span id="cb108-15"><a href="annex-troubleshooting.html#cb108-15"></a><span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>()) </span>
<span id="cb108-16"><a href="annex-troubleshooting.html#cb108-16"></a></span>
<span id="cb108-17"><a href="annex-troubleshooting.html#cb108-17"></a><span class="kw">library</span>(SoilR)</span>
<span id="cb108-18"><a href="annex-troubleshooting.html#cb108-18"></a><span class="kw">library</span>(raster)</span>
<span id="cb108-19"><a href="annex-troubleshooting.html#cb108-19"></a><span class="kw">library</span>(rgdal)</span>
<span id="cb108-20"><a href="annex-troubleshooting.html#cb108-20"></a><span class="kw">library</span>(soilassessment)</span>
<span id="cb108-21"><a href="annex-troubleshooting.html#cb108-21"></a></span>
<span id="cb108-22"><a href="annex-troubleshooting.html#cb108-22"></a>WD_OUT&lt;-(<span class="st">&quot;C:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020/OUTPUTS/3_FOWARD&quot;</span>)</span>
<span id="cb108-23"><a href="annex-troubleshooting.html#cb108-23"></a></span>
<span id="cb108-24"><a href="annex-troubleshooting.html#cb108-24"></a>working_dir&lt;-<span class="kw">setwd</span>(<span class="st">&quot;C:/TRAINING_MATERIALS_GSOCseq_MAPS_12-11-2020&quot;</span>)</span>
<span id="cb108-25"><a href="annex-troubleshooting.html#cb108-25"></a></span>
<span id="cb108-26"><a href="annex-troubleshooting.html#cb108-26"></a><span class="co"># OPEN THE VECTOR OF POINTS</span></span>
<span id="cb108-27"><a href="annex-troubleshooting.html#cb108-27"></a></span>
<span id="cb108-28"><a href="annex-troubleshooting.html#cb108-28"></a>Vector&lt;-<span class="kw">readOGR</span>(<span class="st">&quot;INPUTS/TARGET_POINTS/AOI_Empty_points_borders.shp&quot;</span>)</span>
<span id="cb108-29"><a href="annex-troubleshooting.html#cb108-29"></a></span>
<span id="cb108-30"><a href="annex-troubleshooting.html#cb108-30"></a><span class="co"># OPEN THE RESULT VECTOR FROM THE WARM UP PROCESS</span></span>
<span id="cb108-31"><a href="annex-troubleshooting.html#cb108-31"></a></span>
<span id="cb108-32"><a href="annex-troubleshooting.html#cb108-32"></a>WARM_UP&lt;-<span class="kw">readOGR</span>(<span class="st">&quot;OUTPUTS/2_WARM_UP/WARM_UP_County_AOI.shp&quot;</span>)</span>
<span id="cb108-33"><a href="annex-troubleshooting.html#cb108-33"></a></span>
<span id="cb108-34"><a href="annex-troubleshooting.html#cb108-34"></a><span class="co"># OPEN THE STACK WITH THE VARIABLES FOR THE FOWARD PROCESS</span></span>
<span id="cb108-35"><a href="annex-troubleshooting.html#cb108-35"></a></span>
<span id="cb108-36"><a href="annex-troubleshooting.html#cb108-36"></a>Stack_Set_<span class="dv">1</span>&lt;-<span class="st"> </span><span class="kw">stack</span>(<span class="st">&quot;INPUTS/STACK/Stack_Set_FOWARD.tif&quot;</span>)</span>
<span id="cb108-37"><a href="annex-troubleshooting.html#cb108-37"></a></span>
<span id="cb108-38"><a href="annex-troubleshooting.html#cb108-38"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nlayers</span>(Stack_Set_<span class="dv">1</span>)){</span>
<span id="cb108-39"><a href="annex-troubleshooting.html#cb108-39"></a>  Stack_Set_<span class="dv">1</span>[[i]]&lt;-<span class="kw">focal</span>(Stack_Set_<span class="dv">1</span>[[i]], <span class="dt">w =</span> <span class="kw">matrix</span>(<span class="dv">1</span>,<span class="dv">25</span>,<span class="dv">25</span>), <span class="dt">fun=</span> mean,  <span class="dt">na.rm =</span> <span class="ot">TRUE</span>, <span class="dt">NAonly=</span><span class="ot">TRUE</span> , <span class="dt">pad=</span><span class="ot">TRUE</span>)</span>
<span id="cb108-40"><a href="annex-troubleshooting.html#cb108-40"></a>}</span>
<span id="cb108-41"><a href="annex-troubleshooting.html#cb108-41"></a></span>
<span id="cb108-42"><a href="annex-troubleshooting.html#cb108-42"></a></span>
<span id="cb108-43"><a href="annex-troubleshooting.html#cb108-43"></a><span class="co"># Set the increase in Carbon input for each land use and each scenario</span></span>
<span id="cb108-44"><a href="annex-troubleshooting.html#cb108-44"></a></span>
<span id="cb108-45"><a href="annex-troubleshooting.html#cb108-45"></a><span class="co">#Crops and Crop trees</span></span>
<span id="cb108-46"><a href="annex-troubleshooting.html#cb108-46"></a>Low_Crops&lt;-<span class="fl">1.05</span></span>
<span id="cb108-47"><a href="annex-troubleshooting.html#cb108-47"></a>Med_Crops&lt;-<span class="fl">1.10</span></span>
<span id="cb108-48"><a href="annex-troubleshooting.html#cb108-48"></a>High_Crops&lt;-<span class="fl">1.2</span></span>
<span id="cb108-49"><a href="annex-troubleshooting.html#cb108-49"></a></span>
<span id="cb108-50"><a href="annex-troubleshooting.html#cb108-50"></a><span class="co">#Shrublands, Grasslands , Herbaceous vegetation flooded &amp; Sparse Vegetation</span></span>
<span id="cb108-51"><a href="annex-troubleshooting.html#cb108-51"></a>Low_Grass&lt;-<span class="fl">1.05</span></span>
<span id="cb108-52"><a href="annex-troubleshooting.html#cb108-52"></a>Med_Grass&lt;-<span class="fl">1.10</span></span>
<span id="cb108-53"><a href="annex-troubleshooting.html#cb108-53"></a>High_Grass&lt;-<span class="fl">1.2</span></span>
<span id="cb108-54"><a href="annex-troubleshooting.html#cb108-54"></a></span>
<span id="cb108-55"><a href="annex-troubleshooting.html#cb108-55"></a><span class="co">#Paddy Fields</span></span>
<span id="cb108-56"><a href="annex-troubleshooting.html#cb108-56"></a>Low_PaddyFields&lt;-<span class="fl">1.05</span></span>
<span id="cb108-57"><a href="annex-troubleshooting.html#cb108-57"></a>Med_PaddyFields&lt;-<span class="fl">1.10</span></span>
<span id="cb108-58"><a href="annex-troubleshooting.html#cb108-58"></a>High_PaddyFields&lt;-<span class="fl">1.2</span></span>
<span id="cb108-59"><a href="annex-troubleshooting.html#cb108-59"></a></span>
<span id="cb108-60"><a href="annex-troubleshooting.html#cb108-60"></a><span class="co"># extract variables to points</span></span>
<span id="cb108-61"><a href="annex-troubleshooting.html#cb108-61"></a></span>
<span id="cb108-62"><a href="annex-troubleshooting.html#cb108-62"></a>Variables&lt;-<span class="kw">extract</span>(Stack_Set_<span class="dv">1</span>,Vector,<span class="dt">sp=</span><span class="ot">TRUE</span>)</span>
<span id="cb108-63"><a href="annex-troubleshooting.html#cb108-63"></a></span>
<span id="cb108-64"><a href="annex-troubleshooting.html#cb108-64"></a><span class="co"># Creates an empty vector</span></span>
<span id="cb108-65"><a href="annex-troubleshooting.html#cb108-65"></a></span>
<span id="cb108-66"><a href="annex-troubleshooting.html#cb108-66"></a>FOWARD&lt;-Vector</span>
<span id="cb108-67"><a href="annex-troubleshooting.html#cb108-67"></a></span>
<span id="cb108-68"><a href="annex-troubleshooting.html#cb108-68"></a><span class="co"># use it only for backup</span></span>
<span id="cb108-69"><a href="annex-troubleshooting.html#cb108-69"></a><span class="co">#FOWARD&lt;-readOGR(&quot;OUTPUTS/3_FOWARD/FOWARD_ARGENTINA_BSAS_17-04-2020_352671.shp&quot;)</span></span>
<span id="cb108-70"><a href="annex-troubleshooting.html#cb108-70"></a></span>
<span id="cb108-71"><a href="annex-troubleshooting.html#cb108-71"></a><span class="co"># Extract the layers from the Vector</span></span>
<span id="cb108-72"><a href="annex-troubleshooting.html#cb108-72"></a></span>
<span id="cb108-73"><a href="annex-troubleshooting.html#cb108-73"></a>SOC_im&lt;-WARM_UP[[<span class="dv">4</span>]]</span>
<span id="cb108-74"><a href="annex-troubleshooting.html#cb108-74"></a></span>
<span id="cb108-75"><a href="annex-troubleshooting.html#cb108-75"></a>clay_im&lt;-Variables[[<span class="dv">3</span>]] </span>
<span id="cb108-76"><a href="annex-troubleshooting.html#cb108-76"></a></span>
<span id="cb108-77"><a href="annex-troubleshooting.html#cb108-77"></a>Cinputs_im&lt;-WARM_UP[[<span class="dv">10</span>]]</span>
<span id="cb108-78"><a href="annex-troubleshooting.html#cb108-78"></a></span>
<span id="cb108-79"><a href="annex-troubleshooting.html#cb108-79"></a>DR_im&lt;-Variables[[<span class="dv">40</span>]]</span>
<span id="cb108-80"><a href="annex-troubleshooting.html#cb108-80"></a></span>
<span id="cb108-81"><a href="annex-troubleshooting.html#cb108-81"></a>LU_im&lt;-Variables[[<span class="dv">41</span>]]</span>
<span id="cb108-82"><a href="annex-troubleshooting.html#cb108-82"></a></span>
<span id="cb108-83"><a href="annex-troubleshooting.html#cb108-83"></a><span class="co"># Define the years to run the model</span></span>
<span id="cb108-84"><a href="annex-troubleshooting.html#cb108-84"></a></span>
<span id="cb108-85"><a href="annex-troubleshooting.html#cb108-85"></a>years=<span class="kw">seq</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">12</span>,<span class="dv">20</span>,<span class="dt">by=</span><span class="dv">1</span><span class="op">/</span><span class="dv">12</span>)</span>
<span id="cb108-86"><a href="annex-troubleshooting.html#cb108-86"></a></span>
<span id="cb108-87"><a href="annex-troubleshooting.html#cb108-87"></a><span class="co"># ROTH C MODEL FUNCTION . </span></span>
<span id="cb108-88"><a href="annex-troubleshooting.html#cb108-88"></a></span>
<span id="cb108-89"><a href="annex-troubleshooting.html#cb108-89"></a><span class="co">#############function set up starts###############</span></span>
<span id="cb108-90"><a href="annex-troubleshooting.html#cb108-90"></a>Roth_C&lt;-<span class="cf">function</span>(Cinputs,years,DPMptf, RPMptf, BIOptf, HUMptf, FallIOM,Temp,Precip,Evp,Cov,Cov1,Cov2,soil.thick,SOC,clay,DR,bare1,LU)</span>
<span id="cb108-91"><a href="annex-troubleshooting.html#cb108-91"></a>{</span>
<span id="cb108-92"><a href="annex-troubleshooting.html#cb108-92"></a><span class="co"># Paddy Fields coefficent fPR = 0.4 if the target point is class = 13 , else fPR=1</span></span>
<span id="cb108-93"><a href="annex-troubleshooting.html#cb108-93"></a><span class="co"># From Shirato and Yukozawa 2004</span></span>
<span id="cb108-94"><a href="annex-troubleshooting.html#cb108-94"></a></span>
<span id="cb108-95"><a href="annex-troubleshooting.html#cb108-95"></a>fPR=(LU <span class="op">==</span><span class="st"> </span><span class="dv">13</span>)<span class="op">*</span><span class="fl">0.4</span> <span class="op">+</span><span class="st"> </span>(LU<span class="op">!=</span><span class="dv">13</span>)<span class="op">*</span><span class="dv">1</span></span>
<span id="cb108-96"><a href="annex-troubleshooting.html#cb108-96"></a></span>
<span id="cb108-97"><a href="annex-troubleshooting.html#cb108-97"></a><span class="co">#Temperature effects per month</span></span>
<span id="cb108-98"><a href="annex-troubleshooting.html#cb108-98"></a>fT=<span class="kw">fT.RothC</span>(Temp[,<span class="dv">2</span>]) </span>
<span id="cb108-99"><a href="annex-troubleshooting.html#cb108-99"></a></span>
<span id="cb108-100"><a href="annex-troubleshooting.html#cb108-100"></a><span class="co">#Moisture effects per month . </span></span>
<span id="cb108-101"><a href="annex-troubleshooting.html#cb108-101"></a></span>
<span id="cb108-102"><a href="annex-troubleshooting.html#cb108-102"></a>fw1func&lt;-<span class="cf">function</span>(P, E, <span class="dt">S.Thick =</span> <span class="dv">30</span>, <span class="dt">pClay =</span> <span class="fl">32.0213</span>, <span class="dt">pE =</span> <span class="dv">1</span>, bare) </span>
<span id="cb108-103"><a href="annex-troubleshooting.html#cb108-103"></a>{</span>
<span id="cb108-104"><a href="annex-troubleshooting.html#cb108-104"></a>   </span>
<span id="cb108-105"><a href="annex-troubleshooting.html#cb108-105"></a>    M =<span class="st"> </span>P <span class="op">-</span><span class="st"> </span>E <span class="op">*</span><span class="st"> </span>pE</span>
<span id="cb108-106"><a href="annex-troubleshooting.html#cb108-106"></a>    Acc.TSMD =<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb108-107"><a href="annex-troubleshooting.html#cb108-107"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="kw">length</span>(M)) {</span>
<span id="cb108-108"><a href="annex-troubleshooting.html#cb108-108"></a> 	B =<span class="st"> </span><span class="kw">ifelse</span>(bare[i] <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>, <span class="dv">1</span>, <span class="fl">1.8</span>)</span>
<span id="cb108-109"><a href="annex-troubleshooting.html#cb108-109"></a>	 Max.TSMD =<span class="st"> </span><span class="op">-</span>(<span class="dv">20</span> <span class="op">+</span><span class="st"> </span><span class="fl">1.3</span> <span class="op">*</span><span class="st"> </span>pClay <span class="op">-</span><span class="st"> </span><span class="fl">0.01</span> <span class="op">*</span><span class="st"> </span>(pClay<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(S.Thick<span class="op">/</span><span class="dv">23</span>) <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">/</span>B)</span>
<span id="cb108-110"><a href="annex-troubleshooting.html#cb108-110"></a>        Acc.TSMD[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">ifelse</span>(M[<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">0</span>, M[<span class="dv">1</span>])</span>
<span id="cb108-111"><a href="annex-troubleshooting.html#cb108-111"></a>        <span class="cf">if</span> (Acc.TSMD[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[i] <span class="op">&lt;</span><span class="st"> </span><span class="dv">0</span>) {</span>
<span id="cb108-112"><a href="annex-troubleshooting.html#cb108-112"></a>            Acc.TSMD[i] =<span class="st"> </span>Acc.TSMD[i <span class="op">-</span><span class="st"> </span><span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>M[i]</span>
<span id="cb108-113"><a href="annex-troubleshooting.html#cb108-113"></a>        }</span>
<span id="cb108-114"><a href="annex-troubleshooting.html#cb108-114"></a>        <span class="cf">else</span> (Acc.TSMD[i] =<span class="st"> </span><span class="dv">0</span>)</span>
<span id="cb108-115"><a href="annex-troubleshooting.html#cb108-115"></a>        <span class="cf">if</span> (Acc.TSMD[i] <span class="op">&lt;=</span><span class="st"> </span>Max.TSMD) {</span>
<span id="cb108-116"><a href="annex-troubleshooting.html#cb108-116"></a>            Acc.TSMD[i] =<span class="st"> </span>Max.TSMD</span>
<span id="cb108-117"><a href="annex-troubleshooting.html#cb108-117"></a>        }</span>
<span id="cb108-118"><a href="annex-troubleshooting.html#cb108-118"></a>    }</span>
<span id="cb108-119"><a href="annex-troubleshooting.html#cb108-119"></a>    b =<span class="st"> </span><span class="kw">ifelse</span>(Acc.TSMD <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.444</span> <span class="op">*</span><span class="st"> </span>Max.TSMD, <span class="dv">1</span>, (<span class="fl">0.2</span> <span class="op">+</span><span class="st"> </span><span class="fl">0.8</span> <span class="op">*</span><span class="st"> </span>((Max.TSMD <span class="op">-</span><span class="st"> </span></span>
<span id="cb108-120"><a href="annex-troubleshooting.html#cb108-120"></a><span class="st">        </span>Acc.TSMD)<span class="op">/</span>(Max.TSMD <span class="op">-</span><span class="st"> </span><span class="fl">0.444</span> <span class="op">*</span><span class="st"> </span>Max.TSMD))))</span>
<span id="cb108-121"><a href="annex-troubleshooting.html#cb108-121"></a>	b&lt;-<span class="kw">clamp</span>(b,<span class="dt">lower=</span><span class="fl">0.2</span>)</span>
<span id="cb108-122"><a href="annex-troubleshooting.html#cb108-122"></a>    <span class="kw">return</span>(<span class="kw">data.frame</span>(b))</span>
<span id="cb108-123"><a href="annex-troubleshooting.html#cb108-123"></a>}</span>
<span id="cb108-124"><a href="annex-troubleshooting.html#cb108-124"></a></span>
<span id="cb108-125"><a href="annex-troubleshooting.html#cb108-125"></a>fW_<span class="dv">2</span>&lt;-<span class="st"> </span><span class="kw">fw1func</span>(<span class="dt">P=</span>(Precip[,<span class="dv">2</span>]), <span class="dt">E=</span>(Evp[,<span class="dv">2</span>]), <span class="dt">S.Thick =</span> soil.thick, <span class="dt">pClay =</span> clay, <span class="dt">pE =</span> <span class="dv">1</span>, <span class="dt">bare=</span>bare1)<span class="op">$</span>b </span>
<span id="cb108-126"><a href="annex-troubleshooting.html#cb108-126"></a></span>
<span id="cb108-127"><a href="annex-troubleshooting.html#cb108-127"></a><span class="co">#Vegetation Cover effects  </span></span>
<span id="cb108-128"><a href="annex-troubleshooting.html#cb108-128"></a></span>
<span id="cb108-129"><a href="annex-troubleshooting.html#cb108-129"></a>fC&lt;-Cov2[,<span class="dv">2</span>]</span>
<span id="cb108-130"><a href="annex-troubleshooting.html#cb108-130"></a></span>
<span id="cb108-131"><a href="annex-troubleshooting.html#cb108-131"></a><span class="co"># Set the factors frame for Model calculations</span></span>
<span id="cb108-132"><a href="annex-troubleshooting.html#cb108-132"></a></span>
<span id="cb108-133"><a href="annex-troubleshooting.html#cb108-133"></a>xi.frame=<span class="kw">data.frame</span>(years,<span class="kw">rep</span>(fT<span class="op">*</span>fW_<span class="dv">2</span><span class="op">*</span>fC<span class="op">*</span>fPR,<span class="dt">length.out=</span><span class="kw">length</span>(years)))</span>
<span id="cb108-134"><a href="annex-troubleshooting.html#cb108-134"></a></span>
<span id="cb108-135"><a href="annex-troubleshooting.html#cb108-135"></a><span class="co"># RUN THE MODEL from SoilR</span></span>
<span id="cb108-136"><a href="annex-troubleshooting.html#cb108-136"></a><span class="co">#Loads the model </span></span>
<span id="cb108-137"><a href="annex-troubleshooting.html#cb108-137"></a><span class="co">#Model3_spin=RothCModel(t=years,C0=c(DPMptf[[1]], RPMptf[[1]], BIOptf[[1]], HUMptf[[1]], FallIOM[[1]]),In=Cinputs,DR=DR,clay=clay,xi=xi.frame, pass=TRUE) </span></span>
<span id="cb108-138"><a href="annex-troubleshooting.html#cb108-138"></a><span class="co">#Ct3_spin=getC(Model3_spin)</span></span>
<span id="cb108-139"><a href="annex-troubleshooting.html#cb108-139"></a></span>
<span id="cb108-140"><a href="annex-troubleshooting.html#cb108-140"></a><span class="co"># RUN THE MODEL from soilassesment</span></span>
<span id="cb108-141"><a href="annex-troubleshooting.html#cb108-141"></a></span>
<span id="cb108-142"><a href="annex-troubleshooting.html#cb108-142"></a>Model3_spin=<span class="kw">carbonTurnover</span>(<span class="dt">tt=</span>years,<span class="dt">C0=</span><span class="kw">c</span>(DPMptf[[<span class="dv">1</span>]], RPMptf[[<span class="dv">1</span>]], BIOptf[[<span class="dv">1</span>]], HUMptf[[<span class="dv">1</span>]], FallIOM[[<span class="dv">1</span>]]),<span class="dt">In=</span>Cinputs,<span class="dt">Dr=</span>DR,<span class="dt">clay=</span>clay,<span class="dt">effcts=</span>xi.frame, <span class="st">&quot;euler&quot;</span>) </span>
<span id="cb108-143"><a href="annex-troubleshooting.html#cb108-143"></a></span>
<span id="cb108-144"><a href="annex-troubleshooting.html#cb108-144"></a>Ct3_spin=Model3_spin[,<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>]</span>
<span id="cb108-145"><a href="annex-troubleshooting.html#cb108-145"></a></span>
<span id="cb108-146"><a href="annex-troubleshooting.html#cb108-146"></a><span class="co"># Get the final pools of the time series</span></span>
<span id="cb108-147"><a href="annex-troubleshooting.html#cb108-147"></a></span>
<span id="cb108-148"><a href="annex-troubleshooting.html#cb108-148"></a>poolSize3_spin=<span class="kw">as.numeric</span>(<span class="kw">tail</span>(Ct3_spin,<span class="dv">1</span>))</span>
<span id="cb108-149"><a href="annex-troubleshooting.html#cb108-149"></a></span>
<span id="cb108-150"><a href="annex-troubleshooting.html#cb108-150"></a><span class="kw">return</span>(poolSize3_spin)</span>
<span id="cb108-151"><a href="annex-troubleshooting.html#cb108-151"></a>}</span>
<span id="cb108-152"><a href="annex-troubleshooting.html#cb108-152"></a><span class="co">################function set up ends#############</span></span>
<span id="cb108-153"><a href="annex-troubleshooting.html#cb108-153"></a></span>
<span id="cb108-154"><a href="annex-troubleshooting.html#cb108-154"></a></span>
<span id="cb108-155"><a href="annex-troubleshooting.html#cb108-155"></a><span class="co"># Iterates over the area of interest</span></span>
<span id="cb108-156"><a href="annex-troubleshooting.html#cb108-156"></a><span class="co">##################for loop starts###############</span></span>
<span id="cb108-157"><a href="annex-troubleshooting.html#cb108-157"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(Variables)[<span class="dv">1</span>]) {</span>
<span id="cb108-158"><a href="annex-troubleshooting.html#cb108-158"></a></span>
<span id="cb108-159"><a href="annex-troubleshooting.html#cb108-159"></a><span class="co"># Extract the variables </span></span>
<span id="cb108-160"><a href="annex-troubleshooting.html#cb108-160"></a></span>
<span id="cb108-161"><a href="annex-troubleshooting.html#cb108-161"></a>Vect&lt;-<span class="kw">as.data.frame</span>(Variables[i,])</span>
<span id="cb108-162"><a href="annex-troubleshooting.html#cb108-162"></a></span>
<span id="cb108-163"><a href="annex-troubleshooting.html#cb108-163"></a>Temp&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">4</span><span class="op">:</span><span class="dv">15</span>]))</span>
<span id="cb108-164"><a href="annex-troubleshooting.html#cb108-164"></a>Temp&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Temp=</span>Temp[,<span class="dv">1</span>])</span>
<span id="cb108-165"><a href="annex-troubleshooting.html#cb108-165"></a></span>
<span id="cb108-166"><a href="annex-troubleshooting.html#cb108-166"></a>Precip&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">16</span><span class="op">:</span><span class="dv">27</span>]))</span>
<span id="cb108-167"><a href="annex-troubleshooting.html#cb108-167"></a>Precip&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Precip=</span>Precip[,<span class="dv">1</span>])</span>
<span id="cb108-168"><a href="annex-troubleshooting.html#cb108-168"></a></span>
<span id="cb108-169"><a href="annex-troubleshooting.html#cb108-169"></a>Evp&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">28</span><span class="op">:</span><span class="dv">39</span>]))</span>
<span id="cb108-170"><a href="annex-troubleshooting.html#cb108-170"></a>Evp&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Evp=</span>Evp[,<span class="dv">1</span>])</span>
<span id="cb108-171"><a href="annex-troubleshooting.html#cb108-171"></a>	</span>
<span id="cb108-172"><a href="annex-troubleshooting.html#cb108-172"></a>Cov&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(Vect[<span class="dv">42</span><span class="op">:</span><span class="dv">53</span>]))</span>
<span id="cb108-173"><a href="annex-troubleshooting.html#cb108-173"></a>Cov1&lt;-<span class="kw">data.frame</span>(<span class="dt">Cov=</span>Cov[,<span class="dv">1</span>])</span>
<span id="cb108-174"><a href="annex-troubleshooting.html#cb108-174"></a>Cov2&lt;-<span class="kw">data.frame</span>(<span class="dt">Month=</span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">Cov=</span>Cov[,<span class="dv">1</span>])</span>
<span id="cb108-175"><a href="annex-troubleshooting.html#cb108-175"></a></span>
<span id="cb108-176"><a href="annex-troubleshooting.html#cb108-176"></a><span class="co">#Avoid calculus over Na values </span></span>
<span id="cb108-177"><a href="annex-troubleshooting.html#cb108-177"></a></span>
<span id="cb108-178"><a href="annex-troubleshooting.html#cb108-178"></a><span class="cf">if</span> (<span class="kw">any</span>(<span class="kw">is.na</span>(Evp[,<span class="dv">2</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Temp[,<span class="dv">2</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(SOC_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(clay_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Precip[,<span class="dv">2</span>]))  <span class="op">|</span><span class="st">  </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cov2[,<span class="dv">2</span>]))  <span class="op">|</span><span class="st">  </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cov1[,<span class="dv">1</span>])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(Cinputs_im[i])) <span class="op">|</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">is.na</span>(DR_im[i])) <span class="op">|</span><span class="st"> </span>(Cinputs_im[i]<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">|</span><span class="st">  </span>(SOC_im[i]<span class="op">&lt;</span><span class="dv">0</span>) <span class="op">|</span><span class="st"> </span>(clay_im[i]<span class="op">&lt;</span><span class="dv">0</span>) ) {FOWARD[i,<span class="dv">2</span>]&lt;-<span class="dv">0</span>}<span class="cf">else</span>{</span>
<span id="cb108-179"><a href="annex-troubleshooting.html#cb108-179"></a></span>
<span id="cb108-180"><a href="annex-troubleshooting.html#cb108-180"></a></span>
<span id="cb108-181"><a href="annex-troubleshooting.html#cb108-181"></a><span class="co"># Set the variables from the images</span></span>
<span id="cb108-182"><a href="annex-troubleshooting.html#cb108-182"></a></span>
<span id="cb108-183"><a href="annex-troubleshooting.html#cb108-183"></a>soil.thick=<span class="dv">30</span>  <span class="co">#Soil thickness (organic layer topsoil), in cm</span></span>
<span id="cb108-184"><a href="annex-troubleshooting.html#cb108-184"></a>SOC&lt;-SOC_im[i]      <span class="co">#Soil organic carbon in Mg/ha </span></span>
<span id="cb108-185"><a href="annex-troubleshooting.html#cb108-185"></a>clay&lt;-clay_im[i]        <span class="co">#Percent clay %</span></span>
<span id="cb108-186"><a href="annex-troubleshooting.html#cb108-186"></a>Cinputs&lt;-Cinputs_im[i]    <span class="co">#Annual C inputs to soil in Mg/ha/yr</span></span>
<span id="cb108-187"><a href="annex-troubleshooting.html#cb108-187"></a></span>
<span id="cb108-188"><a href="annex-troubleshooting.html#cb108-188"></a>DR&lt;-DR_im[i]              <span class="co"># DPM/RPM (decomplosable vs resistant plant material.)</span></span>
<span id="cb108-189"><a href="annex-troubleshooting.html#cb108-189"></a>bare1&lt;-(Cov1<span class="op">&gt;</span><span class="fl">0.8</span>)           <span class="co"># If the surface is bare or vegetated</span></span>
<span id="cb108-190"><a href="annex-troubleshooting.html#cb108-190"></a>LU&lt;-LU_im[i]</span>
<span id="cb108-191"><a href="annex-troubleshooting.html#cb108-191"></a></span>
<span id="cb108-192"><a href="annex-troubleshooting.html#cb108-192"></a><span class="co"># Final calculation of SOC  20 years in the future  (Business as usual)</span></span>
<span id="cb108-193"><a href="annex-troubleshooting.html#cb108-193"></a></span>
<span id="cb108-194"><a href="annex-troubleshooting.html#cb108-194"></a>f_bau&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs,<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-195"><a href="annex-troubleshooting.html#cb108-195"></a>f_bau_t&lt;-f_bau[<span class="dv">1</span>]<span class="op">+</span>f_bau[<span class="dv">2</span>]<span class="op">+</span>f_bau[<span class="dv">3</span>]<span class="op">+</span>f_bau[<span class="dv">4</span>]<span class="op">+</span>f_bau[<span class="dv">5</span>]</span>
<span id="cb108-196"><a href="annex-troubleshooting.html#cb108-196"></a></span>
<span id="cb108-197"><a href="annex-troubleshooting.html#cb108-197"></a><span class="co">#Unc BAU minimum </span></span>
<span id="cb108-198"><a href="annex-troubleshooting.html#cb108-198"></a>Cinputs_min&lt;-WARM_UP<span class="op">@</span>data[i,<span class="dv">23</span>]</span>
<span id="cb108-199"><a href="annex-troubleshooting.html#cb108-199"></a>Cinputs_max&lt;-WARM_UP<span class="op">@</span>data[i,<span class="dv">24</span>]</span>
<span id="cb108-200"><a href="annex-troubleshooting.html#cb108-200"></a>SOC_t0_min&lt;-WARM_UP<span class="op">@</span>data[i,<span class="dv">11</span>]</span>
<span id="cb108-201"><a href="annex-troubleshooting.html#cb108-201"></a>SOC_t0_max&lt;-WARM_UP<span class="op">@</span>data[i,<span class="dv">17</span>]</span>
<span id="cb108-202"><a href="annex-troubleshooting.html#cb108-202"></a></span>
<span id="cb108-203"><a href="annex-troubleshooting.html#cb108-203"></a>f_bau_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs_min,<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">12</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">13</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">14</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">15</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">16</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">0.8</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">0.9</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-204"><a href="annex-troubleshooting.html#cb108-204"></a>f_bau_t_min&lt;-f_bau_min[<span class="dv">1</span>]<span class="op">+</span>f_bau_min[<span class="dv">2</span>]<span class="op">+</span>f_bau_min[<span class="dv">3</span>]<span class="op">+</span>f_bau_min[<span class="dv">4</span>]<span class="op">+</span>f_bau_min[<span class="dv">5</span>]</span>
<span id="cb108-205"><a href="annex-troubleshooting.html#cb108-205"></a></span>
<span id="cb108-206"><a href="annex-troubleshooting.html#cb108-206"></a><span class="co">#Unc BAU maximum</span></span>
<span id="cb108-207"><a href="annex-troubleshooting.html#cb108-207"></a></span>
<span id="cb108-208"><a href="annex-troubleshooting.html#cb108-208"></a>f_bau_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>Cinputs_max,<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">18</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">19</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">20</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">21</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">22</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">1.2</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">1.1</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-209"><a href="annex-troubleshooting.html#cb108-209"></a>f_bau_t_max&lt;-f_bau_max[<span class="dv">1</span>]<span class="op">+</span>f_bau_max[<span class="dv">2</span>]<span class="op">+</span>f_bau_max[<span class="dv">3</span>]<span class="op">+</span>f_bau_max[<span class="dv">4</span>]<span class="op">+</span>f_bau_max[<span class="dv">5</span>]</span>
<span id="cb108-210"><a href="annex-troubleshooting.html#cb108-210"></a></span>
<span id="cb108-211"><a href="annex-troubleshooting.html#cb108-211"></a><span class="co"># Crops and Tree crops</span></span>
<span id="cb108-212"><a href="annex-troubleshooting.html#cb108-212"></a><span class="cf">if</span> (LU<span class="op">==</span><span class="dv">2</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">12</span>){</span>
<span id="cb108-213"><a href="annex-troubleshooting.html#cb108-213"></a>f_low&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>Low_Crops),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-214"><a href="annex-troubleshooting.html#cb108-214"></a>f_low_t&lt;-f_low[<span class="dv">1</span>]<span class="op">+</span>f_low[<span class="dv">2</span>]<span class="op">+</span>f_low[<span class="dv">3</span>]<span class="op">+</span>f_low[<span class="dv">4</span>]<span class="op">+</span>f_low[<span class="dv">5</span>]</span>
<span id="cb108-215"><a href="annex-troubleshooting.html#cb108-215"></a></span>
<span id="cb108-216"><a href="annex-troubleshooting.html#cb108-216"></a>f_med&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>Med_Crops),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-217"><a href="annex-troubleshooting.html#cb108-217"></a>f_med_t&lt;-f_med[<span class="dv">1</span>]<span class="op">+</span>f_med[<span class="dv">2</span>]<span class="op">+</span>f_med[<span class="dv">3</span>]<span class="op">+</span>f_med[<span class="dv">4</span>]<span class="op">+</span>f_med[<span class="dv">5</span>]</span>
<span id="cb108-218"><a href="annex-troubleshooting.html#cb108-218"></a></span>
<span id="cb108-219"><a href="annex-troubleshooting.html#cb108-219"></a>f_high&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>High_Crops),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-220"><a href="annex-troubleshooting.html#cb108-220"></a>f_high_t&lt;-f_high[<span class="dv">1</span>]<span class="op">+</span>f_high[<span class="dv">2</span>]<span class="op">+</span>f_high[<span class="dv">3</span>]<span class="op">+</span>f_high[<span class="dv">4</span>]<span class="op">+</span>f_high[<span class="dv">5</span>]</span>
<span id="cb108-221"><a href="annex-troubleshooting.html#cb108-221"></a></span>
<span id="cb108-222"><a href="annex-troubleshooting.html#cb108-222"></a><span class="co"># SSM croplands unc min</span></span>
<span id="cb108-223"><a href="annex-troubleshooting.html#cb108-223"></a></span>
<span id="cb108-224"><a href="annex-troubleshooting.html#cb108-224"></a>f_med_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs_min<span class="op">*</span>(Med_Crops<span class="fl">-0.15</span>)),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">12</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">13</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">14</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">15</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">16</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">0.8</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">0.9</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-225"><a href="annex-troubleshooting.html#cb108-225"></a>f_med_t_min&lt;-f_med_min[<span class="dv">1</span>]<span class="op">+</span>f_med_min[<span class="dv">2</span>]<span class="op">+</span>f_med_min[<span class="dv">3</span>]<span class="op">+</span>f_med_min[<span class="dv">4</span>]<span class="op">+</span>f_med_min[<span class="dv">5</span>]</span>
<span id="cb108-226"><a href="annex-troubleshooting.html#cb108-226"></a></span>
<span id="cb108-227"><a href="annex-troubleshooting.html#cb108-227"></a><span class="co"># SSM croplands unc max</span></span>
<span id="cb108-228"><a href="annex-troubleshooting.html#cb108-228"></a></span>
<span id="cb108-229"><a href="annex-troubleshooting.html#cb108-229"></a>f_med_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs_max<span class="op">*</span>(Med_Crops<span class="fl">+0.15</span>)),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">18</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">19</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">20</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">21</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">22</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">1.2</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">1.1</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-230"><a href="annex-troubleshooting.html#cb108-230"></a>f_med_t_max&lt;-f_med_max[<span class="dv">1</span>]<span class="op">+</span>f_med_max[<span class="dv">2</span>]<span class="op">+</span>f_med_max[<span class="dv">3</span>]<span class="op">+</span>f_med_max[<span class="dv">4</span>]<span class="op">+</span>f_med_max[<span class="dv">5</span>]</span>
<span id="cb108-231"><a href="annex-troubleshooting.html#cb108-231"></a></span>
<span id="cb108-232"><a href="annex-troubleshooting.html#cb108-232"></a>}</span>
<span id="cb108-233"><a href="annex-troubleshooting.html#cb108-233"></a><span class="co">#Shrublands, grasslands, and sparce vegetation</span></span>
<span id="cb108-234"><a href="annex-troubleshooting.html#cb108-234"></a><span class="cf">else</span> <span class="cf">if</span> (LU<span class="op">==</span><span class="dv">3</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">5</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">6</span> <span class="op">|</span><span class="st"> </span>LU<span class="op">==</span><span class="dv">8</span>) {</span>
<span id="cb108-235"><a href="annex-troubleshooting.html#cb108-235"></a>f_low&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>Low_Grass),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-236"><a href="annex-troubleshooting.html#cb108-236"></a>f_low_t&lt;-f_low[<span class="dv">1</span>]<span class="op">+</span>f_low[<span class="dv">2</span>]<span class="op">+</span>f_low[<span class="dv">3</span>]<span class="op">+</span>f_low[<span class="dv">4</span>]<span class="op">+</span>f_low[<span class="dv">5</span>]</span>
<span id="cb108-237"><a href="annex-troubleshooting.html#cb108-237"></a></span>
<span id="cb108-238"><a href="annex-troubleshooting.html#cb108-238"></a>f_med&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>Med_Grass),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-239"><a href="annex-troubleshooting.html#cb108-239"></a>f_med_t&lt;-f_med[<span class="dv">1</span>]<span class="op">+</span>f_med[<span class="dv">2</span>]<span class="op">+</span>f_med[<span class="dv">3</span>]<span class="op">+</span>f_med[<span class="dv">4</span>]<span class="op">+</span>f_med[<span class="dv">5</span>]</span>
<span id="cb108-240"><a href="annex-troubleshooting.html#cb108-240"></a></span>
<span id="cb108-241"><a href="annex-troubleshooting.html#cb108-241"></a>f_high&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>High_Grass),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-242"><a href="annex-troubleshooting.html#cb108-242"></a>f_high_t&lt;-f_high[<span class="dv">1</span>]<span class="op">+</span>f_high[<span class="dv">2</span>]<span class="op">+</span>f_high[<span class="dv">3</span>]<span class="op">+</span>f_high[<span class="dv">4</span>]<span class="op">+</span>f_high[<span class="dv">5</span>]</span>
<span id="cb108-243"><a href="annex-troubleshooting.html#cb108-243"></a></span>
<span id="cb108-244"><a href="annex-troubleshooting.html#cb108-244"></a><span class="co">#SSM Shrublands unc min</span></span>
<span id="cb108-245"><a href="annex-troubleshooting.html#cb108-245"></a></span>
<span id="cb108-246"><a href="annex-troubleshooting.html#cb108-246"></a>f_med_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs_min<span class="op">*</span>(Med_Grass<span class="fl">-0.15</span>)),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">12</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">13</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">14</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">15</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">16</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">0.8</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">0.9</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-247"><a href="annex-troubleshooting.html#cb108-247"></a>f_med_t_min&lt;-f_med_min[<span class="dv">1</span>]<span class="op">+</span>f_med_min[<span class="dv">2</span>]<span class="op">+</span>f_med_min[<span class="dv">3</span>]<span class="op">+</span>f_med_min[<span class="dv">4</span>]<span class="op">+</span>f_med_min[<span class="dv">5</span>]</span>
<span id="cb108-248"><a href="annex-troubleshooting.html#cb108-248"></a></span>
<span id="cb108-249"><a href="annex-troubleshooting.html#cb108-249"></a><span class="co">#SSM Shrublands unc max</span></span>
<span id="cb108-250"><a href="annex-troubleshooting.html#cb108-250"></a></span>
<span id="cb108-251"><a href="annex-troubleshooting.html#cb108-251"></a>f_med_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs_max<span class="op">*</span>(Med_Grass<span class="fl">+0.15</span>)),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">18</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">19</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">20</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">21</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">22</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">1.2</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">1.1</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-252"><a href="annex-troubleshooting.html#cb108-252"></a>f_med_t_max&lt;-f_med_max[<span class="dv">1</span>]<span class="op">+</span>f_med_max[<span class="dv">2</span>]<span class="op">+</span>f_med_max[<span class="dv">3</span>]<span class="op">+</span>f_med_max[<span class="dv">4</span>]<span class="op">+</span>f_med_max[<span class="dv">5</span>]</span>
<span id="cb108-253"><a href="annex-troubleshooting.html#cb108-253"></a></span>
<span id="cb108-254"><a href="annex-troubleshooting.html#cb108-254"></a>}</span>
<span id="cb108-255"><a href="annex-troubleshooting.html#cb108-255"></a><span class="co"># Paddy Fields </span></span>
<span id="cb108-256"><a href="annex-troubleshooting.html#cb108-256"></a><span class="cf">else</span> <span class="cf">if</span> (LU<span class="op">==</span><span class="dv">13</span>) {</span>
<span id="cb108-257"><a href="annex-troubleshooting.html#cb108-257"></a>f_low&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>Low_PaddyFields),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-258"><a href="annex-troubleshooting.html#cb108-258"></a>f_low_t&lt;-f_low[<span class="dv">1</span>]<span class="op">+</span>f_low[<span class="dv">2</span>]<span class="op">+</span>f_low[<span class="dv">3</span>]<span class="op">+</span>f_low[<span class="dv">4</span>]<span class="op">+</span>f_low[<span class="dv">5</span>]</span>
<span id="cb108-259"><a href="annex-troubleshooting.html#cb108-259"></a></span>
<span id="cb108-260"><a href="annex-troubleshooting.html#cb108-260"></a>f_med&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>Med_PaddyFields),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-261"><a href="annex-troubleshooting.html#cb108-261"></a>f_med_t&lt;-f_med[<span class="dv">1</span>]<span class="op">+</span>f_med[<span class="dv">2</span>]<span class="op">+</span>f_med[<span class="dv">3</span>]<span class="op">+</span>f_med[<span class="dv">4</span>]<span class="op">+</span>f_med[<span class="dv">5</span>]</span>
<span id="cb108-262"><a href="annex-troubleshooting.html#cb108-262"></a></span>
<span id="cb108-263"><a href="annex-troubleshooting.html#cb108-263"></a>f_high&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs<span class="op">*</span>High_PaddyFields),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">5</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">6</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">7</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">8</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">9</span>],<span class="dt">Temp=</span>Temp,<span class="dt">Precip=</span>Precip,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC,<span class="dt">clay=</span>clay,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-264"><a href="annex-troubleshooting.html#cb108-264"></a>f_high_t&lt;-f_high[<span class="dv">1</span>]<span class="op">+</span>f_high[<span class="dv">2</span>]<span class="op">+</span>f_high[<span class="dv">3</span>]<span class="op">+</span>f_high[<span class="dv">4</span>]<span class="op">+</span>f_high[<span class="dv">5</span>]</span>
<span id="cb108-265"><a href="annex-troubleshooting.html#cb108-265"></a></span>
<span id="cb108-266"><a href="annex-troubleshooting.html#cb108-266"></a><span class="co">#SSM Forest unc min</span></span>
<span id="cb108-267"><a href="annex-troubleshooting.html#cb108-267"></a></span>
<span id="cb108-268"><a href="annex-troubleshooting.html#cb108-268"></a>f_med_min&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs_min<span class="op">*</span>(Med_PaddyFields<span class="fl">-0.15</span>)),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">12</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">13</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">14</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">15</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">16</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">1.02</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">0.95</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">0.8</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">0.9</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-269"><a href="annex-troubleshooting.html#cb108-269"></a>f_med_t_min&lt;-f_med_min[<span class="dv">1</span>]<span class="op">+</span>f_med_min[<span class="dv">2</span>]<span class="op">+</span>f_med_min[<span class="dv">3</span>]<span class="op">+</span>f_med_min[<span class="dv">4</span>]<span class="op">+</span>f_med_min[<span class="dv">5</span>]</span>
<span id="cb108-270"><a href="annex-troubleshooting.html#cb108-270"></a></span>
<span id="cb108-271"><a href="annex-troubleshooting.html#cb108-271"></a><span class="co">#SSM Forest unc max</span></span>
<span id="cb108-272"><a href="annex-troubleshooting.html#cb108-272"></a></span>
<span id="cb108-273"><a href="annex-troubleshooting.html#cb108-273"></a>f_med_max&lt;-<span class="kw">Roth_C</span>(<span class="dt">Cinputs=</span>(Cinputs_max<span class="op">*</span>(Med_PaddyFields<span class="fl">+0.15</span>)),<span class="dt">years=</span>years,<span class="dt">DPMptf=</span>WARM_UP[i,<span class="dv">18</span>], <span class="dt">RPMptf=</span>WARM_UP[i,<span class="dv">19</span>], <span class="dt">BIOptf=</span>WARM_UP[i,<span class="dv">20</span>], <span class="dt">HUMptf=</span>WARM_UP[i,<span class="dv">21</span>], <span class="dt">FallIOM=</span>WARM_UP[i,<span class="dv">22</span>],<span class="dt">Temp=</span>Temp<span class="op">*</span><span class="fl">0.98</span>,<span class="dt">Precip=</span>Precip<span class="op">*</span><span class="fl">1.05</span>,<span class="dt">Evp=</span>Evp,<span class="dt">Cov=</span>Cov,<span class="dt">Cov1=</span>Cov1,<span class="dt">Cov2=</span>Cov2,<span class="dt">soil.thick=</span>soil.thick,<span class="dt">SOC=</span>SOC<span class="op">*</span><span class="fl">1.2</span>,<span class="dt">clay=</span>clay<span class="op">*</span><span class="fl">1.1</span>,<span class="dt">DR=</span>DR,<span class="dt">bare1=</span>bare1,<span class="dt">LU=</span>LU)</span>
<span id="cb108-274"><a href="annex-troubleshooting.html#cb108-274"></a>f_med_t_max&lt;-f_med_max[<span class="dv">1</span>]<span class="op">+</span>f_med_max[<span class="dv">2</span>]<span class="op">+</span>f_med_max[<span class="dv">3</span>]<span class="op">+</span>f_med_max[<span class="dv">4</span>]<span class="op">+</span>f_med_max[<span class="dv">5</span>]</span>
<span id="cb108-275"><a href="annex-troubleshooting.html#cb108-275"></a></span>
<span id="cb108-276"><a href="annex-troubleshooting.html#cb108-276"></a>}</span>
<span id="cb108-277"><a href="annex-troubleshooting.html#cb108-277"></a></span>
<span id="cb108-278"><a href="annex-troubleshooting.html#cb108-278"></a><span class="cf">else</span>{</span>
<span id="cb108-279"><a href="annex-troubleshooting.html#cb108-279"></a>f_bau_t&lt;-<span class="dv">0</span></span>
<span id="cb108-280"><a href="annex-troubleshooting.html#cb108-280"></a>f_low_t&lt;-<span class="dv">0</span></span>
<span id="cb108-281"><a href="annex-troubleshooting.html#cb108-281"></a>f_med_t&lt;-<span class="dv">0</span></span>
<span id="cb108-282"><a href="annex-troubleshooting.html#cb108-282"></a>f_high_t&lt;-<span class="dv">0</span></span>
<span id="cb108-283"><a href="annex-troubleshooting.html#cb108-283"></a>f_bau_t_min&lt;-<span class="dv">0</span></span>
<span id="cb108-284"><a href="annex-troubleshooting.html#cb108-284"></a>f_bau_t_max&lt;-<span class="dv">0</span></span>
<span id="cb108-285"><a href="annex-troubleshooting.html#cb108-285"></a>f_med_t_min&lt;-<span class="dv">0</span></span>
<span id="cb108-286"><a href="annex-troubleshooting.html#cb108-286"></a>f_med_t_max&lt;-<span class="dv">0</span></span>
<span id="cb108-287"><a href="annex-troubleshooting.html#cb108-287"></a>SOC_t0_min&lt;-<span class="dv">0</span></span>
<span id="cb108-288"><a href="annex-troubleshooting.html#cb108-288"></a>SOC_t0_max&lt;-<span class="dv">0</span></span>
<span id="cb108-289"><a href="annex-troubleshooting.html#cb108-289"></a></span>
<span id="cb108-290"><a href="annex-troubleshooting.html#cb108-290"></a>}</span>
<span id="cb108-291"><a href="annex-troubleshooting.html#cb108-291"></a></span>
<span id="cb108-292"><a href="annex-troubleshooting.html#cb108-292"></a></span>
<span id="cb108-293"><a href="annex-troubleshooting.html#cb108-293"></a>FOWARD[i,<span class="dv">2</span>]&lt;-SOC</span>
<span id="cb108-294"><a href="annex-troubleshooting.html#cb108-294"></a>FOWARD[i,<span class="dv">3</span>]&lt;-f_bau_t</span>
<span id="cb108-295"><a href="annex-troubleshooting.html#cb108-295"></a>FOWARD[i,<span class="dv">4</span>]&lt;-f_bau[<span class="dv">1</span>]</span>
<span id="cb108-296"><a href="annex-troubleshooting.html#cb108-296"></a>FOWARD[i,<span class="dv">5</span>]&lt;-f_bau[<span class="dv">2</span>]</span>
<span id="cb108-297"><a href="annex-troubleshooting.html#cb108-297"></a>FOWARD[i,<span class="dv">6</span>]&lt;-f_bau[<span class="dv">3</span>]</span>
<span id="cb108-298"><a href="annex-troubleshooting.html#cb108-298"></a>FOWARD[i,<span class="dv">7</span>]&lt;-f_bau[<span class="dv">4</span>]</span>
<span id="cb108-299"><a href="annex-troubleshooting.html#cb108-299"></a>FOWARD[i,<span class="dv">8</span>]&lt;-f_bau[<span class="dv">5</span>]</span>
<span id="cb108-300"><a href="annex-troubleshooting.html#cb108-300"></a>FOWARD[i,<span class="dv">9</span>]&lt;-LU</span>
<span id="cb108-301"><a href="annex-troubleshooting.html#cb108-301"></a>FOWARD[i,<span class="dv">10</span>]&lt;-f_low_t</span>
<span id="cb108-302"><a href="annex-troubleshooting.html#cb108-302"></a>FOWARD[i,<span class="dv">11</span>]&lt;-f_med_t</span>
<span id="cb108-303"><a href="annex-troubleshooting.html#cb108-303"></a>FOWARD[i,<span class="dv">12</span>]&lt;-f_high_t</span>
<span id="cb108-304"><a href="annex-troubleshooting.html#cb108-304"></a>FOWARD[i,<span class="dv">13</span>]&lt;-f_bau_t_min</span>
<span id="cb108-305"><a href="annex-troubleshooting.html#cb108-305"></a>FOWARD[i,<span class="dv">14</span>]&lt;-f_bau_t_max</span>
<span id="cb108-306"><a href="annex-troubleshooting.html#cb108-306"></a>FOWARD[i,<span class="dv">15</span>]&lt;-f_med_t_min</span>
<span id="cb108-307"><a href="annex-troubleshooting.html#cb108-307"></a>FOWARD[i,<span class="dv">16</span>]&lt;-f_med_t_max</span>
<span id="cb108-308"><a href="annex-troubleshooting.html#cb108-308"></a>FOWARD[i,<span class="dv">17</span>]&lt;-SOC_t0_min</span>
<span id="cb108-309"><a href="annex-troubleshooting.html#cb108-309"></a>FOWARD[i,<span class="dv">18</span>]&lt;-SOC_t0_max</span>
<span id="cb108-310"><a href="annex-troubleshooting.html#cb108-310"></a></span>
<span id="cb108-311"><a href="annex-troubleshooting.html#cb108-311"></a></span>
<span id="cb108-312"><a href="annex-troubleshooting.html#cb108-312"></a></span>
<span id="cb108-313"><a href="annex-troubleshooting.html#cb108-313"></a><span class="kw">print</span>(<span class="kw">c</span>(i,SOC,f_bau_t,f_low_t,f_med_t,f_high_t,f_bau_t_min,f_bau_t_max))</span>
<span id="cb108-314"><a href="annex-troubleshooting.html#cb108-314"></a></span>
<span id="cb108-315"><a href="annex-troubleshooting.html#cb108-315"></a>}</span>
<span id="cb108-316"><a href="annex-troubleshooting.html#cb108-316"></a>}</span>
<span id="cb108-317"><a href="annex-troubleshooting.html#cb108-317"></a></span>
<span id="cb108-318"><a href="annex-troubleshooting.html#cb108-318"></a><span class="co">############for loop ends##############</span></span>
<span id="cb108-319"><a href="annex-troubleshooting.html#cb108-319"></a></span>
<span id="cb108-320"><a href="annex-troubleshooting.html#cb108-320"></a></span>
<span id="cb108-321"><a href="annex-troubleshooting.html#cb108-321"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">2</span>]=<span class="st">&quot;SOC_t0&quot;</span></span>
<span id="cb108-322"><a href="annex-troubleshooting.html#cb108-322"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">3</span>]=<span class="st">&quot;SOC_BAU_20&quot;</span></span>
<span id="cb108-323"><a href="annex-troubleshooting.html#cb108-323"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">4</span>]=<span class="st">&quot;DPM_BAU_20&quot;</span></span>
<span id="cb108-324"><a href="annex-troubleshooting.html#cb108-324"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">5</span>]=<span class="st">&quot;RPM_BAU_20&quot;</span></span>
<span id="cb108-325"><a href="annex-troubleshooting.html#cb108-325"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">6</span>]=<span class="st">&quot;BIO_BAU_20&quot;</span></span>
<span id="cb108-326"><a href="annex-troubleshooting.html#cb108-326"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">7</span>]=<span class="st">&quot;HUM_BAU_20&quot;</span></span>
<span id="cb108-327"><a href="annex-troubleshooting.html#cb108-327"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">8</span>]=<span class="st">&quot;IOM_BAU_20&quot;</span></span>
<span id="cb108-328"><a href="annex-troubleshooting.html#cb108-328"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">9</span>]=<span class="st">&quot;LandUse&quot;</span></span>
<span id="cb108-329"><a href="annex-troubleshooting.html#cb108-329"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">10</span>]=<span class="st">&quot;Low_Scenario&quot;</span></span>
<span id="cb108-330"><a href="annex-troubleshooting.html#cb108-330"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">11</span>]=<span class="st">&quot;Med_Scenario&quot;</span></span>
<span id="cb108-331"><a href="annex-troubleshooting.html#cb108-331"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">12</span>]=<span class="st">&quot;High_Scenario&quot;</span></span>
<span id="cb108-332"><a href="annex-troubleshooting.html#cb108-332"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">13</span>]=<span class="st">&quot;SOC_BAU_20_min&quot;</span></span>
<span id="cb108-333"><a href="annex-troubleshooting.html#cb108-333"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">14</span>]=<span class="st">&quot;SOC_BAU_20_max&quot;</span></span>
<span id="cb108-334"><a href="annex-troubleshooting.html#cb108-334"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">15</span>]=<span class="st">&quot;Med_Scen_min&quot;</span></span>
<span id="cb108-335"><a href="annex-troubleshooting.html#cb108-335"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">16</span>]=<span class="st">&quot;Med_Scen_max&quot;</span></span>
<span id="cb108-336"><a href="annex-troubleshooting.html#cb108-336"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">17</span>]=<span class="st">&quot;SOC_t0_min&quot;</span></span>
<span id="cb108-337"><a href="annex-troubleshooting.html#cb108-337"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">18</span>]=<span class="st">&quot;SOC_t0_max&quot;</span></span>
<span id="cb108-338"><a href="annex-troubleshooting.html#cb108-338"></a></span>
<span id="cb108-339"><a href="annex-troubleshooting.html#cb108-339"></a></span>
<span id="cb108-340"><a href="annex-troubleshooting.html#cb108-340"></a></span>
<span id="cb108-341"><a href="annex-troubleshooting.html#cb108-341"></a><span class="co"># Eliminate  values out of range</span></span>
<span id="cb108-342"><a href="annex-troubleshooting.html#cb108-342"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span>[FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span><span class="op">&lt;</span><span class="dv">0</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-343"><a href="annex-troubleshooting.html#cb108-343"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Low_Scenario[FOWARD<span class="op">@</span>data<span class="op">$</span>Low_Scenario<span class="op">&lt;</span><span class="dv">0</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-344"><a href="annex-troubleshooting.html#cb108-344"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scenario[FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scenario<span class="op">&lt;</span><span class="dv">0</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-345"><a href="annex-troubleshooting.html#cb108-345"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>High_Scenario[FOWARD<span class="op">@</span>data<span class="op">$</span>High_Scenario<span class="op">&lt;</span><span class="dv">0</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-346"><a href="annex-troubleshooting.html#cb108-346"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_min[FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_min<span class="op">&lt;</span><span class="dv">0</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-347"><a href="annex-troubleshooting.html#cb108-347"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_max[FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_max<span class="op">&lt;</span><span class="dv">0</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-348"><a href="annex-troubleshooting.html#cb108-348"></a></span>
<span id="cb108-349"><a href="annex-troubleshooting.html#cb108-349"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span>[FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span><span class="op">&gt;</span><span class="dv">300</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-350"><a href="annex-troubleshooting.html#cb108-350"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Low_Scenario[FOWARD<span class="op">@</span>data<span class="op">$</span>Low_Scenario<span class="op">&gt;</span><span class="dv">300</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-351"><a href="annex-troubleshooting.html#cb108-351"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scenario[FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scenario<span class="op">&gt;</span><span class="dv">300</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-352"><a href="annex-troubleshooting.html#cb108-352"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>High_Scenario[FOWARD<span class="op">@</span>data<span class="op">$</span>High_Scenario<span class="op">&gt;</span><span class="dv">300</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-353"><a href="annex-troubleshooting.html#cb108-353"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_min[FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_min<span class="op">&gt;</span><span class="dv">300</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-354"><a href="annex-troubleshooting.html#cb108-354"></a>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_max[FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_max<span class="op">&gt;</span><span class="dv">300</span>]&lt;-<span class="ot">NA</span></span>
<span id="cb108-355"><a href="annex-troubleshooting.html#cb108-355"></a></span>
<span id="cb108-356"><a href="annex-troubleshooting.html#cb108-356"></a><span class="co"># Set the working directory </span></span>
<span id="cb108-357"><a href="annex-troubleshooting.html#cb108-357"></a></span>
<span id="cb108-358"><a href="annex-troubleshooting.html#cb108-358"></a><span class="kw">setwd</span>(WD_OUT)</span>
<span id="cb108-359"><a href="annex-troubleshooting.html#cb108-359"></a></span>
<span id="cb108-360"><a href="annex-troubleshooting.html#cb108-360"></a><span class="co"># UNCERTAINTIES</span></span>
<span id="cb108-361"><a href="annex-troubleshooting.html#cb108-361"></a></span>
<span id="cb108-362"><a href="annex-troubleshooting.html#cb108-362"></a>UNC_SOC&lt;-((FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span>_max<span class="op">-</span>FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span>_min)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_BAU_<span class="dv">20</span>))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb108-363"><a href="annex-troubleshooting.html#cb108-363"></a></span>
<span id="cb108-364"><a href="annex-troubleshooting.html#cb108-364"></a>UNC_t0&lt;-((FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_t0_max<span class="op">-</span>FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_t0_min)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>FOWARD<span class="op">@</span>data<span class="op">$</span>SOC_t0))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb108-365"><a href="annex-troubleshooting.html#cb108-365"></a></span>
<span id="cb108-366"><a href="annex-troubleshooting.html#cb108-366"></a>UNC_SSM&lt;-((FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_max<span class="op">-</span>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scen_min)<span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>FOWARD<span class="op">@</span>data<span class="op">$</span>Med_Scenario))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb108-367"><a href="annex-troubleshooting.html#cb108-367"></a></span>
<span id="cb108-368"><a href="annex-troubleshooting.html#cb108-368"></a>FOWARD[[<span class="dv">19</span>]]&lt;-UNC_SOC</span>
<span id="cb108-369"><a href="annex-troubleshooting.html#cb108-369"></a>FOWARD[[<span class="dv">20</span>]]&lt;-UNC_t0</span>
<span id="cb108-370"><a href="annex-troubleshooting.html#cb108-370"></a>FOWARD[[<span class="dv">21</span>]]&lt;-UNC_SSM</span>
<span id="cb108-371"><a href="annex-troubleshooting.html#cb108-371"></a></span>
<span id="cb108-372"><a href="annex-troubleshooting.html#cb108-372"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">19</span>]=<span class="st">&quot;UNC_BAU&quot;</span></span>
<span id="cb108-373"><a href="annex-troubleshooting.html#cb108-373"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">20</span>]=<span class="st">&quot;UNC_t0&quot;</span></span>
<span id="cb108-374"><a href="annex-troubleshooting.html#cb108-374"></a><span class="kw">colnames</span>(FOWARD<span class="op">@</span>data)[<span class="dv">21</span>]=<span class="st">&quot;UNC_SSM&quot;</span></span>
<span id="cb108-375"><a href="annex-troubleshooting.html#cb108-375"></a></span>
<span id="cb108-376"><a href="annex-troubleshooting.html#cb108-376"></a><span class="co"># SAVE the Points (shapefile)</span></span>
<span id="cb108-377"><a href="annex-troubleshooting.html#cb108-377"></a> </span>
<span id="cb108-378"><a href="annex-troubleshooting.html#cb108-378"></a><span class="kw">writeOGR</span>(FOWARD, <span class="st">&quot;.&quot;</span>, <span class="st">&quot;FOWARD_County_AOI&quot;</span>, <span class="dt">driver=</span><span class="st">&quot;ESRI Shapefile&quot;</span>,<span class="dt">overwrite=</span><span class="ot">TRUE</span>) </span></code></pre></div>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="limitations-knowledge-gaps-and-way-forward.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/FAO-GSP/SOC-Mapping-Cookbook/edit/master/15.Annex.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["SOCMapping.pdf", "SOCMapping.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
